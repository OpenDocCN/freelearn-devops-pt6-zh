["```\napiVersion: v1\nkind: Secret\nmetadata:\n  creationTimestamp: \"2023-07-30T00:04:51Z\"\n  name: orchestra-secrets-source\n  namespace: openunison\n  resourceVersion: \"2958\"\n  uid: 2236389e-e751-4030-8d51-96325d302815\ntype: Opaque\ndata:\n  AD_BIND_PASSWORD: JHRhcnQxMjM=\n  K8S_DB_SECRET: VHloc...\n  OU_JDBC_PASSWORD: c3RhcnR0MTIz\n  SMTP_PASSWORD: c3RhcnQxMjM=\n  unisonKeystorePassword: R2VHV3... \n```", "```\n$ kubectl create -f - <<EOF\nheredoc> apiVersion: v1\nkind: Secret\nmetadata:\n  name: not-tls\n  namespace: default\ntype: kubernetes.io/tls\ndata:\n  AD_BIND_PASSWORD: JHRhcnQxMjM=\nEOF\nThe Secret \"not-tls\" is invalid:\n* data[tls.crt]: Required value * data[tls.key]: Required value \n```", "```\n$ git remote set-url origin https://github.com/new-repository.git\n$ git push \n```", "```\n$ cd chapter8/vault/\n$ ./deploy_vault.sh \n```", "```\n$ jq -r '.root_token' < ~/unseal-keys.json\nhvs.OFotf6LlPTI1bRhqNDMyYf7N \n```", "```\n$ cd chapter8/vault/\n$ ./vault_integrate_cluster.sh \n```", "```\n$ cd chapter8/external-secrets\n$ ./install_external_secrets.sh \n```", "```\napiVersion: external-secrets.io/v1beta1\nkind: SecretStore\nmetadata:\n  name: vault-backend\n  namespace: my-ext-secret\nspec:\n  provider:\n    vault:\n      server: \"https://vault.apps.192-168-2-82.nip.io\"\n      path: \"secret\"\n      version: \"v1\"\n      caProvider:\n        type: \"ConfigMap\"\n        name: \"cacerts\"\n        key: \"tls.crt\"\n        namespace: \"my-ext-secret\"\n      auth:\n          mountPath: \"kubernetes\"\n          serviceAccountRef:\n            name: \"ext-secret-vault\" \n```", "```\napiVersion: external-secrets.io/v1beta1\nkind: ExternalSecret\nmetadata:\n  name: my-external-secret\n  namespace: my-ext-secret\nspec:\n  refreshInterval: 1m\n  secretStoreRef:\n    kind: SecretStore\n    name: vault-backend\n  target:\n    name: secret-to-be-created\n    creationPolicy: Owner\n  data:\n    - secretKey: somepassword\n      remoteRef:\n        key: /data/extsecret/config\n        property: some-password \n```", "```\nvault kv put secret/data/extsecret/config some-password=mysupersecretp@ssw0rd \n```", "```\n$ kubectl get secret secret-to-be-created -n my-ext-secret -o json | jq -r '.data.somepassword' | base64 -d\nmysupersecretp@ssw0rd \n```", "```\napiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: test-volume\n  name: test-volume-secrets\n  namespace: my-ext-secret\nspec:\n  containers:\n  - image: busybox\n    name: test\n    resources: {}\n    command:\n    - sh\n    - -c\n    - 'cat /etc/secrets/somepassword'\n    volumeMounts:\n    - name: mypassword\n      mountPath: /etc/secrets\n  volumes:\n  - name: mypassword\n    secret:\n      secretName: secret-to-be-created\n  dnsPolicy: ClusterFirst\n  restartPolicy: Never \n```", "```\n$ kubectl logs test-volume-secrets -n my-ext-secret\nmyN3wP@ssw0rd \n```", "```\n$ cd chapter8/integration/volumes\n$ kubectl create -f ./volume-secrets-watch.yaml\n$ kubectl logs -f test-volumes-secrets-watch -n my-ext-secret\nFri Sep 15 14:52:45 UTC 2023\nmyN3wP@ssw0rd\n----------\nFri Sep 15 14:52:46 UTC 2023\nmyN3wP@ssw0rd\n----------\nFri Sep 15 14:52:47 UTC 2023\nmyN3wP@ssw0rd\n---------- \n```", "```\n$ . ../../vault/vault_cli.sh\n$ vault kv put secret/data/extsecret/config some-password=An0therPassw0rd\nSuccess! Data written to: secret/data/extsecret/config\n$ kubectl get secret secret-to-be-created -n my-ext-secret -o json | jq -r '.data.somepassword' | base64 -d\nAn0therPassw0rd \n```", "```\n$ kubectl logs -f test-volumes-secrets-watch -n my-ext-secret\nFri Sep 15 14:52:45 UTC 2023\nmyN3wP@ssw0rd\n----------\n.\n.\n.\nFri Sep 15 14:56:33 UTC 2023\nAn0therPassw0rd\n----------\nFri Sep 15 14:56:34 UTC 2023\nAn0therPassw0rd\n----------\nFri Sep 15 14:56:35 UTC 2023\nAn0therPassw0rd\n---------- \n```", "```\napiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: watch-vault-volume\n  name: test-vault-vault-watch\n  namespace: my-ext-secret\n  annotations:     **vault.hashicorp.com/agent-inject:****\"true\"**\n**vault.hashicorp.com/service:****\"https://vault.apps.192-168-2-82.nip.io\"**\n**vault.hashicorp.com/log-level:****trace**\n**vault.hashicorp.com/role:****extsecret**\n**vault.hashicorp.com/tls-skip-verify:****\"true\"**\n**vault.hashicorp.com/agent-inject-secret-myenv:****'secret/data/extsecret/config'**\n**vault.hashicorp.com/secret-volume-path-myenv:****'/etc/secrets'**\n**vault.hashicorp.com/agent-inject-template-myenv:****|**\n **{{****-****with****secret****\"secret/data/extsecret/config\"****-****}}**\n**MY_SECRET_PASSWORD=\"{{****index****.Data****\"some-password\"****}}\"**\n **{{****-****end** **}}**\nspec:\n  containers:\n  - image: ubuntu:22.04\n    name: test\n    resources: {}\n    command:\n    - bash\n    - -c\n    - 'while [[ 1 == 1 ]]; do date && cat /etc/secrets/myenv && echo \"\" && echo \"----------\" && sleep 1; done'\n  dnsPolicy: ClusterFirst\n  restartPolicy: Never\n**serviceAccountName:****ext-secret-vault**\n**serviceAccount:****ext-secret-vault** \n```", "```\nvault.hashicorp.com/agent-inject: \"true\"\nvault.hashicorp.com/service: \"https://vault.apps.192-168-2-82.nip.io\" vault.hashicorp.com/log-level: trace\nvault.hashicorp.com/role: extsecret\nvault.hashicorp.com/tls-skip-verify: \"true\" \n```", "```\nvault write auth/kubernetes/role/extsecret \\\n     bound_service_account_names=ext-secret-vault \\\n     bound_service_account_namespaces=my-ext-secret \\\n     policies=extsecret \\\n     ttl=24h \n```", "```\nvault.hashicorp.com/agent-inject-secret-myenv: 'secret/data/extsecret/config'\nvault.hashicorp.com/secret-volume-path-myenv: '/etc/secrets'\nvault.hashicorp.com/agent-inject-template-myenv: |\n  {{- with secret \"secret/data/extsecret/config\" -}}\n  MY_SECRET_PASSWORD=\"{{ index .Data \"some-password\" }}\"\n  {{- end }} \n```", "```\n$ cd chapter8/integration/volumes\n$ ./create-vault.sh\n$ kubectl logs -f test-vault-vault-watch -n my-ext-secret\nDefaulted container \"test\" out of: test, vault-agent, vault-agent-init (init)\nFri Sep 15 18:24:09 UTC 2023\nMY_SECRET_PASSWORD=\"An0therPassw0rd\"\n----------\nFri Sep 15 18:24:10 UTC 2023\nMY_SECRET_PASSWORD=\"An0therPassw0rd\" \n```", "```\napiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: test\n  name: test-envvars-secrets\n  namespace: my-ext-secret\nspec:\n  containers:\n  - image: busybox\n    name: test\n    resources: {}\n    command:\n    - env\n**env:**\n**-****name:****MY_SECRET_PASSWORD**\n**valueFrom:**\n**secretKeyRef:**\n**name:****secret-to-be-created**\n**key:****somepassword**\n  dnsPolicy: ClusterFirst\n  restartPolicy: Never \n```", "```\n$ cd chapter8/integration/envvars\n$ kubectl create -f ./envars-secrets.yaml\n$ kubectl logs -f -l run=test -n my-ext-secret\n**MY_SECRET_PASSWORD=An0therPassw0rd**\nKUBERNETES_SERVICE_PORT_HTTPS=443\nKUBERNETES_PORT=tcp://10.96.0.1:443\nKUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443\nKUBERNETES_PORT_443_TCP_PROTO=tcp\nKUBERNETES_PORT_443_TCP_PORT=443\nKUBERNETES_PORT_443_TCP_ADDR=10.96.0.1\nKUBERNETES_SERVICE_HOST=10.96.0.1\nKUBERNETES_SERVICE_PORT=443\nHOME=/root \n```", "```\n$ cd chapter8/integration/envvars\n$ kubectl create -f ./envars-secrets-watch.yaml\n$ kubectl logs -f -l run=watch-env -n my-ext-secret\nFri Sep 15 12:43:30 UTC 2023\nMY_SECRET_PASSWORD=An0therPassw0rd\nFri Sep 15 12:43:31 UTC 2023\nMY_SECRET_PASSWORD=An0therPassw0rd \n```", "```\n$ . ../../vault/vault_cli.sh\n$ vault kv put secret/data/extsecret/config some-password=myN3wP@ssw0rd\nSuccess! Data written to: secret/data/extsecret/config\n$ kubectl get secret secret-to-be-created -n my-ext-secret -o json | jq -r '.data.somepassword' | base64 -d\nmyN3wP@ssw0rd \n```", "```\nubuntu@book-v3:~/Kubernetes-An-Enterprise-Guide-Third-Edition/chapter8/vault$ kubectl logs -f -l run=watch-env -n my-ext-secret\n**Fri Sep 15 12:48:41 UTC 2023**\n**MY_SECRET_PASSWORD=An0therPassw0rd**\n**Fri Sep 15 12:48:42 UTC 2023**\n**MY_SECRET_PASSWORD=An0therPassw0rd**\n**Fri Sep 15 12:48:43 UTC 2023**\n**MY_SECRET_PASSWORD=An0therPassw0rd** \n```", "```\napiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: watch-vault-env\n  name: test-envvars-vault-watch\n  namespace: my-ext-secret\n  annotations:\n    vault.hashicorp.com/agent-inject: \"true\"\n    vault.hashicorp.com/log-level: trace\n    vault.hashicorp.com/role: extsecret\n    vault.hashicorp.com/tls-skip-verify: \"true\"\n    vault.hashicorp.com/agent-inject-secret-myenv: 'secret/data/extsecret/config'\n    vault.hashicorp.com/agent-inject-template-myenv: |\n          {{- with secret \"secret/data/extsecret/config\" -}}\n            export MY_SECRET_PASSWORD=\"{{ index .Data \"some-password\" }}\"\n          {{- end }}\nspec:\n  containers:\n  - image: ubuntu:22.04\n    name: test\n    resources: {}\n    command:\n    - bash\n    - -c\n**-****'echo \"sleeping 5 seconds\"; sleep 5;source /vault/secrets/myenv ; env | grep MY_SECRET_PASSWORD'**\n  dnsPolicy: ClusterFirst\n  restartPolicy: Never\n  serviceAccountName: ext-secret-vault\n  serviceAccount: ext-secret-vault \n```"]
["```\n$ kubectl create namespace chap9\nnamespace \"chap9\" created\n```", "```\n$ minikube stop\n```", "```\n//if you are using macOS \n$ brew update\n$ brew cask upgrade\n\n//if you are using Windows, download a latest binary from\nhttps://github.com/kubernetes/minikube/releases \n```", "```\n$ minikube start --vm-driver=hyperkit --memory 5120\n```", "```\n$ kubectl get pods --all-namespaces\nNAMESPACE     NAME                                    READY     STATUS    RESTARTS   AGE\nkube-system   kube-addon-manager-minikube             1/1       Running   0          1m\nkube-system   kube-dns-54cccfbdf8-rc7gf               3/3       Running   0          1m\nkube-system   kubernetes-dashboard-77d8b98585-hkjrr   1/1       Running   0          1m\nkube-system   storage-provisioner                     1/1       Running   0          1m\n```", "```\n$ minikube addons enable efk\nefk was successfully enabled\n```", "```\n$ kubectl get pods --namespace=kube-system\nNAME                                    READY     STATUS              RESTARTS   AGE\n$ kubectl get pods --all-namespaces\nNAMESPACE     NAME                                    READY     STATUS    RESTARTS   AGE\nkube-system   elasticsearch-logging-t5tq7             1/1       Running   0          9m\nkube-system   fluentd-es-8z2tr                        1/1       Running   0          9m\nkube-system   kibana-logging-dgql7                    1/1       Running   0          9m\nkube-system   kube-addon-manager-minikube             1/1       Running   1          34m\n…\n```", "```\n$ kubectl logs -f kibana-logging-dgql7  --namespace=kube-system\n{\"type\":\"log\",\"@timestamp\":\"2018-03-25T18:53:54Z\",\"tags\":[\"info\",\"optimize\"],\"pid\":1,\"message\":\"Optimizing and caching bundles for graph, ml, kibana, stateSessionStorageRedirect, timelion and status_page. This may take a few minutes\"}\n\n*(wait for around 5min)*\n\n{\"type\":\"log\",\"@timestamp\":\"2018-03-25T19:03:10Z\",\"tags\":[\"status\",\"plugin:elasticsearch@5.6.2\",\"info\"],\"pid\":1,\"state\":\"yellow\",\"message\":\"Status changed from yellow to yellow - No existing Kibana index found\",\"prevState\":\"yellow\",\"prevMsg\":\"Waiting for Elasticsearch\"}\n{\"type\":\"log\",\"@timestamp\":\"2018-03-25T19:03:15Z\",\"tags\":[\"status\",\"plugin:elasticsearch@5.6.2\",\"info\"],\"pid\":1,\"state\":\"green\",\"message\":\"Status changed from yellow to green - Kibana index ready\",\"prevState\":\"yellow\",\"prevMsg\":\"No existing Kibana index found\"}\n```", "```\n$ minikube service kibana-logging --namespace=kube-system\nOpening kubernetes service kube-system/kibana-logging in default browser...\n```", "```\n# Monitoring apps for k8s\nefk_enabled: true\n```", "```\n$ ansible-playbook -b -i inventory/mycluster/hosts.ini cluster.yml\n```", "```\n$ kubectl get pods --all-namespaces\nNAMESPACE     NAME                                        READY     STATUS    RESTARTS   AGE\nkube-system   calico-node-9wnwn                           1/1       Running   0          2m\nkube-system   calico-node-jg67p                           1/1       Running   0          2m\nkube-system   elasticsearch-logging-v1-776b8b856c-97qrq   1/1       Running   0          1m kube-system   elasticsearch-logging-v1-776b8b856c-z7jhm   1/1       Running   0          1m kube-system   fluentd-es-v1.22-gtvzg                      1/1       Running   0          49s kube-system   fluentd-es-v1.22-h8r4h                      1/1       Running   0          49s kube-system   kibana-logging-57d98b74f9-x8nz5             1/1       Running   0          44s kube-system   kube-apiserver-master-1                     1/1       Running   0          3m\nkube-system   kube-controller-manager-master-1            1/1       Running   0          3m\n…\n```", "```\n$ kubectl logs -f kibana-logging-57d98b74f9-x8nz5 --namespace=kube-system\nELASTICSEARCH_URL=http://elasticsearch-logging:9200\nserver.basePath: /api/v1/proxy/namespaces/kube-system/services/kibana-logging\n{\"type\":\"log\",\"@timestamp\":\"2018-03-25T05:11:10Z\",\"tags\":[\"info\",\"optimize\"],\"pid\":5,\"message\":\"Optimizing and caching bundles for kibana and statusPage. This may take a few minutes\"}\n\n*(wait for around 5min)*\n\n{\"type\":\"log\",\"@timestamp\":\"2018-03-25T05:17:55Z\",\"tags\":[\"status\",\"plugin:elasticsearch@1.0.0\",\"info\"],\"pid\":5,\"state\":\"yellow\",\"message\":\"Status changed from yellow to yellow - No existing Kibana index found\",\"prevState\":\"yellow\",\"prevMsg\":\"Waiting for Elasticsearch\"}\n{\"type\":\"log\",\"@timestamp\":\"2018-03-25T05:17:58Z\",\"tags\":[\"status\",\"plugin:elasticsearch@1.0.0\",\"info\"],\"pid\":5,\"state\":\"green\",\"message\":\"Status changed from yellow to green - Kibana index ready\",\"prevState\":\"yellow\",\"prevMsg\":\"No existing Kibana index found\"}\n```", "```\n$ kubectl cluster-info\nKubernetes master is running at http://localhost:8080\nElasticsearch is running at http://localhost:8080/api/v1/namespaces/kube-system/services/elasticsearch-logging/proxy\nKibana is running at http://localhost:8080/api/v1/namespaces/kube-system/services/kibana-logging/proxy KubeDNS is running at http://localhost:8080/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\n```", "```\n$ ssh -L 8080:127.0.0.1:8080 <Kubernetes master IP address>\n```", "```\n$ kubectl create -f https://raw.githubusercontent.com/kubernetes/kops/master/addons/logging-elasticsearch/v1.6.0.yaml\nserviceaccount \"elasticsearch-logging\" created\nclusterrole \"elasticsearch-logging\" created\nclusterrolebinding \"elasticsearch-logging\" created\nserviceaccount \"fluentd-es\" created\nclusterrole \"fluentd-es\" created\nclusterrolebinding \"fluentd-es\" created\ndaemonset \"fluentd-es\" created\nservice \"elasticsearch-logging\" created\nstatefulset \"elasticsearch-logging\" created\ndeployment \"kibana-logging\" created\nservice \"kibana-logging\" created\n```", "```\n$ kubectl get pods --all-namespaces\nNAMESPACE     NAME                                                  READY     STATUS    RESTARTS   AGE\nkube-system   dns-controller-dc46485d8-pql7r                        1/1       Running   0          5m\nkube-system   elasticsearch-logging-0                               1/1       Running   0          1m kube-system   elasticsearch-logging-1                               1/1       Running   0          53s kube-system   etcd-server-events-ip-10-0-48-239.ec2.internal        1/1       Running   0          5m\nkube-system   etcd-server-ip-10-0-48-239.ec2.internal               1/1       Running   0          5m\nkube-system   fluentd-es-29xh9                                      1/1       Running   0          1m kube-system   fluentd-es-xfbd6                                      1/1       Running   0          1m kube-system   kibana-logging-649d7dcc87-mrtzc                       1/1       Running   0          1m kube-system   kube-apiserver-ip-10-0-48-239.ec2.internal            1/1       Running   0          5m\n...\n```", "```\n$ kubectl logs -f kibana-logging-649d7dcc87-mrtzc --namespace=kube-system\nELASTICSEARCH_URL=http://elasticsearch-logging:9200\nserver.basePath: /api/v1/proxy/namespaces/kube-system/services/kibana-logging\n{\"type\":\"log\",\"@timestamp\":\"2018-03-26T01:02:04Z\",\"tags\":[\"info\",\"optimize\"],\"pid\":6,\"message\":\"Optimizing and caching bundles for kibana and statusPage. This may take a few minutes\"}\n\n*(wait for around 5min)*\n\n{\"type\":\"log\",\"@timestamp\":\"2018-03-26T01:08:00Z\",\"tags\":[\"status\",\"plugin:elasticsearch@1.0.0\",\"info\"],\"pid\":6,\"state\":\"yellow\",\"message\":\"Status changed from yellow to yellow - No existing Kibana index found\",\"prevState\":\"yellow\",\"prevMsg\":\"Waiting for Elasticsearch\"}\n{\"type\":\"log\",\"@timestamp\":\"2018-03-26T01:08:03Z\",\"tags\":[\"status\",\"plugin:elasticsearch@1.0.0\",\"info\"],\"pid\":6,\"state\":\"green\",\"message\":\"Status changed from yellow to green - Kibana index ready\",\"prevState\":\"yellow\",\"prevMsg\":\"No existing Kibana index found\"}\n```", "```\n$ kubectl cluster-info\nKubernetes master is running at https://api.chap9.k8s-devops.net\nElasticsearch is running at https://api.chap9.k8s-devops.net/api/v1/namespaces/kube-system/services/elasticsearch-logging/proxy\nKibana is running at https://api.chap9.k8s-devops.net/api/v1/namespaces/kube-system/services/kibana-logging/proxy KubeDNS is running at https://api.chap9.k8s-devops.net/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\n```", "```\n$ kubectl proxy --port=8080\nStarting to serve on 127.0.0.1:8080\n```", "```\n$ cat myapp.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: myapp\nspec:\n  containers:\n  - image: busybox\n    name: application\n    args:\n      - /bin/sh\n      - -c\n      - >\n        while true; do\n        echo \"$(date) INFO hello\";\n        sleep 1;\n        done\n```", "```\n$ kubectl create -f myapp.yaml --namespace=chap9\npod \"myapp\" created\n```", "```\n$ kubectl create -f https://raw.githubusercontent.com/kubernetes-cookbook/second-edition/master/chapter9/9-1/eventer.yml\ndeployment \"eventer-v1.5.2\" created\nserviceaccount \"heapster\" created\nclusterrolebinding \"heapster\" created\n```", "```\n$ kubectl get pods --all-namespaces\nNAMESPACE     NAME                                        READY     STATUS    RESTARTS   AGE\nkube-system   elasticsearch-logging-v1-776b8b856c-9vvfl   1/1       Running   0          9m\nkube-system   elasticsearch-logging-v1-776b8b856c-gg5gx   1/1       Running   0          9m\nkube-system   eventer-v1.5.2-857bcc76d9-9gwn8             1/1       Running   0          29s\nkube-system   fluentd-es-v1.22-8prkn                      1/1       Running   0          9m\n...\n```", "```\n$ kubectl logs -f eventer-v1.5.2-857bcc76d9-9gwn8 --namespace=kube-system\nI0327 03:49:53.988961       1 eventer.go:68] /eventer --source=kubernetes:'' --sink=elasticsearch:http://elasticsearch-logging:9200?sniff=false\nI0327 03:49:53.989025       1 eventer.go:69] Eventer version v1.5.2\nI0327 03:49:54.087982       1 eventer.go:95] Starting with ElasticSearch Sink sink\nI0327 03:49:54.088040       1 eventer.go:109] Starting eventer\nI0327 03:49:54.088048       1 eventer.go:117] Starting eventer http service\nI0327 03:50:00.000199       1 manager.go:100] Exporting 0 events\n```", "```\n$ kubectl run my-nginx --image=nginx\ndeployment \"my-nginx\" created\n```", "```\nI0327 03:52:00.000235       1 manager.go:100] Exporting 0 events\nI0327 03:52:30.000166       1 manager.go:100] Exporting 8 events\nI0327 03:53:00.000241       1 manager.go:100] Exporting 0 events\n```", "```\n$ gcloud container clusters create my-gke --cluster-version 1.9.4-gke.1 --enable-cloud-logging --network default --zone us-west1-b\n```", "```\n$ gcloud container clusters update my-gke --logging-service logging.googleapis.com --zone us-west1-b\n```", "```\n$ kubectl create namespace chap9\nnamespace \"chap9\" created\n```", "```\n$ cat myapp.yaml \napiVersion: v1\nkind: Pod\nmetadata:\n  name: myapp\nspec:\n  containers:\n  - image: busybox\n    name: application\n    args:\n      - /bin/sh\n      - -c\n      - >\n        while true; do\n        echo \"$(date) INFO hello\";\n        sleep 1;\n        done\n```", "```\n$ kubectl create -f myapp.yaml --namespace=chap9\npod \"myapp\" created\n```", "```\nresource.type=\"container\" \nresource.labels.cluster_name=\"<Your GKE name>\"\nresource.labels.namespace_id=\"chap9\"\n```", "```\nresource.type=\"gke_cluster\"\nresource.labels.cluster_name=\"<Your GKE name>\"\n```", "```\n// check the components\n$ kubectl get cs\n```", "```\n// try kubectl top before installing Heapster\n$ kubectl top node\nError from server (NotFound): the server could not find the requested resource (get services http:heapster:)\n```", "```\n// installing influxDB\n$ kubectl create -f https://raw.githubusercontent.com/kubernetes/heapster/master/deploy/kube-config/influxdb/influxdb.yaml\ndeployment \"monitoring-influxdb\" created\nservice \"monitoring-influxdb\" created\n// installing Heapster\n$ kubectl create -f https://raw.githubusercontent.com/kubernetes/heapster/master/deploy/kube-config/influxdb/heapster.yaml\nserviceaccount \"heapster\" created\ndeployment \"heapster\" created\n//installing Grafana\n$kubectl create -f https://raw.githubusercontent.com/kubernetes/heapster/master/deploy/kube-config/influxdb/grafana.yaml\ndeployment \"monitoring-grafana\" created\nservice \"monitoring-grafana\" created\n```", "```\n// check the status of nodes\n$ kubectl top node\nNAME       CPU(cores)   CPU%      MEMORY(bytes)   MEMORY%\nminikube   236m         11%       672Mi           35%\n// check the status of Pods in Namespace kube-system\n$ kubectl top pod -n kube-system\nNAME                                    CPU(cores)   MEMORY(bytes)\nheapster-5c448886d-k9wt7                1m           18Mi\nkube-addon-manager-minikube             36m          32Mi\nkube-dns-54cccfbdf8-j65x6               3m           22Mi\nkubernetes-dashboard-77d8b98585-z8hch   0m           12Mi\nmonitoring-grafana-65757b9656-8cl6d     0m           13Mi\nmonitoring-influxdb-66946c9f58-hwv8g    1m           26Mi\n```", "```\n$ kubectl proxy\nStarting to serve on 127.0.0.1:8001\n```", "```\n// add nodes with monitoring scope\n$ gcloud container clusters create my-k8s-cluster --cluster-version 1.9.7-gke.0 - -machine-type f1-micro --num-nodes 3 --network k8s-network --zone us-central1-a - -tags private --scopes=storage-rw,compute-ro, https://www.googleapis.com/auth/monitoring\n```"]
- en: '1'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '1'
- en: Introducing Observability and the Grafana Stack
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍观察性与 Grafana 技术栈
- en: The modern computer systems we work with have moved from the realm of complicated
    into the realm of complex, where the number of interacting variables make them
    ultimately unknowable and uncontrollable. We are using the terms *complicated*
    and *complex* as per system theory. A complicated system, like an engine, has
    clear causal relationships between components. A complex system, such as the flowing
    of traffic in a city, shows emergent behavior from the interactions of its components.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们当前使用的现代计算机系统已经从“复杂”领域转向“复杂性”领域，在这些系统中，相互作用的变量数目使其最终变得无法预测和无法控制。我们使用“复杂”和“复杂性”这两个术语是根据系统理论的定义。一个复杂的系统，如引擎，具有组件之间明确的因果关系。而一个复杂系统，如城市交通的流动，则通过组件之间的相互作用展现出涌现行为。
- en: With the average cost of downtime estimated to be $9,000 per minute by Ponemon
    Institute in 2016, this complexity can cause significant financial loss if organizations
    do not take steps to manage this risk. **Observability** offers a way to mitigate
    these risks, but making systems observable comes with its own financial risks
    if implemented poorly or without a clear business goal.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 根据 Ponemon Institute 2016 年的估算，每分钟停机的平均成本为 9000 美元，若组织未采取措施管理这一风险，复杂性可能会导致重大的财务损失。**观察性**提供了一种减轻这些风险的方式，但如果实施不当或没有明确的商业目标，使系统具备观察性也会带来财务风险。
- en: In this book, we will give you a good understanding of what observability is
    and who the customers who might use it are. We will explore how to use the tools
    available from Grafana Labs to gain visibility of your organization. These tools
    include Loki, Prometheus, Mimir, Tempo, Frontend Observability, Pyroscope, and
    k6\. You will learn how to use **Service Level Indicators** (**SLIs**) and **Service
    Level Objectives** (**SLOs**) to obtain clear transparent signals of when a service
    is operating correctly, and how to use the Grafana **incident response tools**
    to handle incidents. Finally, you will learn about managing their observability
    platform using **automation tools** such as Ansible, Terraform, and Helm.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本书将帮助你深入理解观察性是什么，以及可能使用它的客户是谁。我们将探索如何使用来自 Grafana Labs 的工具来获取组织的可见性。这些工具包括 Loki、Prometheus、Mimir、Tempo、Frontend
    Observability、Pyroscope 和 k6。你将学习如何使用**服务水平指标**（**SLIs**）和**服务水平目标**（**SLOs**）来获得清晰透明的信号，判断服务是否正常运行，并学习如何使用
    Grafana 的**事件响应工具**来处理事件。最后，你将了解如何使用**自动化工具**如 Ansible、Terraform 和 Helm 来管理观察性平台。
- en: This chapter aims to introduce observability to all audiences, using examples
    outside of the computing world. We’ll introduce the types of **telemetry** used
    by observability tools, which will give you an overview of how to use them to
    quickly understand the state of your services. The various **personas** who might
    use observability systems will be outlined so that you can explore complex ideas
    later with a clear grounding on who will benefit from their correct implementation.
    Finally, we’ll investigate Grafana’s **Loki, Grafana, Tempo, Mimir** (**LGTM**)
    stack, how to deploy it, and what alternatives exist.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章旨在通过计算机领域之外的例子向所有受众介绍观察性。我们将介绍观察性工具使用的**遥测**类型，这将为你提供如何利用这些工具快速了解服务状态的概览。我们还将概述可能使用观察性系统的各种**角色**，这样你在后续的学习中可以在明确受益者的基础上探讨更复杂的概念。最后，我们将研究
    Grafana 的**Loki、Grafana、Tempo、Mimir**（**LGTM**）技术栈，如何部署它，以及有哪些替代方案。
- en: 'In this chapter, we’re going to cover the following main topics:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们将涵盖以下主要内容：
- en: Observability in a nutshell
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 观察性概述
- en: Telemetry types and technologies
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 遥测类型与技术
- en: Understanding the customers of observability
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解观察性的客户群
- en: Introducing the Grafana stack
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍 Grafana 技术栈
- en: Alternatives to the Grafana stack
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Grafana 技术栈的替代方案
- en: Deploying the Grafana stack
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署 Grafana 技术栈
- en: Observability in a nutshell
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 观察性概述
- en: The term **observability** is borrowed from control theory. It’s common to use
    the term interchangeably with the term **monitoring** in IT systems, as the concepts
    are closely related. Monitoring is the ability to raise an alarm when something
    is wrong, while observability is the ability to understand a system and determine
    whether something is wrong, and why.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '**观察性**这个术语借鉴自控制理论。在 IT 系统中，**监控**和**观察性**通常可以互换使用，因为这两个概念密切相关。监控是当系统出现问题时发出警报的能力，而观察性则是理解系统并确定是否存在问题及其原因的能力。'
- en: 'Control theory was formalized in the late 1800s on the topic of centrifugal
    governors in steam engines. This diagram shows a simplified view of such a system:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 控制理论在 19 世纪末就蒸汽机中的离心调速器进行了形式化。此图显示了该系统的简化视图：
- en: '![Figure 1.1 – James Watt’s steam engine flyweight governor (source: https://www.mpoweruk.com)](img/B18277_01_1.jpg)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![图 1.1 – 詹姆斯·瓦特的蒸汽机飞重调速器（来源：[https://www.mpoweruk.com](https://www.mpoweruk.com)）](img/B18277_01_1.jpg)'
- en: 'Figure 1.1 – James Watt’s steam engine flyweight governor (source: https://www.mpoweruk.com)'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.1 – 詹姆斯·瓦特的蒸汽机飞重调速器（来源：[https://www.mpoweruk.com](https://www.mpoweruk.com)）
- en: Steam engines use a boiler to boil water in a pressure vessel. The steam pushes
    a piston backward and forward, which converts heat energy to reciprocal energy.
    In steam engines that use centrifugal governors, this reciprocal energy is converted
    to rotational energy via a wheel connected to a piston. The centrifugal governor
    provides a physical link backward through the system to the throttle. This means
    that the speed of rotation controls the throttle, which, in turn, controls the
    speed of rotation. Physically, this is observed by the balls on the governor flying
    outward and dropping inward until the system reaches equilibrium.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 蒸汽机使用锅炉将水加热至压力容器中的蒸汽。蒸汽推动活塞前后运动，从而将热能转化为往复能量。在使用离心调速器的蒸汽机中，这种往复能量通过连接到活塞的轮子转化为旋转能量。离心调速器通过物理链接将系统向后连接到节气门。这意味着旋转速度控制节气门，而节气门又控制旋转速度。从物理上讲，这是通过调速器上的小球向外飞出并下落向内直到系统达到平衡来观察的。
- en: Monitoring defines the metrics or events that are of interest in advance. For
    instance, the governor measures the pre-defined metric of drive shaft revolutions.
    The controllability of the throttle is then provided by the pivot and actuator
    rod assembly. Assuming the actuator rod is adjusted correctly, the governor should
    control the throttle from fully open to fully closed.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 监控定义了事先感兴趣的指标或事件。例如，调速器测量预定义的驱动轴转数。然后，节气门的可控性通过枢轴和执行杆组件提供。假设执行杆正确调整，调速器应控制节气门从完全打开到完全关闭。
- en: In contrast, observability is achieved by allowing the internal state of the
    system to be inferred from its external outputs. If the operating point adjustment
    is incorrectly set, the governor may spin too fast or too slowly, rendering the
    throttle control ineffective. A governor spinning too fast or too slowly could
    also indicate that the sliding ring is stuck in place and needs oiling. Importantly,
    this insight can be gained without defining in advance what too fast or too slow
    means. The insight that the governor is spinning too fast or too slowly also needs
    very little knowledge of the full steam engine.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，可观察性通过允许从系统的外部输出推断出其内部状态来实现。如果操作点调整设置不正确，调速器可能转得太快或太慢，从而使节气门控制失效。调速器转得过快或过慢也可能表明滑环卡住了，需要加油。重要的是，这些洞察可以在没有预先定义“过快”或“过慢”的情况下获得。得出调速器转速过快或过慢的结论，几乎不需要了解整个蒸汽机的详细信息。
- en: Fundamentally, both monitoring and observability are used to improve the reliability
    and performance of the system in question.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 从根本上讲，监控和可观察性都用于提高所讨论系统的可靠性和性能。
- en: Now that we have introduced the high-level concepts, let’s explore a practical
    example outside of the world of software services.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经介绍了高层次的概念，接下来让我们探讨一个来自软件服务领域之外的实际例子。
- en: Case study – A ship passing through the Panama Canal
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 案例研究 – 一艘船通过巴拿马运河
- en: 'Let’s imagine a ship traversing the Agua Clara locks on the Panama Canal. This
    can be illustrated using the following figure:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们想象一艘船通过巴拿马运河的阿瓜克拉水闸。这个过程可以通过以下图示来说明：
- en: '![Figure 1.2 – The Agua Clara locks on the Panama Canal](img/B18277_01_2.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![图 1.2 – 巴拿马运河的阿瓜克拉水闸](img/B18277_01_2.jpg)'
- en: Figure 1.2 – The Agua Clara locks on the Panama Canal
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.2 – 巴拿马运河的阿瓜克拉水闸
- en: 'There are a few aspects of these locks that we might want to monitor:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 这些水闸中有一些方面我们可能需要监控：
- en: The successful opening and closing of each gate
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个闸门成功打开和关闭
- en: The water level inside each lock
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个水闸内的水位
- en: How long it takes for a ship to traverse the locks
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一艘船通过水闸所需的时间
- en: 'Monitoring these aspects may highlight situations that we need to be alerted
    about:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 监控这些方面可能会突出我们需要注意的情况：
- en: A gate is stuck open because of a mechanical failure
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于机械故障，闸门卡住无法关闭
- en: The water level is rapidly descending because of a leak
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于泄漏，水位迅速下降
- en: A ship is taking too long to exit the locks because it is stuck
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一艘船因卡住而需要花费更多时间才能通过闸门：
- en: 'There may be situations where the data we are monitoring are within acceptable
    limits, but we can still observe a deviation from what is considered *normal*,
    which should prompt further action:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 可能会出现这种情况：我们监控的数据处于可接受的范围内，但我们仍然可以观察到与*正常*情况的偏差，这应该促使进一步的行动：
- en: 'A small leak has formed near the top of the lock wall:'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 锁墙顶部附近出现了一个小漏水点：
- en: We would see the water level drop but only when it is above the leak
  id: totrans-37
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们会看到水位下降，但只有当水位高于漏点时才会发生。
- en: This could prompt maintenance work on the lock wall
  id: totrans-38
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这可能会促使对锁墙进行维护工作。
- en: 'A gate in one lock is opening more slowly because it needs maintenance:'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一扇锁门打开得更慢，因为它需要维护：
- en: We would see the time between opening and closing the gate increase
  id: totrans-40
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们会看到开关门之间的时间延长。
- en: This could prompt maintenance on the lock gate
  id: totrans-41
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这可能会促使对锁门进行维护。
- en: 'Ships take longer to traverse the locks when the wind is coming from a particular
    direction:'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当风从某个特定方向吹来时，船只通过闸门的时间会更长：
- en: We could compare hourly average traversal rates
  id: totrans-43
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以比较每小时的平均通行速率。
- en: This could prompt work to reduce the impact of wind from one direction
  id: totrans-44
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这可能促使减少来自某个方向风力影响的工作。
- en: Now that we’ve seen an example of measuring a real-world system, we can group
    these types of measurements into different data types to best suit the application.
    Let’s introduce those now.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经看到了一个测量现实世界系统的例子，我们可以将这些类型的测量分为不同的数据类型，以便最适合应用。现在让我们介绍这些数据类型。
- en: Telemetry types and technologies
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 遥测类型和技术
- en: The boring but important part of observability tools is **telemetry** – capturing
    data that is useful, shipping it from place to place, and producing visualizations,
    alerts, and reports that offer value to the organization.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 可观测工具中无聊但重要的一部分是**遥测**——捕获有用数据，跨地点传输数据，并生成为组织提供价值的可视化、警报和报告。
- en: Three main types of telemetry are used to build monitoring and observability
    systems – metrics, logs, and distributed traces. Other telemetry types may be
    used by some vendors and in particular circumstances. We will touch on these here,
    but they will be explored in more detail in *Chapters 12* and *13* of this book.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 用于构建监控和可观测系统的三种主要遥测类型是——指标、日志和分布式追踪。其他遥测类型可能会被一些供应商和在特定情况下使用。我们将在这里简要介绍这些内容，但它们将在本书的*第12章*和*第13章*中更详细地探讨。
- en: Metrics
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 指标
- en: '**Metrics** can be thought of as numeric data that is recorded at a point in
    time and enriched with labels or dimensions to enable analysis. Metrics are frequently
    generated and are easy to search, making them ideal for determining whether something
    is wrong or unusual. Let’s look at an example of metrics showing temporal changes:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '**指标**可以被视为在某一时刻记录的数值数据，并通过标签或维度加以丰富，以便进行分析。指标通常是频繁生成的，并且易于搜索，非常适合用来判断某些事情是否异常或不对劲。让我们来看一个显示时间变化的指标示例：'
- en: '![Figure 1.3 – Metrics showing changes over time](img/B18277_01_3.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![图 1.3 – 显示时间变化的指标](img/B18277_01_3.jpg)'
- en: Figure 1.3 – Metrics showing changes over time
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.3 – 显示时间变化的指标
- en: 'Taking our example of the Panama Canal, we could represent the *water level
    in each lock* as a metric, to be measured at regular intervals. To be able to
    use the data effectively, we might add some of these labels:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 以巴拿马运河为例，我们可以将*每个闸门的水位*作为一个指标，在定期的时间间隔进行测量。为了有效使用这些数据，我们可能会添加一些标签：
- en: '**The lock name**: Agua Clara'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**锁名**：阿瓜·克拉拉'
- en: '**The lock chamber**: Lower lock'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**锁室**：下游闸室'
- en: '**The canal**: Panama Canal'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**运河**：巴拿马运河'
- en: Logs
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 日志
- en: '**Logs** are considered to be unstructured string data types. They are recorded
    at a point in time and usually contain a huge amount of information about what
    is happening. While logs can be structured, there is no guarantee of that structure
    persisting, because the log producer has control over the structure of the log.
    Let’s look at an example:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**日志**被视为非结构化的字符串数据类型。它们在某一时刻被记录，通常包含大量关于正在发生的事情的信息。虽然日志可以是结构化的，但无法保证该结构会持续存在，因为日志的生产者掌握着日志结构的控制权。让我们来看一个例子：'
- en: '[PRE0]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: In our example, the various operations involved in opening or closing a lock
    gate could be represented as logs.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的例子中，开关锁门时的各种操作可以作为日志来表示。
- en: 'Almost every system produces logs, and they often give very detailed information.
    This is great for understanding what happened. However, the volume of data presents
    two problems:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: Searching can be inefficient and slow.
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As the data is in text format, knowing what to search for can be difficult.
    For example, `error occurred`, `process failed`, and `action did not complete
    successfully` could all be used to describe a failure, but there are no shared
    strings to search for.
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Let’s consider a real log entry from a computer system to see how log data
    is usually represented:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 1.4 – Logs showing discrete events in time](img/B18277_01_4.jpg)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
- en: Figure 1.4 – Logs showing discrete events in time
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: We can clearly see that we have a number of fields that have been extracted
    from the log entry by the system. These fields detail where the log entry originated
    from, what time it occurred, and various other items.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: Distributed traces
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Distributed traces** show the end-to-end journey of an action. They are captured
    from every step that is taken to complete the action. Let’s imagine a trace that
    covers the passage of a ship through the lock system. We will be interested in
    the time a ship enters and leaves each lock, and we will want to be able to compare
    different ships using the system. A full passage can be given an identifier, usually
    called a **trace ID**. Traces are made up of **spans**. In our example, a span
    would cover the entry and exit for each individual lock. These spans are given
    a second identifier, called a **span ID**. To tie these two together, each span
    in a trace references the trace ID for the whole trace. The following screenshot
    shows an example of how a distributed trace is represented for a computer application:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 1.5 – Traces showing the relationship of actions over time](img/B18277_01_5.jpg)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
- en: Figure 1.5 – Traces showing the relationship of actions over time
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
- en: 'Now that we have introduced metrics, logs, and traces, let’s consider a more
    detailed example of a ship passing through the locks, and how each telemetry type
    would be produced in this process:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: 'Ship enters the first lock:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Span ID created
  id: totrans-74
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Trace ID created
  id: totrans-75
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Contextual information is added to the span, for example, a ship identification
  id: totrans-76
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Key events are recorded in the span with time stamps, for example, gates are
    opened and closed
  id: totrans-77
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Ship exits the first lock:'
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Span closed and submitted to the recording system
  id: totrans-79
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Second lock notified of trace ID and span ID
  id: totrans-80
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Ship enters the second lock:'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Span ID created
  id: totrans-82
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Trace ID added to span
  id: totrans-83
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Contextual information is added to the span
  id: totrans-84
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Key events recorded in the span with time stamps
  id: totrans-85
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Ship exits the second lock:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Span closed and submitted to the recording system
  id: totrans-87
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Third lock notified of trace ID and span ID
  id: totrans-88
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Ship enters the third lock:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Repeat *step 3*
  id: totrans-90
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Ship exits the third lock:'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Span closed and submitted to the recording system
  id: totrans-92
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Now let’s look at some other telemetry types.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
- en: Other telemetry types
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Metrics, logs, and traces are often called the *three pillars* or the *golden
    triangle* of observability. As we outlined earlier, observability is the ability
    to understand a system. While metrics, logs, and traces give us a very good ability
    to understand a system, they are not the only signals we might need, as this depends
    at what abstraction layer we need to observe the system. For instance, when looking
    at a very detailed level, we may be very interested in the stack trace of an application’s
    activity at the CPU and RAM level. Conversely, if we are interested in the execution
    of a CI/CD pipeline, we may just be interested in whether a deployment occurred
    and nothing more.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
- en: '**Profiling data** (**stack traces**) can give us a very detailed technical
    view of the system’s use of resources such as CPU cycles or memory. With cloud
    services often charged per hour for these resources, this kind of detailed analysis
    can easily create cost savings.'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: Similarly, **events** can be consumed from a platform, such as CI/CD. These
    can offer a huge amount of insight that can reduce the **Mean Time to Recovery**
    (**MTTR**). Imagine responding to an out-of-hours alert and seeing that a new
    version of a service was deployed immediately before the issues started occurring.
    Even better, imagine not having to wake up because the deployment process could
    check for failures and roll back automatically. Events differ from logs only in
    that an event represents a whole action. In our earlier example in the *Logs*
    section, we created five logs, but all of these referred to stages of the same
    event (opening the lock gate). As a relatively generic term, *event* gets used
    with other meanings.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
- en: Now that we’ve introduced the fundamental concepts of the technology, let’s
    talk about the customers who will use observability data.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
- en: Introducing the user personas of observers
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Observability deals with understanding a system, identifying whether something
    is wrong with that system, and understanding why it is wrong. But what do we mean
    by *understanding a system*? The simple answer would be *knowing the state of
    a single application or* *infrastructure component*.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
- en: In this section, we will introduce the user personas that we will use throughout
    this book. These personas will help to distinguish the different types of questions
    that people use observability systems to answer.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s take a quick look at the user personas that will be used throughout the
    book as examples, and their roles:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
- en: '|  | **Name** **and role** | **Description** |'
  id: totrans-103
  prefs: []
  type: TYPE_TB
- en: '| ![](img/B18277_01_6.png) | Diego Developer | Frontend, backend, full stack,
    and so on |'
  id: totrans-104
  prefs: []
  type: TYPE_TB
- en: '| ![](img/B18277_01_7.png) | Ophelia Operator | SRE, DevOps, DevSecOps, customer
    success, and so on |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
- en: '| ![](img/B18277_01_8.png) | Steven Service | Service manager and other tasks
    |'
  id: totrans-106
  prefs: []
  type: TYPE_TB
- en: '| ![](img/B18277_01_9.png) | Pelé Product | Product manager, product owner,
    and so on |'
  id: totrans-107
  prefs: []
  type: TYPE_TB
- en: '| ![A picture containing vector graphics'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: Description automatically generated](img/B18277_01_10.png) | Masha Manager |
    Manager, senior leadership, and so on |
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18277_01_10.png) | Masha 经理 | 经理，高层领导等 |
- en: Table 1.1 – User persona introductions
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 表 1.1 – 用户角色介绍
- en: Now let’s look at each of these users in greater detail.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们更详细地了解这些用户。
- en: Diego Developer
  id: totrans-112
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Diego 开发人员
- en: '![](img/B18277_01_11.jpg)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18277_01_11.jpg)'
- en: '*Diego Developer* works on many types of systems, from frontend applications
    that customers directly interact with, to backend systems that let his organization
    store data in ways that delight its customers. You might even find him working
    on platforms that other developers use to get their applications integrated, built,
    delivered, and deployed safely and speedily.'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '*Diego 开发人员* 工作在许多类型的系统上，从客户直接交互的前端应用程序，到让组织能够以令人满意的方式存储数据的后端系统。你甚至可能会发现他在为其他开发人员工作的平台上工作，这些平台帮助他们的应用程序安全、快速地集成、构建、交付和部署。'
- en: Goals
  id: totrans-115
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目标
- en: He writes great software that is well tested and addresses customers’ actual
    needs.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 他编写出色的软件，经过充分测试，且解决了客户的实际需求。
- en: Interactions
  id: totrans-117
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 互动
- en: When he is not writing code, he works with *Ophelia Operator* to address any
    questions and issues that occur.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 当他不在编写代码时，他会与 *Ophelia 操作员* 一起处理出现的任何问题和疑问。
- en: '*Pelé Product* works in his team and provides insight into the customer’s needs.
    They work together closely, taking those needs and turning them into detailed
    plans on how to deliver software that addresses them.'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '*Pelé 产品* 在他的团队中工作，提供客户需求的洞察。他们紧密合作，将这些需求转化为详细的计划，制定如何交付解决这些需求的软件。'
- en: '*Steven Service* is keen to ensure that the changes Diego makes are not impacting
    customer commitments. He’s also the one who wakes Diego up if there is an incident
    that needs attention. The data provided to *Masha Manager* gives her a breakdown
    of costs. When Diego is working on developer platforms, he also collects data
    that helps her get investment from the business into teams that are not performing
    as expected.'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: '*Steven 服务* 非常关注 Diego 所做的更改是否会影响客户的承诺。如果发生需要关注的事故，他也会是第一个叫醒 Diego 的人。提供给 *Masha
    经理* 的数据帮助她了解成本分解。当 Diego 在开发平台上工作时，他还收集数据，帮助她获得来自业务的投资，用于那些表现不如预期的团队。'
- en: Needs
  id: totrans-121
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 需求
- en: Diego really needs easy-to-use libraries for the languages he uses to instrument
    the code he produces. He does not have time to become an expert. He wants to be
    able to add a few lines of code and get results quickly.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: Diego 真的需要一些易于使用的库来支持他编写的代码。他没有时间成为专家，他希望能够添加几行代码并迅速获得结果。
- en: Having a clear standard for acceptable performance measures makes it easy for
    him to get the right results.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 拥有明确的标准来衡量可接受的性能，使他能够轻松获得正确的结果。
- en: Pain points
  id: totrans-124
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 痛点
- en: When Diego’s systems produce too much data, he finds it difficult to sort signal
    from noise. He also gets frustrated having to change his code because of an upstream
    decision to change tooling.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 当 Diego 的系统产生过多数据时，他发现很难从噪声中提取有用的信息。他也会因为上游决定更改工具而不得不修改代码，这让他感到沮丧。
- en: Ophelia Operator
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Ophelia 操作员
- en: '![](img/B18277_01_12.jpg)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18277_01_12.jpg)'
- en: '*Ophelia Operator* works in an operations-focused environment. You might find
    her in a customer-facing role or as part of a development team as a DevOps engineer.
    She could be part of a group dedicated to the reliability of an organization’s
    systems, or she could be working in security or finance to ensure the business
    runs securely and smoothly.'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '*Ophelia 操作员* 工作在一个以运营为重点的环境中。你可能会看到她在客户服务角色中，或者作为开发团队的一员担任 DevOps 工程师。她可能是一个专注于组织系统可靠性的团队成员，或者她也可能在安全或金融领域工作，以确保业务安全平稳地运行。'
- en: Goals
  id: totrans-129
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目标
- en: Ophelia wants to make sure a product is functioning as expected. She also likes
    it when she is not woken up early in the morning by an incident.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: Ophelia 希望确保产品按预期运行。她也喜欢在没有被早晨的事故叫醒时，能保持安稳的工作。
- en: Interactions
  id: totrans-131
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 互动
- en: Ophelia will work a lot with *Diego Developer*; sometimes it’s escalating customer
    tickets when she doesn’t have the data available to understand the problem; at
    other times it’s developing runbooks to keep the systems running. Sometimes she
    will need to give Diego clear information on acceptable performance measures so
    that her team can make sure systems perform well for customers.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: Ophelia 将与 *Diego 开发人员* 密切合作；有时是当她无法获得数据来理解问题时，需要提升客户的工单；有时是开发运行手册，以确保系统持续运行。有时，她还需要向
    Diego 提供有关可接受性能指标的明确指导，以便她的团队能够确保系统对客户表现良好。
- en: '*Steven Service* works closely with Ophelia. They work together to ensure there
    are not many incidents, and that they are quickly resolved. Steven makes sure
    that business data on changes and incidents is tracked, and tweaks processes when
    things aren’t working.'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: '*Steven Service* 与 Ophelia 紧密合作。他们一起工作，确保事件尽量少发生，并且能够快速解决。Steven 确保跟踪业务数据中的变更和事件，并在事情不顺时调整流程。'
- en: '*Pelé Product* likes to have data showing the problematic areas of his products.'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '*Pelé Product* 喜欢拥有显示其产品问题领域的数据。'
- en: Needs
  id: totrans-135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 需求
- en: Good data is necessary to do the job effectively. Being able to see that a customer
    has encountered an error can make the difference between resolving a problem straight
    away or having them wait maybe weeks for a response.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 有效的工作需要良好的数据。能够看到客户遇到错误，可能决定了是立即解决问题，还是让客户等待几周才能得到回应。
- en: During an incident seeing that a new version of a service was deployed at the
    time a problem started can change an hours-long incident into a brief blip, and
    keep customers happy.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在一次事故中，看到在问题开始时部署了新版本的服务，可以将一个持续数小时的事件转变为短暂的波动，从而让客户保持满意。
- en: Pain points
  id: totrans-138
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 痛点
- en: Getting continuous alerts but not being empowered to fix the underlying issue
    is a big problem. Ophelia has seen colleagues burn out, and it makes her want
    to leave the organization when this happens.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 持续收到警报但无法解决根本问题是一个大问题。Ophelia 曾看到同事们因过度工作而精疲力尽，每当这种情况发生时，她也会想离开组织。
- en: Steven Service
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Steven Service
- en: '![](img/B18277_01_13.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18277_01_13.jpg)'
- en: '*Steven Service* works in service delivery. He is interested in making sure
    the organization’s services are delivered smoothly. Jumping in on critical incidents
    and coordinating actions to get them resolved as quickly as possible is part of
    the job. So is ensuring that changes are made using processes that help others
    do it as safely as possible. Steven also works with third parties who provide
    services that are critical to the running of the organization.'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '*Steven Service* 从事服务交付工作。他关心的是确保组织的服务能够顺利交付。在关键事件中介入并协调行动，确保尽快解决问题，是工作的一部分。同样，确保通过帮助他人以最安全的方式进行变更的流程也是他的责任。Steven
    还与为组织运行提供关键服务的第三方供应商合作。'
- en: Goals
  id: totrans-143
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目标
- en: He wants services to run as smoothly as possible so that the organization can
    spend more time focused on customers.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 他希望服务能够尽可能顺利运行，这样组织可以更多地专注于客户。
- en: Interactions
  id: totrans-145
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 互动
- en: '*Diego Developer* and *Ophelia Operator* work a lot with the change management
    processes created by *Steven* and the support processes he manages. Having accurate
    data to hand during change management really helps to make the process as smooth
    as possible.'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '*Diego Developer* 和 *Ophelia Operator* 经常与 *Steven* 创建的变更管理流程以及他管理的支持流程一起工作。在变更管理过程中，拥有准确的数据非常有帮助，可以确保流程尽可能顺畅。'
- en: Steven works very closely with *Masha Manager* to make sure she has access to
    data showing where processes are working smoothly and where they need to spend
    time improving them.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: Steven 与 *Masha Manager* 紧密合作，确保她能够访问展示哪些流程运作顺畅、哪些流程需要花时间改进的数据。
- en: Needs
  id: totrans-148
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 需求
- en: He needs to be able to compare the delivery of different products and provide
    that data to *Masha* and the business.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 他需要能够比较不同产品的交付情况，并将这些数据提供给 *Masha* 和业务部门。
- en: During incidents, he needs to be able to get the right people on the call as
    quickly as possible and keep a record of what happened for the incident post-mortem.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在事故中，他需要尽可能快速地把合适的人找来开会，并且为事后分析保存记录。
- en: Pain points
  id: totrans-151
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 痛点
- en: Being able to identify the right person to get on a call during an incident
    is a common problem he faces. Seeing incidents drag on while different systems
    are compared and who can fix the problem is argued about is also a big concern
    to him.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在事故中，能够识别出合适的人来参加电话会议是他面临的常见问题。看到不同系统之间的对比，且谁能解决问题的问题一直争论不休，也让他非常担忧。
- en: Pelé Product
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Pelé 产品
- en: '![](img/B18277_01_14.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18277_01_14.jpg)'
- en: '*Pelé Product* works in the product team. You’ll find him working with customers
    to understand their needs, keeping product roadmaps in order, and communicating
    requirements back to developers such as *Diego Developer* so they can build them.
    You might also find him understanding and shaping the product backlog for the
    internal platforms used by developers in the organization.'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '*Pelé Product* 在产品团队工作。你会看到他与客户一起工作，了解他们的需求，保持产品路线图有序，并将需求传达给开发人员，例如 *Diego
    Developer*，以便他们进行开发。你还可能看到他在理解并制定产品待办事项，以支持组织内开发人员使用的内部平台。'
- en: Goal
  id: totrans-156
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目标
- en: Pelé wants to understand customers, give them products that delight them, and
    keep them coming back.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: Pelé 想要了解客户，给他们提供令人愉悦的产品，并让他们不断回归。
- en: Interactions
  id: totrans-158
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 互动
- en: He spends a lot of time working with *Diego* when they can look at the same
    information to really understand what customers are doing and how they can help
    them do it better.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 他花了很多时间与*Diego*一起工作，他们可以查看相同的信息，真正理解客户在做什么，以及如何帮助他们做得更好。
- en: '*Ophelia Operator* and *Steven Service* help *Pelé* keep products on track.
    If too many incidents occur, they ask everyone to refocus on getting stability
    right. There is no point in providing customers with lots of features on a system
    that they can’t trust.'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '*Ophelia Operator* 和 *Steven Service* 帮助 *Pelé* 保持产品的进度。如果发生了太多的事件，他们会要求大家重新集中精力确保稳定性。向客户提供大量特性却没有信任保障是没有意义的。'
- en: '*Pelé* works closely with *Masha Manager* to ensure the organization has the
    right skills in the teams that build products. The business depends on her leadership
    to make sure that these developers have the best tools to help them get their
    code live in front of customers where it can be used.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '*Pelé* 与 *Masha Manager* 紧密合作，确保组织中拥有构建产品所需的合适技能团队。商业依赖她的领导力，确保这些开发人员拥有最佳的工具，帮助他们将代码推送到客户面前，使其能够使用。'
- en: Needs
  id: totrans-162
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 需求
- en: '*Pelé* needs to be able to understand customers’ pain points even when they
    do not articulate them clearly during user research.'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '*Pelé* 需要能够理解客户的痛点，即使他们在用户研究中未能清楚表达这些问题。'
- en: He needs data that gives him a common language with *Diego* and *Ophelia*. Sometimes
    they can get too focused on specific numbers such as shaving off a couple of milliseconds
    from a request, when improving a poor workflow would improve the customer experience
    more significantly.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 他需要能够为自己和 *Diego*、*Ophelia* 提供共同语言的数据。有时候，他们可能会过于关注一些具体数字，例如减少请求的毫秒数，而实际上，改善一个糟糕的工作流程对客户体验的提升会更为显著。
- en: Pain points
  id: totrans-165
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 痛点
- en: '*Pelé* hates not being able to see at a high level what customers are doing.
    Understanding which bits of an application have the most usage, and which bits
    are not used at all, lets him know where to focus time and resources.'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '*Pelé* 讨厌无法高层次地看到客户的行为。了解应用程序中最常使用的部分以及完全不被使用的部分，能让他知道应该在哪些方面集中时间和资源。'
- en: While customers never tell him they want stability, if it’s not there they will
    lose trust very quickly and start to look at alternatives.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管客户从不直接告诉他他们需要稳定性，但如果缺乏这一点，他们会迅速失去信任，并开始寻找替代方案。
- en: Masha Manager
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Masha 经理
- en: '![](img/B18277_01_15.jpg)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18277_01_15.jpg)'
- en: '*Masha* works in management. You might find her leading a team and working
    closely with them daily. She also represents middle management, setting strategy
    and making tactical choices, and she is involved, to some extent, in senior leadership.
    Much of her role involves managing budgets and people. If something can make that
    process easier, then she is usually interested in hearing about it. What *Masha*
    does not want to do is waste the organization’s money, because that can directly
    impact jobs.'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '*Masha* 从事管理工作。你可能会看到她领导一个团队并与他们日常密切合作。她还代表中层管理，负责制定战略和做出战术选择，并在一定程度上参与高级领导工作。她的大部分工作涉及管理预算和人员。如果有什么能够简化这个过程，她通常会很感兴趣。*Masha*
    不希望浪费组织的资金，因为那可能直接影响到员工的工作。'
- en: Goals
  id: totrans-171
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目标
- en: Her primary goals are to keep the organization running smoothly and ensure the
    budget is balanced.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 她的主要目标是确保组织顺利运行，并确保预算保持平衡。
- en: Interactions
  id: totrans-173
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 互动
- en: As a leader, *Masha* needs accurate data and needs to be able to trust the teams
    who provide that data. The data could be the end-to-end cycle time of feature
    concept to delivery from *Pelé Product*, the lead time for changes from *Diego
    Developer*, or even the MTTR from *Steven Service*. Having that data helps her
    to understand where focus and resources can have the biggest impact.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 作为领导者，*Masha* 需要准确的数据，并且需要能够信任那些提供数据的团队。这些数据可以是从 *Pelé Product* 提供的特性概念到交付的端到端周期时间，*Diego
    Developer* 提供的变更前置时间，或者 *Steven Service* 提供的平均修复时间（MTTR）。拥有这些数据有助于她理解在哪些方面集中精力和资源能带来最大的影响。
- en: '*Masha* works regularly with the financial operations staff and needs to make
    sure they have accurate information on the organization’s expenditure and the
    value that expenditure provides.'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: '*Masha* 定期与财务运营人员合作，确保他们了解组织的支出和这些支出所带来的价值。'
- en: Needs
  id: totrans-176
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 需求
- en: She needs good data in a place where she can view it and make good decisions.
    This usually means she consumes information from a business intelligence system.
    To use such tools effectively, she needs to be clear on what the organization’s
    goals are, so that the correct data can be collected to help her understand how
    her teams are tracking to that goal.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
- en: She also needs to know that the teams she is responsible for have the correct
    data and tools to excel in their given areas.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
- en: Pain points
  id: totrans-179
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: High failure rates and long recovery time usually result in her having to speak
    with customers to apologize. *Masha* really hates these calls!
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: Poor visibility of cloud systems is a particular concern. *Masha* has too many
    horror stories of huge overspending caused by a lack of monitoring; she would
    rather spend that budget on something more useful.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
- en: You now know about the customers who use observability data, and the types of
    data you will be using to meet their needs. As the main focus of this book is
    on Grafana as the underlying technology, let’s now introduce the tools that make
    up the Grafana stack.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
- en: Introducing the Grafana stack
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Grafana was born in 2013 when a developer was looking for a new user interface
    to display metrics from Graphite. Initially forked from Kibana, the Grafana project
    was developed to make it easy to build quick, interactive dashboards that were
    valuable to organizations. In 2014, **Grafana Labs** was formed with the core
    value of building a sustainable business with a strong commitment to open source
    projects. From that foundation, Grafana has grown into a strong company supporting
    more than 1 million active installations. Grafana Labs is a huge contributor to
    open source projects, from their own tools to widely adopted technologies such
    as Prometheus, and recent initiatives with a lot of traction such as OpenTelemetry.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
- en: 'Grafana offers many tools, which we’ve grouped into the following categories:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
- en: 'The core Grafana stack: **LGTM** and the **Grafana Agent**'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Grafana enterprise plugins
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Incident response tools
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Other Grafana tools
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let’s explore these tools in the following sections.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
- en: The core Grafana stack
  id: totrans-191
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The core Grafana stack consists of Mimir, Loki, Tempo, and Grafana; the acronym
    LGTM is often used to refer to this tech stack.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
- en: Mimir
  id: totrans-193
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Mimir** is a **Time Series Database** (**TSDB**) for the storage of metric
    data. It uses low-cost object storage such as S3, GCS, or Azure Blob Storage.
    First announced for general availability in March 2022, Mimir is the newest of
    the four products we’ll discuss here, although it’s worth highlighting that Mimir
    initially forked from another project, Cortex, which was started in 2016\. Parts
    of Cortex also form the core of Loki and Tempo.'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
- en: Mimir is a fully Prometheus-compatible solution that addresses the common scalability
    problems encountered with storing and searching huge quantities of metric data.
    In 2021 Mimir was load tested to 1 billion active time series. An active time
    series is a metric with a value and unique labels that has reported a sample in
    the last 20 minutes. We will explore Mimir and Prometheus in much greater detail
    in [*Chapter 5*](B18277_05.xhtml#_idTextAnchor106).
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: Loki
  id: totrans-196
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Loki** is a set of components that offer a full feature logging stack. Loki
    uses lower-cost object storage such as S3 or GCS, and only indexes label metadata.
    Loki entered general availability in November 2019.'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
- en: Log aggregation tools typically use two data structures to store log data. An
    index that contains references to the location of the raw data paired with searchable
    metadata, and the raw data itself stored in a compressed form. Loki differs from
    a lot of other log aggregation tools by keeping the index data relatively small
    and scaling the search functionality by using horizontal scaling of the querying
    component. The process of selecting the best index fields is one we will cover
    in [*Chapter 4*](B18277_04.xhtml#_idTextAnchor092).
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: Tempo
  id: totrans-199
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Tempo** is a storage backend for high-scale distributed trace telemetry,
    with the aim of sampling 100% of the read path. Like Loki and Mimir, it leverages
    lower-cost object storage such as S3, GCS, or Azure Blob Storage. Tempo went into
    general availability in June 2021.'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
- en: When Tempo released 1.0, it was tested at a sustained ingestion of >2 million
    spans per second (about 350 MB per second). Tempo also offers the ability to generate
    metrics from spans as they are ingested; these metrics can be written to any backend
    that supports Prometheus remote write. Tempo is explored in detail in [*Chapter
    6*](B18277_06.xhtml#_idTextAnchor134).
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
- en: Grafana
  id: totrans-202
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Grafana** has been a staple for fantastic visualization of data since 2014\.
    It has targeted the ability to connect to a huge variety of data sources from
    TSDBs to relational databases and even other observability tools. Grafana has
    over 150 data source plugins available. Grafana has a huge community using it
    for many different purposes. This community supports over 6,000 dashboards, which
    means there is a starting place for most available technologies with minimal time
    to value.'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
- en: Grafana Agent
  id: totrans-204
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Collecting telemetry from many places is one of the fundamental aspects of observability.
    **Grafana Agent** is a collection of tools for collecting logs, metrics, and traces.
    There are many other collection tools that Grafana integrates well with. Different
    collection tools offer different advantages and disadvantages, which is not a
    topic we will explore in this book. We will highlight other tools in the space
    later in this chapter and in [*Chapter 2*](B18277_02.xhtml#_idTextAnchor043) to
    give you a starting point for learning more about this topic. We will also briefly
    discuss architecting a collection infrastructure in [*Chapter 11*](B18277_11.xhtml#_idTextAnchor218).
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: The Grafana stack is a fantastic group of open source software for observability.
    The commitment of Grafana Labs to open source is supported by great enterprise
    plugins. Let’s explore them now.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: Grafana Enterprise plugins
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As part of their Cloud Pro, Cloud Advanced, and Enterprise license offerings,
    Grafana offers Enterprise plugins. These are part of any paid subscription to
    Grafana.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: The Enterprise data source plugins allow organizations to read data from many
    other storage tools they may use, from software development tools such as **GitLab**
    and **Azure DevOps** to business intelligence tools such as **Snowflake**, **Databricks**,
    and **Looker**. Grafana also offers tools to read data from many other observability
    tools, which enables organizations to build comprehensive operational coverage
    while offering individual teams a choice of the tools they use.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
- en: Alongside the data source plugins, Grafana offers premium tools for logs, metrics,
    and traces. These include access policies and tokens for log data to secure sensitive
    information, in-depth health monitoring for the ingest and storage of cloud stacks,
    and management of tenants.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
- en: Grafana incident response and management
  id: totrans-211
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Grafana offers three products in the **incident response and management** (**IRM**)
    space:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
- en: At the foundation of IRM are **alerting rules**, which can notify via messaging
    apps, email, or Grafana OnCall
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Grafana OnCall** offers an on-call schedule management system that centralizes
    alert grouping and escalation routing'
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finally, **Grafana Incident** offers a chatbot functionality that can set up
    necessary incident spaces, collect timelines for a post-incident review process,
    and even manage the incident directly from a messaging service
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These tools are covered in more detail in [*Chapter 9*](B18277_09.xhtml#_idTextAnchor183).
    Now let’s take a look at some other important Grafana tools.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: Other Grafana tools
  id: totrans-217
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Grafana Labs continues to be a leader in observability and has acquired several
    companies in this space to release new products that complement the tools we’ve
    already discussed. Let’s discuss some of these tools now.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
- en: Faro
  id: totrans-219
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Grafana Faro** is a JavaScript agent that can be added to frontend web applications.
    The project allows for **real user monitoring** (**RUM**) by collecting telemetry
    from a browser. By adding RUM into an environment where backend applications and
    infrastructure are instrumented, observers gain the ability to traverse data from
    the full application stack. Faro supports the collection of the five core web
    vitals out of the box, as well as several other signals of interest. Faro entered
    general availability in November 2022\. We cover Faro in more detail in [*Chapter
    12*](B18277_12.xhtml#_idTextAnchor231).'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
- en: k6
  id: totrans-221
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**k6** is a load testing tool that provides both a packaged tool to run in
    your own infrastructure and a cloud **Software as a Service** (**SaaS**) offering.
    Load testing, especially as part of a CI/CD pipeline, really enables teams to
    see how their application will perform under load, and evaluate optimizations
    and refactoring. Paired with other detailed analysis tools such as Pyroscope,
    the level of visibility and accessibility to non-technical members of the team
    can be astounding. The project started back in 2016 and was acquired by Grafana
    Labs in June 2021\. The goal of k6 is to make performance testing easy and repeatable.
    We’ll explore k6 in [*Chapter 13*](B18277_13.xhtml#_idTextAnchor239).'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
- en: Pyroscope
  id: totrans-223
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Pyroscope** is a recent acquisition of Grafana Labs, joining in March 2023\.
    Pyroscope is a tool that enable teams to engage in the continuous profiling of
    system resource use by applications (CPU, memory, etc.). Pyroscope advertises
    that with a minimal overhead of ~2-5% of performance, they can collect samples
    as frequently as every 10 seconds. **Phlare** is a Grafana Labs project started
    in 2022, and the two projects have now merged. We discuss Pyroscope in more detail
    in [*Chapter 13*](B18277_13.xhtml#_idTextAnchor239).'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
- en: Now that you know the different tools available from Grafana Labs, let’s look
    at some alternatives that are available.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
- en: Alternatives to the Grafana stack
  id: totrans-226
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The monitoring and observability space is packed with different open and closed
    source solutions such as `ps` and `top` going back to the 70s and 80s. We will
    not attempt to list every tool here; we aim to offer a source of inspiration for
    people who are curious and want to explore, or who need a quick reference of the
    available tools (as the authors have on a few occasions).
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
- en: Data collection
  id: totrans-228
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'These are agent tools that can be used to collect telemetry from the source:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
- en: '| **Tool Name** | **Telemetry Types** |'
  id: totrans-230
  prefs: []
  type: TYPE_TB
- en: '| OpenTelemetry Collector | Metrics, logs, traces |'
  id: totrans-231
  prefs: []
  type: TYPE_TB
- en: '| FluentBit | Metrics, logs, traces |'
  id: totrans-232
  prefs: []
  type: TYPE_TB
- en: '| Vector | Metrics, logs, traces |'
  id: totrans-233
  prefs: []
  type: TYPE_TB
- en: '| Vendor-specific agents(See the *Data storage, processing, and visualization*
    section for an expanded list) | Metrics, logs, traces |'
  id: totrans-234
  prefs: []
  type: TYPE_TB
- en: '| Beats family | Metrics, logs |'
  id: totrans-235
  prefs: []
  type: TYPE_TB
- en: '| Prometheus | Metrics |'
  id: totrans-236
  prefs: []
  type: TYPE_TB
- en: '| Telegraf | Metrics |'
  id: totrans-237
  prefs: []
  type: TYPE_TB
- en: '| StatsD | Metrics |'
  id: totrans-238
  prefs: []
  type: TYPE_TB
- en: '| Collectd | Metrics |'
  id: totrans-239
  prefs: []
  type: TYPE_TB
- en: '| Carbon | Metrics |'
  id: totrans-240
  prefs: []
  type: TYPE_TB
- en: '| Syslog-ng | Logs |'
  id: totrans-241
  prefs: []
  type: TYPE_TB
- en: '| Rsyslog | Logs |'
  id: totrans-242
  prefs: []
  type: TYPE_TB
- en: '| Fluentd | Logs |'
  id: totrans-243
  prefs: []
  type: TYPE_TB
- en: '| Flume | Logs |'
  id: totrans-244
  prefs: []
  type: TYPE_TB
- en: '| Zipkin Collector | Traces |'
  id: totrans-245
  prefs: []
  type: TYPE_TB
- en: Table 1.2 – Data collection tools
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
- en: Data collection is only one piece of the extract transform and load process
    for observability data. The next section introduces tools to transform and load
    data.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
- en: Data storage, processing, and visualization
  id: totrans-248
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We’ve grouped data processing, storage, and visualization together, as there
    are often a lot of crossovers among them. There are certain tools that also provide
    **security monitoring** and are closely related. However, as this topic is outside
    of the scope of this book, we have chosen to exclude tools that are solely in
    the security space.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
- en: '| **Tool Name** | **Tool Name** | **Tool Name** |'
  id: totrans-250
  prefs: []
  type: TYPE_TB
- en: '| AppDynamics | InfluxDB | Sematext |'
  id: totrans-251
  prefs: []
  type: TYPE_TB
- en: '| Aspecto | Instana | Sensu |'
  id: totrans-252
  prefs: []
  type: TYPE_TB
- en: '| AWS CloudWatch & CloudTrail | Jaeger | Sentry |'
  id: totrans-253
  prefs: []
  type: TYPE_TB
- en: '| Azure Application insights | Kibana | Serverless360 |'
  id: totrans-254
  prefs: []
  type: TYPE_TB
- en: '| Centreon | Lightstep | SigNoz |'
  id: totrans-255
  prefs: []
  type: TYPE_TB
- en: '| ClickHouse | Loggly | SkyWalking |'
  id: totrans-256
  prefs: []
  type: TYPE_TB
- en: '| Coralogix | LogicMonitor | Solarwinds |'
  id: totrans-257
  prefs: []
  type: TYPE_TB
- en: '| Cortex | Logtail | Sonic |'
  id: totrans-258
  prefs: []
  type: TYPE_TB
- en: '| Cyclotron | Logz.io | Splunk |'
  id: totrans-259
  prefs: []
  type: TYPE_TB
- en: '| Datadog | Mezmo | Sumo Logic |'
  id: totrans-260
  prefs: []
  type: TYPE_TB
- en: '| Dynatrace | Nagios | TelemetryHub |'
  id: totrans-261
  prefs: []
  type: TYPE_TB
- en: '| Elastic | NetData | Teletrace |'
  id: totrans-262
  prefs: []
  type: TYPE_TB
- en: '| GCP Cloud Operations Suite | New Relic | Thanos |'
  id: totrans-263
  prefs: []
  type: TYPE_TB
- en: '| Grafana Labs | OpenSearch | Uptrace |'
  id: totrans-264
  prefs: []
  type: TYPE_TB
- en: '| Graphite | OpenTSDB | VictoriaMetrics |'
  id: totrans-265
  prefs: []
  type: TYPE_TB
- en: '| Graylog | Prometheus | Zabbix |'
  id: totrans-266
  prefs: []
  type: TYPE_TB
- en: '| Honeycomb | Scalyr | Zipkin |'
  id: totrans-267
  prefs: []
  type: TYPE_TB
- en: Table 1.3 – Data storage processing and visualization tools
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
- en: With a good understanding of the tools available in this space, let’s now look
    at the ways we can deploy the tools offered by Grafana.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
- en: Deploying the Grafana stack
  id: totrans-270
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Grafana Labs fully embraces its history as an open source software provider.
    The LGTM stack, alongside most other components, is open source. There are a few
    value-added components that are offered as part of an enterprise subscription.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
- en: As a SaaS offering, Grafana Labs provides access to storage for Loki, Mimir,
    and Tempo, alongside Grafana’s 100+ integrations for external data sources. As
    a SaaS customer, you also gain ready access to a huge range of other tools you
    may use and can present them in a consolidated manner, in a single pane of glass.
    The SaaS offering allows organizations to leverage a full-featured observability
    platform without the operational overhead of running the platform and obtaining
    service level agreements for the operation of the platform.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
- en: As well as managing the platform for you, you can run Grafana on your organization’s
    infrastructure. Grafana offers its software packaged in several formats for Linux
    and Windows deployments, as well as offering containerized versions. Grafana also
    offers Helm and Tanka configuration wrappers for each of their tools. This book
    will mainly concentrate on the SaaS offering because it is easy to get started
    with the free tier. We will explore some areas where a local installation can
    assist in *Chapters 11* and *14*, which cover architecting and supporting DevOps
    processes respectively.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-274
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, you have been introduced to monitoring and observability, how
    they are similar, and how they differ. The Agua Clara locks on the Panama Canal
    acted as a simplified example of the concepts of observability in practice. The
    key takeaway should be to understand that even when a system produces alerts for
    significant problems, the same data can be used to observe and investigate other
    potential problems.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
- en: We also talked about the customers who might use observability systems. These
    customers will be referenced throughout this book when we explore a concept and
    how to target its implementation.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
- en: Finally, we introduced the full Grafana Labs stack, and you should now have
    a good understanding of the different purposes that each product serves.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will introduce the basics of adding instrumentation
    to applications or infrastructure components for readers whose roles are similar
    to those of Diego and Ophelia.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL

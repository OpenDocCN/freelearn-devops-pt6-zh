<html><head></head><body>
<div id="_idContainer056">
<h1 class="chapter-number" id="_idParaDest-263"><a id="_idTextAnchor274"/><span class="koboSpan" id="kobo.1.1">14</span></h1>
<h1 id="_idParaDest-264"><a id="_idTextAnchor275"/><span class="koboSpan" id="kobo.2.1">Conclusion and the Future of Kubernetes Secrets Management </span></h1>
<p><span class="koboSpan" id="kobo.3.1">This handbook provided you with the fundamental components to secure your container orchestration platform, serving as a reference to continuously improve your security posture while having observed the needs of external solutions to enhance or address the current Kubernetes design when it comes to </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">Secrets management.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">In this last chapter, we are going to cover the following </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">main topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.7.1">The current state of Kubernetes and what it brings to </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">Secrets management</span></span></li>
<li><span class="koboSpan" id="kobo.9.1">The future brought by the Kubernetes projects and how to </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">influence it</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">How to stay up to date with the latest trends </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">and practices</span></span></li>
</ul>
<h1 id="_idParaDest-265"><a id="_idTextAnchor276"/><span class="koboSpan" id="kobo.13.1">The current state of Kubernetes</span></h1>
<p><span class="koboSpan" id="kobo.14.1">With the </span><a id="_idIndexMarker872"/><span class="koboSpan" id="kobo.15.1">widespread adoption of Kubernetes, this handbook shows solutions that can leverage Kubernetes native constructs as an internal vault solution as well as external ones from Azure, AWS, GCP, and HashiCorp. </span><span class="koboSpan" id="kobo.15.2">A combination of the two might be required to improve the security posture when managing Secrets for both the platform components </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">and applications.</span></span></p>
<p><span class="koboSpan" id="kobo.17.1">These solutions serve as safeguards to sensitive information stored within Kubernetes clusters and revolve around the principle of storing, managing, and distributing API keys, passwords, and certificates with no or limited security exposure safely </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">and securely.</span></span></p>
<h2 id="_idParaDest-266"><a id="_idTextAnchor277"/><span class="koboSpan" id="kobo.19.1">Native solutions</span></h2>
<p><span class="koboSpan" id="kobo.20.1">The Kubernetes project </span><a id="_idIndexMarker873"/><span class="koboSpan" id="kobo.21.1">uses </span><strong class="bold"><span class="koboSpan" id="kobo.22.1">Kubernetes Enhancement Proposal</span></strong><span class="koboSpan" id="kobo.23.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.24.1">KEP</span></strong><span class="koboSpan" id="kobo.25.1">) to document the design changes with the targeted </span><a id="_idIndexMarker874"/><span class="koboSpan" id="kobo.26.1">releases for the alpha, beta, and </span><strong class="bold"><span class="koboSpan" id="kobo.27.1">general availability</span></strong><span class="koboSpan" id="kobo.28.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.29.1">GA</span></strong><span class="koboSpan" id="kobo.30.1">) of these sets </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">of changes.</span></span></p>
<h3><span class="koboSpan" id="kobo.32.1">The KMS provider</span></h3>
<p><span class="koboSpan" id="kobo.33.1">KEP has been </span><a id="_idIndexMarker875"/><span class="koboSpan" id="kobo.34.1">documenting security changes concerning the native Kubernetes Secrets management since version 1.25 with the </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">following themes:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.36.1">Implement seamless </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">key rotation</span></span></li>
<li><span class="koboSpan" id="kobo.38.1">Introduce health checks </span><span class="No-Break"><span class="koboSpan" id="kobo.39.1">for reliability</span></span></li>
<li><span class="koboSpan" id="kobo.40.1">Improve performance without compromising resilience </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">and security</span></span></li>
<li><span class="koboSpan" id="kobo.42.1">Improve end-to-end observability between the Kubernetes API server, the KMS plugin, and the KMS with </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">auditing capabilities</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.44.1">These improvements are in sync with the challenges we have observed and mitigated through this handbook, improving and helping to maintain a Kubernetes cluster’s </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">security posture.</span></span></p>
<p><span class="koboSpan" id="kobo.46.1">At the time of writing, the latest release of Kubernetes is 1.28. </span><span class="koboSpan" id="kobo.46.2">It brings a set of improvements regarding the native Secrets management, as documented within </span><em class="italic"><span class="koboSpan" id="kobo.47.1">KEP-3299, </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.48.1">KMSv2 Improvements</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.49.1">:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.50.1">Here are </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">the changes:</span></span><ul><li><span class="koboSpan" id="kobo.52.1">Deprecation of the previous </span><strong class="source-inline"><span class="koboSpan" id="kobo.53.1">KMSv1</span></strong><span class="koboSpan" id="kobo.54.1"> feature in favor of </span><strong class="source-inline"><span class="koboSpan" id="kobo.55.1">KMSv2</span></strong><span class="koboSpan" id="kobo.56.1">; this change leads toward the GA of </span><strong class="source-inline"><span class="koboSpan" id="kobo.57.1">KMSv2</span></strong><span class="koboSpan" id="kobo.58.1">, which is scheduled in </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">version 1.29.</span></span></li><li><span class="koboSpan" id="kobo.60.1">Implementation of a new </span><strong class="bold"><span class="koboSpan" id="kobo.61.1">Data Encryption Key</span></strong><span class="koboSpan" id="kobo.62.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.63.1">DEK</span></strong><span class="koboSpan" id="kobo.64.1">) when enabling the </span><strong class="source-inline"><span class="koboSpan" id="kobo.65.1">KMSv2KDF</span></strong><span class="koboSpan" id="kobo.66.1"> feature gate or the</span><a id="_idIndexMarker876"/><span class="koboSpan" id="kobo.67.1"> generation of a new DEK per encryption. </span><span class="koboSpan" id="kobo.67.2">This change provides the operation team with an optional behavior that can be enabled to comply with regulations where the default </span><strong class="source-inline"><span class="koboSpan" id="kobo.68.1">KMSv2</span></strong><span class="koboSpan" id="kobo.69.1"> behavior of generating a single DEK at the Kubernetes API server startup time is </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">not acceptable.</span></span></li></ul></li>
</ul>
<p><span class="koboSpan" id="kobo.71.1">Here is the </span><a id="_idIndexMarker877"/><span class="koboSpan" id="kobo.72.1">KEP 3299 GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">link: </span></span><a href="https://github.com/kubernetes/enhancements/blob/master/keps/sig-auth/3299-kms-v2-improvements/README.md"><span class="No-Break"><span class="koboSpan" id="kobo.74.1">https://github.com/kubernetes/enhancements/blob/master/keps/sig-auth/3299-kms-v2-improvements/README.md</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.75.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.76.1">See the </span><em class="italic"><span class="koboSpan" id="kobo.77.1">Key value data</span></em><span class="koboSpan" id="kobo.78.1"> section in </span><a href="B20970_03.xhtml#_idTextAnchor064"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.79.1">Chapter 3</span></em></span></a><span class="koboSpan" id="kobo.80.1">, </span><em class="italic"><span class="koboSpan" id="kobo.81.1">Encrypting Secrets the Kubernetes-Native Way</span></em><span class="koboSpan" id="kobo.82.1">, for an overview of the technical evolution between the </span><strong class="source-inline"><span class="koboSpan" id="kobo.83.1">KMSv1</span></strong><span class="koboSpan" id="kobo.84.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.85.1">KMv2</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.86.1"> implementations.</span></span></p>
<p><span class="koboSpan" id="kobo.87.1">Note that </span><strong class="source-inline"><span class="koboSpan" id="kobo.88.1">KMSv2</span></strong><span class="koboSpan" id="kobo.89.1"> is still considered </span><em class="italic"><span class="koboSpan" id="kobo.90.1">beta</span></em><span class="koboSpan" id="kobo.91.1"> in version 1.28 of Kubernetes and is targeted for a GA status with version 1.29 (at the time </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">of writing).</span></span></p>
<h3><span class="koboSpan" id="kobo.93.1">The CSI Secrets Store</span></h3>
<p><span class="koboSpan" id="kobo.94.1">CSI Secrets</span><a id="_idIndexMarker878"/><span class="koboSpan" id="kobo.95.1"> Store could be considered an external solution to Kubernetes due to its dependency on an external vault service. </span><span class="koboSpan" id="kobo.95.2">However, the CSI Secrets </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">Store is:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.97.1">Based on the </span><strong class="bold"><span class="koboSpan" id="kobo.98.1">Container Storage Interface</span></strong><span class="koboSpan" id="kobo.99.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.100.1">CSI</span></strong><span class="koboSpan" id="kobo.101.1">) architecture</span><a id="_idIndexMarker879"/><span class="koboSpan" id="kobo.102.1"> which is a native </span><span class="No-Break"><span class="koboSpan" id="kobo.103.1">Kubernetes interface</span></span></li>
<li><span class="koboSpan" id="kobo.104.1">Carried over by a </span><a id="_idIndexMarker880"/><span class="koboSpan" id="kobo.105.1">Kubernetes project’s </span><strong class="bold"><span class="koboSpan" id="kobo.106.1">Special Interest </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.107.1">Group</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.108.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.109.1">SIG</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.111.1">Leveraging native Kubernetes API objects without the need for an agent, a sidecar container, or non-native </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">Kubernetes patterns</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.113.1">Here is the link to the </span><a id="_idIndexMarker881"/><span class="koboSpan" id="kobo.114.1">CSI Secrets Store </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">project: </span></span><a href="https://secrets-store-csi-driver.sigs.k8s.io/"><span class="No-Break"><span class="koboSpan" id="kobo.116.1">https://secrets-store-csi-driver.sigs.k8s.io/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.117.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.118.1">Not only this model can ease the injection of Secrets from an external vault into applications, but it can also synchronize Secrets as native Kubernetes Secret objects </span><span class="No-Break"><span class="koboSpan" id="kobo.119.1">if needed.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.120.1">Sync Secret capability</span></p>
<p class="callout"><span class="koboSpan" id="kobo.121.1">When using the Sync Secret feature, the CSI Secrets Store will synchronize external Secrets as native Kubernetes Secret objects which requires setting up an encryption of data at rest to ensure the sensitive data payloads from these objects </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">are encrypted.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.123.1">See the </span><em class="italic"><span class="koboSpan" id="kobo.124.1">Key value data</span></em><span class="koboSpan" id="kobo.125.1"> section from </span><a href="B20970_03.xhtml#_idTextAnchor064"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.126.1">Chapter 3</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.127.1">, Encrypting Secrets the Kubernetes-Native Way</span></em><span class="koboSpan" id="kobo.128.1">, for an overview of the </span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">different options.</span></span></p>
<p><span class="koboSpan" id="kobo.130.1">Like with Kubernetes’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.131.1">kms</span></strong><span class="koboSpan" id="kobo.132.1"> provider, the CSI Secrets Store</span><a id="_idIndexMarker882"/><span class="koboSpan" id="kobo.133.1"> is following the same minimal requirements to embrace a DevSecOps model, which includes </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.135.1">A native CSI model for the platform team to implement a simple connectivity towards external </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">vault services</span></span></li>
<li><span class="koboSpan" id="kobo.137.1">A self-service model via the native Kubernetes API objects for application teams to </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">consume Secrets</span></span></li>
<li><span class="koboSpan" id="kobo.139.1">Metrics, logging, and secret auto-rotation, to comply with security regulations </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">and frameworks</span></span></li>
<li><span class="koboSpan" id="kobo.141.1">Visibility from a roadmap perspective and the current implementation status, which is available </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">here: </span></span><a href="https://secrets-store-csi-driver.sigs.k8s.io/design-docs"><span class="No-Break"><span class="koboSpan" id="kobo.143.1">https://secrets-store-csi-driver.sigs.k8s.io/design-docs</span></span></a></li>
</ul>
<p><span class="koboSpan" id="kobo.144.1">The CSI Secrets Store project is an elegant and native solution that is getting more and more popular and even becoming fully integrated within enterprise Kubernetes distributions such the Red Hat OpenShift </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">version 4.14.</span></span></p>
<h2 id="_idParaDest-267"><a id="_idTextAnchor278"/><span class="koboSpan" id="kobo.146.1">External solutions</span></h2>
<p><span class="koboSpan" id="kobo.147.1">In the previous section, we looked at the Kubernetes project’s roadmaps for its native solutions since they are open source. </span><span class="koboSpan" id="kobo.147.2">However, that is something difficult to do here as not all the solutions are </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">open source.</span></span></p>
<p><span class="koboSpan" id="kobo.149.1">The external solutions that we have reviewed within this handbook are the most common ones as they lead their segment or are native to the </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">cloud providers.</span></span></p>
<p><span class="koboSpan" id="kobo.151.1">Like the Kubernetes projects, these ecosystem solutions are rapidly evolving to support more patterns and improve business continuity planning, but more importantly, improve the security posture for both the platform and applications running </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">on it.</span></span></p>
<p><span class="koboSpan" id="kobo.153.1">Due to the plethora of solutions, let’s zoom in on just one example at the time of writing. </span><span class="koboSpan" id="kobo.153.2">A recent addition from HashiCorp, called Vault Radar, provides scanners to identify Secrets being leaked or hard coded within the application code. </span><span class="koboSpan" id="kobo.153.3">Vault Radar offers remediation paths for security exposures and prioritizes these by ranking </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">by risks.</span></span></p>
<p><span class="koboSpan" id="kobo.155.1">When it comes to improving and maintaining a security posture and with the increased adoption of multi-cloud architecture, identifying such sprawl of sensitive information is critical to reducing </span><span class="No-Break"><span class="koboSpan" id="kobo.156.1">surface attacks.</span></span></p>
<h1 id="_idParaDest-268"><a id="_idTextAnchor279"/><span class="koboSpan" id="kobo.157.1">The future state of Kubernetes</span></h1>
<p><span class="koboSpan" id="kobo.158.1">When thinking </span><a id="_idIndexMarker883"/><span class="koboSpan" id="kobo.159.1">about the future state of a piece of software or a solution, there are </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">two considerations:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.161.1">The desires or needs that are linked to specific, future, and missing </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">use cases</span></span></li>
<li><span class="koboSpan" id="kobo.163.1">The existing roadmap, its relationship with the current architecture, and how to include </span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">future enhancements</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.165.1">As we’ve observed in this handbook, there is not one software to address all needs. </span><span class="koboSpan" id="kobo.165.2">It often involves combining multiple projects and composing a solution toward our end goal while managing Secrets for both the Kubernetes platform and applications running on it. </span><span class="koboSpan" id="kobo.165.3">As such, let’s have a solution-driven overview of what we would expect for </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">the future.</span></span></p>
<h2 id="_idParaDest-269"><a id="_idTextAnchor280"/><span class="koboSpan" id="kobo.167.1">Food for thought and enhancements</span></h2>
<p><span class="koboSpan" id="kobo.168.1">Starting with the native stack offered by the Kubernetes project, the proposed changes and roadmap are documented in KEP-3299. </span><span class="koboSpan" id="kobo.168.2">The same goes for the design documents from the SIG in charge of CSI </span><span class="No-Break"><span class="koboSpan" id="kobo.169.1">Secrets Store.</span></span></p>
<p><span class="koboSpan" id="kobo.170.1">Generally speaking, and with all respect to Kubernetes’ API-driven design, the following topics would be </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">greatly welcomed:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.172.1">Native encryption</span></strong><span class="koboSpan" id="kobo.173.1">: While Kubernetes provides encryption providers, the actual engines, such</span><a id="_idIndexMarker884"/><span class="koboSpan" id="kobo.174.1"> as </span><strong class="source-inline"><span class="koboSpan" id="kobo.175.1">aesgcm</span></strong><span class="koboSpan" id="kobo.176.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">aescbc</span></strong><span class="koboSpan" id="kobo.178.1">, come with a set of challenges that relatively </span><a id="_idIndexMarker885"/><span class="koboSpan" id="kobo.179.1">complexify the implementation, exposing their encryption </span><a id="_idIndexMarker886"/><span class="koboSpan" id="kobo.180.1">keys or the lack of a commercial version of a KMS plugin to provide enterprise support and services. </span><span class="koboSpan" id="kobo.180.2">This change could also help with not only encrypting the sensitive data payload stored in </span><strong class="source-inline"><span class="koboSpan" id="kobo.181.1">etcd</span></strong><span class="koboSpan" id="kobo.182.1"> but any other data payload from API objects. </span><span class="koboSpan" id="kobo.182.2">A deployment definition, as an example, can provide enough valuable information about the platform and applications to be exploited by </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">malicious attackers.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.184.1">Dynamic secret</span></strong><span class="koboSpan" id="kobo.185.1">: The ability </span><a id="_idIndexMarker887"/><span class="koboSpan" id="kobo.186.1">to update the secret based on specific scenarios, which is a requirement to comply with most, if not all, regulations and frameworks. </span><span class="koboSpan" id="kobo.186.2">Efforts on that matter are being considered within the </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">following initiatives:</span></span><ul><li><span class="koboSpan" id="kobo.188.1">KEP-3299 has priority in terms of automating the rotation of the encryption to reduce </span><span class="No-Break"><span class="koboSpan" id="kobo.189.1">potential attacks</span></span></li><li><span class="koboSpan" id="kobo.190.1">CSI Secrets Store triggers an update of the secret payload when the external source </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">is changing.</span></span></li><li><span class="koboSpan" id="kobo.192.1">While both previous points could observe and act on the life cycle of key or secret, auditing the actual usage and uniqueness of a secret payload would be greatly appreciated to reduce the sprawl of the same payload across multiple platforms and applications, thus leading to large-scale exposure when the related payload </span><span class="No-Break"><span class="koboSpan" id="kobo.193.1">is compromised</span></span></li></ul></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.194.1">Offload all API objects data to an external vault service</span></strong><span class="koboSpan" id="kobo.195.1">: Due to the relative burden on the operation teams to secure </span><strong class="source-inline"><span class="koboSpan" id="kobo.196.1">etcd</span></strong><span class="koboSpan" id="kobo.197.1"> so that it doesn’t have potential security exposures, what about replacing this data store with an external vault that leverages the Kubernetes KMS plugin provider? </span><span class="koboSpan" id="kobo.197.2">This would greatly ease the </span><a id="_idIndexMarker888"/><span class="koboSpan" id="kobo.198.1">burden in terms of knowledge, the cost in terms of time and knowledge, </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">and maintenance.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.200.1">Network-Bound Disk Encryption (NBDE) for etcd</span></strong><span class="koboSpan" id="kobo.201.1">: While offloading to an external vault service could lead to complex solutions to guarantee resilient access to the external vault service, a </span><a id="_idIndexMarker889"/><span class="koboSpan" id="kobo.202.1">similar approach to NBDE could help secure the </span><strong class="source-inline"><span class="koboSpan" id="kobo.203.1">etcd</span></strong><span class="koboSpan" id="kobo.204.1"> data store. </span><span class="koboSpan" id="kobo.204.2">The premise of such a solution is to have multiple service instances (at least three for obvious high-availability requirements) bound to a defined network segment and to hold a part of the encryption key within the boundaries of a defined network segment. </span><span class="koboSpan" id="kobo.204.3">Using such an encryption key service </span><a id="_idIndexMarker890"/><span class="koboSpan" id="kobo.205.1">model along with the </span><strong class="bold"><span class="koboSpan" id="kobo.206.1">Trusted Platform Module</span></strong><span class="koboSpan" id="kobo.207.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.208.1">TPM</span></strong><span class="koboSpan" id="kobo.209.1">) would enable Kubernetes encryption providers such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.210.1">aesgcm</span></strong><span class="koboSpan" id="kobo.211.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.212.1">aescbc</span></strong><span class="koboSpan" id="kobo.213.1"> to be safer than they are today with limited external services to </span><span class="No-Break"><span class="koboSpan" id="kobo.214.1">be deployed.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.215.1">Enrich the logging capabilities</span></strong><span class="koboSpan" id="kobo.216.1">: With </span><strong class="bold"><span class="koboSpan" id="kobo.217.1">security information and event management</span></strong><span class="koboSpan" id="kobo.218.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.219.1">SIEM</span></strong><span class="koboSpan" id="kobo.220.1">) systems, a </span><a id="_idIndexMarker891"/><span class="koboSpan" id="kobo.221.1">more detailed view of the security posture could be provided from a secret-related point of view. </span><span class="koboSpan" id="kobo.221.2">This is often a request from enterprise organizations that want to leverage the power of a centralized logging system to correlate events and quickly audit potentially impacted systems during a security incident response, especially considering the sprawl of objects </span><a id="_idIndexMarker892"/><span class="koboSpan" id="kobo.222.1">in multi-platform and </span><span class="No-Break"><span class="koboSpan" id="kobo.223.1">multi-cloud architecture.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.224.1">These are five examples that you could think of after reading this handbook and implementing the </span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">shared solutions.</span></span></p>
<h2 id="_idParaDest-270"><a id="_idTextAnchor281"/><span class="koboSpan" id="kobo.226.1">How to share your thoughts</span></h2>
<p><span class="koboSpan" id="kobo.227.1">We all have ideas to improve the usability and requirements to support the organization’s survival. </span><span class="koboSpan" id="kobo.227.2">Like the five previous examples, these might not be part of any request for enhancements, roadmap, or design documents from any software projects and </span><span class="No-Break"><span class="koboSpan" id="kobo.228.1">vendors yet.</span></span></p>
<p><span class="koboSpan" id="kobo.229.1">So, how can we influence the development? </span><span class="koboSpan" id="kobo.229.2">The general rule is to open an issue or a ticket to express your </span><span class="No-Break"><span class="koboSpan" id="kobo.230.1">enhancement request.</span></span></p>
<p><span class="koboSpan" id="kobo.231.1">For proprietary solutions, this would be translated by contacting the vendor and asking to open a ticket related to your enhancement, which might (or might not) find its way to the vendor’s engineering organization. </span><span class="koboSpan" id="kobo.231.2">At this stage, the evolution of such a request is about the same as following the activity of a </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">black hole.</span></span></p>
<p><span class="koboSpan" id="kobo.233.1">For open source projects, including Kubernetes, the process is much more open. </span><span class="koboSpan" id="kobo.233.2">First, it is recommended to discuss your thoughts with the appropriate SIG on Slack or at meetups. </span><span class="koboSpan" id="kobo.233.3">This will allow you to discover if a similar workstream is currently in progress to which you can contribute or if it is a good idea to introduce it to the Kubernetes project </span><span class="No-Break"><span class="koboSpan" id="kobo.234.1">development teams.</span></span></p>
<p><span class="koboSpan" id="kobo.235.1">At this stage, the</span><a id="_idIndexMarker893"/><span class="koboSpan" id="kobo.236.1"> next step is to create a new issue on the Kubernetes repository. </span><span class="koboSpan" id="kobo.236.2">Let’s look at GitHub issue #111532 concerning the default behavior of the </span><a id="_idIndexMarker894"/><span class="koboSpan" id="kobo.237.1">Kubernetes API server regarding the </span><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">EncryptionConfiguration</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.239.1">API object:</span></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.240.1">What would you like to </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.241.1">be added?</span></em></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.242.1">The current behavior of the EncryptionConfiguration API for the provider list is order-based, so the API server must be restarted for it to acknowledge a newly </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.243.1">defined order.</span></em></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.244.1">As an example, let’s consider moving from </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.245.1">this definition:</span></em></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.246.1">
apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
  - resources:
      - secrets
    providers:
      - identity: {}
      - kms:
          name: myKmsPlugin
          endpoint: unix:///tmp/myKmsPlugin.sock
          cachesize: 100</span></pre> <p><em class="italic"><span class="koboSpan" id="kobo.247.1">Moving to the following one will require the API server to </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.248.1">be restarted:</span></em></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.249.1">
---
apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
  - resources:
      - secrets
    providers:
      - kms:
          name: myKmsPlugin
          endpoint: unix:///tmp/myKmsPlugin.sock
          cachesize: 100
      - identity: {}</span></pre> <p><em class="italic"><span class="koboSpan" id="kobo.250.1">With proposal #111405, the necessary construct enables </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.251.1">this implementation.</span></em></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.252.1">Why is </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.253.1">this needed?</span></em></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.254.1">The current behavior is the source of disruption from a service perspective, requires a user with elevated privileges, and does not allow the KMS provider’s plugin capabilities to be leveraged within the context of the managed Kubernetes offering (no access to the control </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.255.1">plane nodes).</span></em></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.256.1">This change will improve the </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.257.1">following aspects:</span></em></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.258.1">Day 2 operations; move the EncryptionConfiguration API to a regular CRUD </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.259.1">API object</span></em></span></li>
<li><em class="italic"><span class="koboSpan" id="kobo.260.1">Resilience and service continuity by avoiding having to restart the </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.261.1">API server</span></em></span></li>
<li><em class="italic"><span class="koboSpan" id="kobo.262.1">The usage of the KMS provider plugin to manage </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.263.1">Kubernetes offerings</span></em></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.264.1">Note about GitHub issue #111532</span></p>
<p class="callout"><span class="koboSpan" id="kobo.265.1">This example is an as-is extract from this book’s GitHub repository without language fixing or </span><span class="No-Break"><span class="koboSpan" id="kobo.266.1">formatting applied.</span></span></p>
<p><span class="koboSpan" id="kobo.267.1">The template is</span><a id="_idIndexMarker895"/><span class="koboSpan" id="kobo.268.1"> simple – a clear explanation of the what and the why with clear example(s) and, if you can, the how with the code to illustrate </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">the change.</span></span></p>
<p><span class="koboSpan" id="kobo.270.1">The Kubernetes SIG authentication in charge of the KMSv2 implementation picked up GitHub issue #111532 and addressed the request for enhancement by implementing the code change from GitHub #111919. </span><span class="koboSpan" id="kobo.270.2">The outcome of this change is the configuration being reloaded without the need to restart the Kubernetes API server when the </span><strong class="source-inline"><span class="koboSpan" id="kobo.271.1">EncryptionConfiguration</span></strong><span class="koboSpan" id="kobo.272.1"> API object </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">is modified.</span></span></p>
<p><span class="koboSpan" id="kobo.274.1">The following</span><a id="_idIndexMarker896"/><span class="koboSpan" id="kobo.275.1"> links will provide you with direct access to the resources so that you can contribute to the </span><span class="No-Break"><span class="koboSpan" id="kobo.276.1">Kubernetes project:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.277.1">How to reach out to the Kubernetes </span><span class="No-Break"><span class="koboSpan" id="kobo.278.1">community: </span></span><a href="https://kubernetes.io/community/"><span class="No-Break"><span class="koboSpan" id="kobo.279.1">https://kubernetes.io/community/</span></span></a></li>
<li><span class="koboSpan" id="kobo.280.1">The Kubernetes GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.281.1">organization: </span></span><a href="https://github.com/kubernetes"><span class="No-Break"><span class="koboSpan" id="kobo.282.1">https://github.com/kubernetes</span></span></a></li>
<li><span class="koboSpan" id="kobo.283.1">The Kubernetes </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">SIGs: </span></span><a href="https://github.com/kubernetes-sigs"><span class="No-Break"><span class="koboSpan" id="kobo.285.1">https://github.com/kubernetes-sigs</span></span></a></li>
<li><span class="koboSpan" id="kobo.286.1">GitHub issue #111532 used as an </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">example: </span></span><a href="https://github.com/kubernetes/kubernetes/issues/111532#issue-1321971248"><span class="No-Break"><span class="koboSpan" id="kobo.288.1">https://github.com/kubernetes/kubernetes/issues/111532#issue-1321971248</span></span></a></li>
<li><span class="koboSpan" id="kobo.289.1">GitHub issue #111919 used to address enhancement #</span><span class="No-Break"><span class="koboSpan" id="kobo.290.1">111532: </span></span><a href="https://github.com/kubernetes/kubernetes/issues/111919"><span class="No-Break"><span class="koboSpan" id="kobo.291.1">https://github.com/kubernetes/kubernetes/issues/111919</span></span></a></li>
</ul>
<p><span class="koboSpan" id="kobo.292.1">While it might seem rather intimidating to introduce an issue for such a large project, the open source communities around Kubernetes have been building a safe space for anyone to share their ideas and experiences. </span><span class="koboSpan" id="kobo.292.2">Now, it is your turn </span><span class="No-Break"><span class="koboSpan" id="kobo.293.1">to contribute!</span></span></p>
<h1 id="_idParaDest-271"><a id="_idTextAnchor282"/><span class="koboSpan" id="kobo.294.1">Continuous improvement</span></h1>
<p><span class="koboSpan" id="kobo.295.1">This handbook took a continuous improvement approach</span><a id="_idIndexMarker897"/><span class="koboSpan" id="kobo.296.1"> by considering the DevSecOps best practices. </span><span class="koboSpan" id="kobo.296.2">When designing, architecting, implementing, and securing any platform or software, various principles should be considered. </span><span class="koboSpan" id="kobo.296.3">Let’s take </span><span class="No-Break"><span class="koboSpan" id="kobo.297.1">a look.</span></span></p>
<h2 id="_idParaDest-272"><a id="_idTextAnchor283"/><span class="koboSpan" id="kobo.298.1">Skill acquisition</span></h2>
<p><span class="koboSpan" id="kobo.299.1">Most security exposures are linked to a lack of knowledge or awareness. </span><span class="koboSpan" id="kobo.299.2">One of the DevSecOps principles is cross-team collaboration so that members can share their experiences and discoveries as they all share the same responsibilities to ensure secure systems for their end users </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">and customers.</span></span></p>
<p><span class="koboSpan" id="kobo.301.1">Participating in training, webinars, and meetups should be a priority for any organization to understand the importance of security and to improve its </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">security posture.</span></span></p>
<p><span class="koboSpan" id="kobo.303.1">Finally, contribute to open source projects by sharing experience, knowledge, code, and ideas that will contribute back to </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">your organization.</span></span></p>
<h2 id="_idParaDest-273"><a id="_idTextAnchor284"/><span class="koboSpan" id="kobo.305.1">Start early, fail fast, and iterate</span></h2>
<p><span class="koboSpan" id="kobo.306.1">Most organizations still tend to consider a waterfall approach when it comes to building infrastructure with </span><span class="No-Break"><span class="koboSpan" id="kobo.307.1">limited innovation.</span></span></p>
<p><span class="koboSpan" id="kobo.308.1">While this project methodology is more than valid for many domains, waiting until the last moment to implement a solution could lead to significant delays with suboptimal outcomes or worse, a </span><span class="No-Break"><span class="koboSpan" id="kobo.309.1">project failure.</span></span></p>
<p><span class="koboSpan" id="kobo.310.1">Another reason to consider adopting such a methodology is limited innovation for the last two decades in building new platforms. </span><span class="koboSpan" id="kobo.310.2">As a result, the adoption of Kubernetes is often done with the relics of legacy patterns, which has led to suboptimal implementation or additional burdens for both the application and </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">operation teams.</span></span></p>
<p><span class="koboSpan" id="kobo.312.1">A good practice for cloud-native platforms such as Kubernetes is to start the implementation early with all the stakeholders involved and learn alongside the project with continuous feedback on success, failures, and future improvements. </span><span class="koboSpan" id="kobo.312.2">This will lead to a hybrid project model that fits both the waterfall and agile project management styles so that it suits the enterprise’s needs for planning and </span><span class="No-Break"><span class="koboSpan" id="kobo.313.1">accelerated delivery.</span></span></p>
<h2 id="_idParaDest-274"><span class="koboSpan" id="kobo.314.1">Automation as a strateg</span><a id="_idTextAnchor285"/><span class="koboSpan" id="kobo.315.1">y and Everything as Code (EaC)</span></h2>
<p><span class="koboSpan" id="kobo.316.1">Most security </span><a id="_idIndexMarker898"/><span class="koboSpan" id="kobo.317.1">breaches are related to a lack of automation. </span><span class="koboSpan" id="kobo.317.2">When teams are working on security topics or incidents, they often perform the tasks on systems, document them in tickets, and the effort </span><span class="No-Break"><span class="koboSpan" id="kobo.318.1">stops there.</span></span></p>
<p><span class="koboSpan" id="kobo.319.1">As a best practice, every single action toward implementing a system should be codified, reviewed through a source revision system, and automated. </span><span class="koboSpan" id="kobo.319.2">This includes the activities of all teams as they are all responsible from a security standpoint for both existing procedures and future ones that are linked to incidents or newly </span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">discovered vulnerabilities.</span></span></p>
<p><span class="koboSpan" id="kobo.321.1">From there, constant drift detection needs to be in place to guarantee all systems are retrofitted with the latest </span><span class="No-Break"><span class="koboSpan" id="kobo.322.1">security remediations.</span></span></p>
<p><span class="koboSpan" id="kobo.323.1">A good practice is to </span><a id="_idIndexMarker899"/><span class="koboSpan" id="kobo.324.1">consider </span><strong class="bold"><span class="koboSpan" id="kobo.325.1">Everything as Code</span></strong><span class="koboSpan" id="kobo.326.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.327.1">EaC</span></strong><span class="koboSpan" id="kobo.328.1">) for automating your infrastructure, application, governance, compliance, and security. </span><span class="koboSpan" id="kobo.328.2">When doing so, the entire stack, from the hardware up to the application running in containers, along with the </span><a id="_idIndexMarker900"/><span class="koboSpan" id="kobo.329.1">business continuity plan, can be part of your </span><strong class="bold"><span class="koboSpan" id="kobo.330.1">continuous integration and continuous delivery</span></strong><span class="koboSpan" id="kobo.331.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.332.1">CI/CD</span></strong><span class="koboSpan" id="kobo.333.1">) pipelines. </span><span class="koboSpan" id="kobo.333.2">This approach will serve as the gatekeeper against deploying critical applications on </span><span class="No-Break"><span class="koboSpan" id="kobo.334.1">unsafe platforms.</span></span></p>
<h2 id="_idParaDest-275"><a id="_idTextAnchor286"/><span class="koboSpan" id="kobo.335.1">Threat modeling</span></h2>
<p><span class="koboSpan" id="kobo.336.1">Threat modeling</span><a id="_idIndexMarker901"/><span class="koboSpan" id="kobo.337.1"> identifies </span><a id="_idIndexMarker902"/><span class="koboSpan" id="kobo.338.1">potential security threats and vulnerabilities early on in the implementation and deployment of platforms and applications. </span><span class="koboSpan" id="kobo.338.2">The security team should be part of the core team of each domain to help discover what could go wrong and plan the </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">relevant mitigations.</span></span></p>
<p><span class="koboSpan" id="kobo.340.1">By leveraging a collaboration culture with the appropriate tooling, threat modeling helps to create a proactive security posture, thereby reducing and even preventing major security issues before they </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">become real.</span></span></p>
<h2 id="_idParaDest-276"><a id="_idTextAnchor287"/><span class="koboSpan" id="kobo.342.1">Incident response</span></h2>
<p><span class="koboSpan" id="kobo.343.1">While implementing all these </span><a id="_idIndexMarker903"/><span class="koboSpan" id="kobo.344.1">solutions as preventive measures, security incidents will occur or later happen. </span><span class="koboSpan" id="kobo.344.2">The DevSecOps practices include a response plan to simplify how security incidents are handled as soon as they are detected. </span><span class="koboSpan" id="kobo.344.3">The security team will train the organization by defining its roles, communication channels, and the required actions to contain and mitigate the </span><span class="No-Break"><span class="koboSpan" id="kobo.345.1">security exposure.</span></span></p>
<p><span class="koboSpan" id="kobo.346.1">The incident response should not just be a documented process but a regular exercise to be randomly triggered and can be gamified like a Locked Shield to upskill the teams when they’re experiencing </span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">a cyberattack.</span></span></p>
<p><span class="koboSpan" id="kobo.348.1">Here is a link illustrating an annual Lock Shield scenario at an international </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">level: </span></span><a href="https://ccdcoe.org/exercises/locked-shields/"><span class="No-Break"><span class="koboSpan" id="kobo.350.1">https://ccdcoe.org/exercises/locked-shields/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.351.1">.</span></span></p>
<h1 id="_idParaDest-277"><a id="_idTextAnchor288"/><span class="koboSpan" id="kobo.352.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.353.1">Congratulations – you’ve made it! </span><span class="koboSpan" id="kobo.353.2">You’ve read this handbook, which acts as a reference for any organization adopting Kubernetes and is concerned with the topic of Secrets management. </span><span class="koboSpan" id="kobo.353.3">Often considered under control from a legacy platform perspective, it is a completely different story when it comes to Kubernetes as the leading cloud-native </span><span class="No-Break"><span class="koboSpan" id="kobo.354.1">container platform.</span></span></p>
<p><span class="koboSpan" id="kobo.355.1">The handbook provides a comprehensive walkthrough with technical examples about how to address the challenges, respond to the questions of business continuity, and provide the necessary considerations about auditing and compliance. </span><span class="koboSpan" id="kobo.355.2">But all these will not make much sense if they’re considered as an endgame with a one-time implementation approach instead of adopting a </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">DevSecOps mindset.</span></span></p>
<p><span class="koboSpan" id="kobo.357.1">While most consider DevSecOps as a buzzword, it is a fundamental shift that organizations can embrace to rapidly learn and adopt new technologies. </span><span class="koboSpan" id="kobo.357.2">This method calls for cross-collaboration between all teams supporting an organization’s infrastructure. </span><span class="koboSpan" id="kobo.357.3">By fostering a culture of </span><em class="italic"><span class="koboSpan" id="kobo.358.1">sharing is caring</span></em><span class="koboSpan" id="kobo.359.1">, the tasks of automating the security policies, checks, and remediations will become an organic activity without the need to consider security as a bottleneck </span><span class="No-Break"><span class="koboSpan" id="kobo.360.1">to innovation.</span></span></p>
<p><span class="koboSpan" id="kobo.361.1">Adopting the culture, process, and technology shared in this handbook will allow organizations to deliver value faster to their customers in a more secure, reliable, and </span><span class="No-Break"><span class="koboSpan" id="kobo.362.1">compliant way.</span></span></p>
<p><span class="koboSpan" id="kobo.363.1">Technology is easy and should not be a substitute for organizational change. </span><span class="koboSpan" id="kobo.363.2">Hopefully, this book helped you with selecting the appropriate toolset to manage your Secrets and sparked your transformation journey of infusing a culture of DevSecOps and </span><span class="No-Break"><span class="koboSpan" id="kobo.364.1">continuous change.</span></span></p>
</div>
</body></html>
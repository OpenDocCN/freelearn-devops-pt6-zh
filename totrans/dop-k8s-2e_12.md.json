["```\n# az $subgroup1 [$subgroup2 ...] $commands [$parameters]\n```", "```\n# az group create --name devops --location centralus\n{\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops\",\n \"location\": \"centralus\",\n \"managedBy\": null,\n \"name\": \"devops\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\"\n },\n \"tags\": null\n}\n```", "```\n# az network vnet create --name devops-vnet --resource-group devops --subnet-name default --address-prefixes 10.0.0.0/8\n{\n \"newVNet\": {\n \"addressSpace\": {\n \"addressPrefixes\": [\n \"10.0.0.0/8\"\n ]\n },\n \"ddosProtectionPlan\": null,\n \"dhcpOptions\": {\n \"dnsServers\": []\n },\n \"enableDdosProtection\": false,\n \"enableVmProtection\": false,\n \"etag\": \"W/\\\"a93c56be-6eab-4391-8fca-25e11625c6e5\\\"\",\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/virtualNetworks/devops-vnet\",\n \"location\": \"centralus\",\n \"name\": \"devops-vnet\",\n \"provisioningState\": \"Succeeded\",\n \"resourceGroup\": \"devops\",\n \"resourceGuid\": \"f5b9de39-197c-440f-a43f-51964ee9e252\",\n \"subnets\": [\n {\n \"addressPrefix\": \"10.0.0.0/24\",\n \"addressPrefixes\": null,\n \"delegations\": [],\n \"etag\": \"W/\\\"a93c56be-6eab-4391-8fca-25e11625c6e5\\\"\",\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/virtualNetworks/devops-vnet/subnets/default\",\n \"interfaceEndpoints\": null,\n \"ipConfigurationProfiles\": null,\n \"ipConfigurations\": null,\n \"name\": \"default\",\n \"networkSecurityGroup\": null,\n \"provisioningState\": \"Succeeded\",\n \"purpose\": null,\n \"resourceGroup\": \"devops\",\n \"resourceNavigationLinks\": null,\n \"routeTable\": null,\n \"serviceAssociationLinks\": null,\n \"serviceEndpointPolicies\": null,\n \"serviceEndpoints\": null,\n \"type\": \"Microsoft.Network/virtualNetworks/subnets\"\n }\n ],\n \"tags\": {},\n \"type\": \"Microsoft.Network/virtualNetworks\",\n \"virtualNetworkPeerings\": []\n }\n}\n```", "```\n# az network nsg create --name test-nsg --resource-group devops --location centralus\n{\n \"NewNSG\": {\n \"defaultSecurityRules\": [\n {\n \"access\": \"Allow\",\n \"description\": \"Allow inbound traffic from all VMs in VNET\",\n \"destinationAddressPrefix\": \"VirtualNetwork\",\n \"name\": \"AllowVnetInBound\",\n \"priority\": 65000,\n \"sourceAddressPrefix\": \"VirtualNetwork\",\n ...\n \"type\": \"Microsoft.Network/networkSecurityGroups/defaultSecurityRules\"\n },\n {\n \"access\": \"Allow\",\n \"description\": \"Allow inbound traffic from azure load balancer\",\n \"destinationAddressPrefix\": \"*\",\n \"name\": \"AllowAzureLoadBalancerInBound\",\n \"priority\": 65001,\n \"sourceAddressPrefix\": \"AzureLoadBalancer\",\n ...\n \"type\": \"Microsoft.Network/networkSecurityGroups/defaultSecurityRules\"\n },\n {\n \"access\": \"Deny\",\n \"description\": \"Deny all inbound traffic\",\n \"destinationAddressPrefix\": \"*\",\n \"name\": \"DenyAllInBound\",\n \"priority\": 65500,\n \"sourceAddressPrefix\": \"*\",\n ...\n \"type\": \"Microsoft.Network/networkSecurityGroups/defaultSecurityRules\"\n },\n {\n \"access\": \"Allow\",\n \"description\": \"Allow outbound traffic from all VMs to all VMs in VNET\",\n \"destinationAddressPrefix\": \"VirtualNetwork\",\n \"name\": \"AllowVnetOutBound\",\n \"priority\": 65000,\n \"sourceAddressPrefix\": \"VirtualNetwork\",\n ...\n \"type\": \"Microsoft.Network/networkSecurityGroups/defaultSecurityRules\"\n },\n {\n \"access\": \"Allow\",\n \"description\": \"Allow outbound traffic from all VMs to Internet\",\n \"destinationAddressPrefix\": \"Internet\",\n \"name\": \"AllowInternetOutBound\",\n \"priority\": 65001,\n \"sourceAddressPrefix\": \"*\",\n ...\n \"type\": \"Microsoft.Network/networkSecurityGroups/defaultSecurityRules\"\n },\n {\n \"access\": \"Deny\",\n \"description\": \"Deny all outbound traffic\",\n \"destinationAddressPrefix\": \"*\",\n \"name\": \"DenyAllOutBound\",\n \"priority\": 65500,\n \"sourceAddressPrefix\": \"*\",\n ...\n \"type\": \"Microsoft.Network/networkSecurityGroups/defaultSecurityRules\"\n }\n ],\n \"id\": \"...test-nsg\",\n \"location\": \"centralus\",\n \"name\": \"test-nsg\",\n \"networkInterfaces\": null,\n \"provisioningState\": \"Succeeded\",\n \"resourceGroup\": \"devops\",\n \"resourceGuid\": \"9e0e3d0f-e99f-407d-96a6-8e96cf99ecfc\",\n \"securityRules\": [],\n \"subnets\": null,\n \"tags\": null,\n \"type\": \"Microsoft.Network/networkSecurityGroups\"\n }\n}\n```", "```\n# az network nsg rule create --name test-nsg --priority 100 --resource-group devops --nsg-name test-nsg\n{\n \"access\": \"Allow\",\n \"description\": null,\n \"destinationAddressPrefix\": \"*\",\n \"destinationAddressPrefixes\": [],\n \"destinationApplicationSecurityGroups\": null,\n \"destinationPortRange\": \"80\",\n \"destinationPortRanges\": [],\n \"direction\": \"Inbound\",\n \"etag\": \"W/\\\"65e33e31-ec3c-4eea-8262-1cf5eed371b1\\\"\",\n \"id\": \"/subscriptions/.../resourceGroups/devops/providers/Microsoft.Network/networkSecurityGroups/test-nsg/securityRules/test-nsg\",\n \"name\": \"test-nsg\",\n \"priority\": 100,\n \"protocol\": \"*\",\n \"provisioningState\": \"Succeeded\",\n \"resourceGroup\": \"devops\",\n \"sourceAddressPrefix\": \"*\",\n \"sourceAddressPrefixes\": [],\n \"sourceApplicationSecurityGroups\": null,\n \"sourcePortRange\": \"*\",\n \"sourcePortRanges\": [],\n \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\n}\n```", "```\n# az network vnet subnet list --vnet-name devops-vnet --resource-group devops\n[\n {\n \"addressPrefix\": \"10.0.0.0/24\",\n \"addressPrefixes\": null,\n \"delegations\": [],\n \"etag\": \"W/\\\"a93c56be-6eab-4391-8fca-25e11625c6e5\\\"\",\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/virtualNetworks/devops-vnet/subnets/default\",\n \"interfaceEndpoints\": null,\n \"ipConfigurationProfiles\": null,\n \"ipConfigurations\": null,\n \"name\": \"default\",\n \"networkSecurityGroup\": null,\n \"provisioningState\": \"Succeeded\",\n \"purpose\": null,\n \"resourceGroup\": \"devops\",\n \"resourceNavigationLinks\": null,\n \"routeTable\": null,\n \"serviceAssociationLinks\": null,\n \"serviceEndpointPolicies\": null,\n \"serviceEndpoints\": null,\n \"type\": \"Microsoft.Network/virtualNetworks/subnets\"\n }\n]\n```", "```\n# az network vnet subnet create --address-prefixes 10.0.1.0/24 --name test --vnet-name devops-vnet --resource-group devops\n{\n \"addressPrefix\": \"10.0.1.0/24\",\n \"addressPrefixes\": null,\n \"delegations\": [],\n \"etag\": \"W/\\\"9f7e284f-fd31-4bd3-ad09-f7dc75bb7c68\\\"\",\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/virtualNetworks/devops-vnet/subnets/test\",\n \"interfaceEndpoints\": null,\n \"ipConfigurationProfiles\": null,\n \"ipConfigurations\": null,\n \"name\": \"test\",\n \"networkSecurityGroup\": null,\n \"provisioningState\": \"Succeeded\",\n \"purpose\": null,\n \"resourceGroup\": \"devops\",\n \"resourceNavigationLinks\": null,\n \"routeTable\": null,\n \"serviceAssociationLinks\": null,\n \"serviceEndpointPolicies\": null,\n \"serviceEndpoints\": null,\n \"type\": \"Microsoft.Network/virtualNetworks/subnets\"\n}\n```", "```\n# az network vnet subnet list --vnet-name devops-vnet --resource-group devops | jq .[].name\n\"default\"\n\"test\"\n```", "```\n# az vm image list --output table\nYou are viewing an offline list of images, use --all to retrieve an up-to-date list\nOffer Publisher Sku Urn UrnAlias Version\n------------- ---------------------- ------------------ -----------------------------------------\nCentOS OpenLogic 7.5 OpenLogic:CentOS:7.5:latest CentOS latest\nCoreOS CoreOS Stable CoreOS:CoreOS:Stable:latest CoreOS latest\nDebian credativ 8 credativ:Debian:8:latest Debian latest\nopenSUSE-Leap SUSE 42.3 SUSE:openSUSE-Leap:42.3:latest openSUSE-Leap latest\nRHEL RedHat 7-RAW RedHat:RHEL:7-RAW:latest RHEL latest\nSLES SUSE 12-SP2 SUSE:SLES:12-SP2:latest SLES latest\nUbuntuServer Canonical 16.04-LTS Canonical:UbuntuServer:16.04-LTS:latest UbuntuLTS latest\nWindowsServer MicrosoftWindowsServer 2019-Datacenter MicrosoftWindowsServer:WindowsServer:2019-Datacenter:latest Win2019Datacenter latest\nWindowsServer MicrosoftWindowsServer 2016-Datacenter MicrosoftWindowsServer:WindowsServer:2016-Datacenter:latest Win2016Datacenter latest\nWindowsServer MicrosoftWindowsServer 2012-R2-Datacenter MicrosoftWindowsServer:WindowsServer:2012-R2-Datacenter:latest Win2012R2Datacenter latest\nWindowsServer MicrosoftWindowsServer 2012-Datacenter MicrosoftWindowsServer:WindowsServer:2012-Datacenter:latest Win2012Datacenter latest\nWindowsServer MicrosoftWindowsServer 2008-R2-SP1 MicrosoftWindowsServer:WindowsServer:2008-R2-SP1:latest Win2008R2SP1 latest\n```", "```\n# az vm create --resource-group devops --name newVM --image CentOS --admin-username centos-user --generate-ssh-keys\nSSH key files '/home/chloe/.ssh/id_rsa' and '/home/chloe/.ssh/id_rsa.pub' have been generated under ~/.ssh to allow SSH access to the VM. If using machines without permanent storage, back up your keys to a safelocation.\n - Running ..\n{\n \"fqdns\": \"\",\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Compute/virtualMachines/newVM\",\n \"location\": \"centralus\",\n \"macAddress\": \"00-0D-3A-96-6B-A2\",\n \"powerState\": \"VM running\",\n \"privateIpAddress\": \"10.0.0.4\",\n \"publicIpAddress\": \"40.77.97.79\",\n \"resourceGroup\": \"devops\",\n \"zones\": \"\"\n}\n```", "```\n# ssh centos-user@40.77.97.79\nThe authenticity of host '40.77.97.79 (40.77.97.79)' can't be established.\nECDSA key fingerprint is SHA256:LAvnQH94bY7NaIoNgDLM5iMHT1LMRseFwu2HPqicTuo.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '40.77.97.79' (ECDSA) to the list of known hosts.\n[centos-user@newVM ~]$\n```", "```\n# az vm get-instance-view --name newVM --resource-group devops\n{\n ...\n \"networkProfile\": {\n \"networkInterfaces\": [\n {\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/networkInterfaces/newVMVMNic\",\n \"primary\": null,\n \"resourceGroup\": \"devops\"\n }\n ]\n },\n ...\n}\n```", "```\n# az network nic show --ids /subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/networkInterfaces/newVMVMNic | jq .networkSecurityGroup\n{\n \"defaultSecurityRules\": null,\n \"etag\": null,\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/networkSecurityGroups/newVMNSG\",\n \"location\": null,\n \"name\": null,\n \"networkInterfaces\": null,\n \"provisioningState\": null,\n \"resourceGroup\": \"devops\",\n \"resourceGuid\": null,\n \"securityRules\": null,\n \"subnets\": null,\n \"tags\": null,\n \"type\": null\n}\n\n```", "```\n# az network nsg rule list --resource-group devops --nsg-name newVMNSG\n[\n {\n \"access\": \"Allow\",\n \"description\": null,\n \"destinationAddressPrefix\": \"*\",\n \"destinationAddressPrefixes\": [],\n \"destinationApplicationSecurityGroups\": null,\n \"destinationPortRange\": \"22\",\n \"destinationPortRanges\": [],\n \"direction\": \"Inbound\",\n \"etag\": \"W/\\\"9ab6b2d7-c915-4abd-9c02-a65049a62f02\\\"\",\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/networkSecurityGroups/newVMNSG/securityRules/default-allow-ssh\",\n \"name\": \"default-allow-ssh\",\n \"priority\": 1000,\n \"protocol\": \"Tcp\",\n \"provisioningState\": \"Succeeded\",\n \"resourceGroup\": \"devops\",\n \"sourceAddressPrefix\": \"*\",\n \"sourceAddressPrefixes\": [],\n \"sourceApplicationSecurityGroups\": null,\n \"sourcePortRange\": \"*\",\n \"sourcePortRanges\": [],\n \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\n }\n]\n```", "```\n# az network nsg rule delete --ids \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/networkSecurityGroups/newVMNSG/securityRules/default-allow-ssh\"\n```", "```\n# ssh centos-user@40.77.97.79\n...\n```", "```\n// create an AKS cluster with two nodes\n# az aks create --resource-group devops --name myAKS --node-count 2 --enable-addons monitoring,http_application_routing --generate-ssh-keys\nRunning...\n# az aks list --resource-group devops\n[\n {  \n  \"aadProfile\":null,\n  \"addonProfiles\":{  \n    \"httpApplicationRouting\":{  \n      \"config\":{  \n        \"HTTPApplicationRoutingZoneName\":\"cef42743fd964970b357.centralus.aksapp.io\"\n      },\n      \"enabled\":true\n    },\n    \"omsagent\":{  \n      \"config\":{  \n        \"logAnalyticsWorkspaceResourceID\":...\n      },\n      \"enabled\":true\n    }\n  },\n  \"agentPoolProfiles\":[  \n    {  \n      \"count\":2,\n      \"maxPods\":110,\n      \"name\":\"nodepool1\",\n      \"osDiskSizeGb\":30,\n      \"osType\":\"Linux\",\n      \"storageProfile\":\"ManagedDisks\",\n      \"vmSize\":\"Standard_DS2_v2\"\n    }\n  ],\n  \"dnsPrefix\":\"myAKS-devops-f82579\",\n  \"enableRbac\":true,\n  \"fqdn\":\"myaks-devops-f82579-077667ba.hcp.centralus.azmk8s.io\",\n  \"id\":\"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourcegroups/devops/providers/Microsoft.ContainerService/managedClusters/myAKS\",\n  \"kubernetesVersion\":\"1.9.11\",\n  \"linuxProfile\":{  \n    \"adminUsername\":\"azureuser\",\n    \"ssh\":{  \n      \"publicKeys\":[  \n        {  \n          \"keyData\":\"ssh-rsa xxx\"\n        }\n      ]\n    }\n  },\n  \"location\":\"centralus\",\n  \"name\":\"myAKS\",\n  \"networkProfile\":{  \n    \"dnsServiceIp\":\"10.0.0.10\",\n    \"dockerBridgeCidr\":\"172.17.0.1/16\",\n    \"networkPlugin\":\"kubenet\",\n    \"networkPolicy\":null,\n    \"podCidr\":\"10.244.0.0/16\",\n    \"serviceCidr\":\"10.0.0.0/16\"\n  },\n  \"nodeResourceGroup\":\"MC_devops_myAKS_centralus\",\n  \"provisioningState\":\"Succeeded\",\n  \"resourceGroup\":\"devops\",\n  \"servicePrincipalProfile\":{  \n    \"clientId\":\"db016e5d-b3e5-4e22-a844-1dad5d16fec1\"\n  },\n  \"type\":\"Microsoft.ContainerService/ManagedClusters\"\n}\n]\n```", "```\n// configure local kubeconfig to access the cluster\n# az aks get-credentials --resource-group devops --name myAKS\nMerged \"myAKS\" as current context in /home/chloe/.kube/config\n\n// check current context\n# kubectl config current-context\nmyAKS\n```", "```\n# kubectl get nodes\nNAME STATUS ROLES AGE VERSION\naks-nodepool1-37748545-0 Ready agent 12m v1.9.11\naks-nodepool1-37748545-1 Ready agent 12m v1.9.11\n```", "```\n# kubectl create -f chapter3/3-2-3_Service/3-2-3_rs1.yaml\nreplicaset.apps/nginx-1.12 created\n```", "```\nkind: Service\napiVersion: v1\nmetadata:\n name: nginx-service\nspec:\n selector:\n project: chapter3\n service: web\n type: LoadBalancer\n ports:\n - protocol: TCP\n port: 80\n targetPort: 80\n name: http\n```", "```\n// watch the external ip from <pending> to IP\n# kubectl get svc --watch\nNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE\nkubernetes ClusterIP 10.0.0.1 <none> 443/TCP 6h\nnginx-service LoadBalancer 10.0.139.13 40.122.78.184 80:31011/TCP 1m\n```", "```\n# az network vnet subnet list --vnet-name devops-vnet --resource-group devops | jq .[].id\n\"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/virtualNetworks/devops-vnet/subnets/default\"\n\"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/virtualNetworks/devops-vnet/subnets/test\"\n```", "```\n# az aks create --resource-group devops --name myAdvAKS --network-plugin azure --vnet-subnet-id /subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourceGroups/devops/providers/Microsoft.Network/virtualNetworks/devops-vnet/subnets/default --service-cidr 10.2.0.0/24 --node-count 1 --enable-addons monitoring,http_application_routing --generate-ssh-keys\n - Running ..\n{\n \"aadProfile\": null,\n \"addonProfiles\": {\n \"httpApplicationRouting\": {\n \"config\": {\n \"HTTPApplicationRoutingZoneName\": \"cef42743fd964970b357.centralus.aksapp.io\"\n },\n \"enabled\": true\n },\n \"omsagent\": {\n \"config\": {\n \"logAnalyticsWorkspaceResourceID\":\n },\n \"enabled\": true\n }\n },\n \"agentPoolProfiles\": [\n {\n \"count\": 1,\n \"maxPods\": 30,\n \"name\": \"nodepool1\",\n...\n \"vmSize\": \"Standard_DS2_v2\"\n }\n ],\n \"dnsPrefix\": \"myAdvAKS-devops-f82579\",\n \"enableRbac\": true,\n \"fqdn\": \"myadveks-devops-f82579-059d5b24.hcp.centralus.azmk8s.io\",\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourcegroups/devops/providers/Microsoft.ContainerService/managedClusters/myAdvAKS\",\n \"kubernetesVersion\": \"1.9.11\",\n \"linuxProfile\": {\n \"adminUsername\": \"azureuser\",\n \"ssh\": {\n \"publicKeys\": [\n ...\n ]\n }\n },\n \"location\": \"centralus\",\n \"name\": \"myAdvAKS\",\n \"networkProfile\": {\n \"dnsServiceIp\": \"10.0.0.10\",\n \"dockerBridgeCidr\": \"172.17.0.1/16\",\n \"networkPlugin\": \"azure\",\n \"networkPolicy\": null,\n \"podCidr\": null,\n \"serviceCidr\": \"10.2.0.0/24\"\n },\n \"nodeResourceGroup\": \"MC_devops_myAdvAKS_centralus\",\n \"provisioningState\": \"Succeeded\",\n \"resourceGroup\": \"devops\",\n \"servicePrincipalProfile\": {\n \"clientId\": \"db016e5d-b3e5-4e22-a844-1dad5d16fec1\",\n \"secret\": null\n },\n \"tags\": null,\n \"type\": \"Microsoft.ContainerService/ManagedClusters\"\n}\n```", "```\n# az aks get-credentials --resource-group devops --name myAdvAKS\nMerged \"myAdvAKS\" as current context in /home/chloe/.kube/config\n```", "```\n# az aks show --resource-group devops --name myAKS | jq .kubernetesVersion\n\"1.9.11\"\n```", "```\n# az aks get-upgrades --name myAKS --resource-group devops\n{\n \"agentPoolProfiles\": [\n {\n \"kubernetesVersion\": \"1.9.11\",\n \"name\": null,\n \"osType\": \"Linux\",\n \"upgrades\": [\n \"1.10.8\",\n \"1.10.9\"\n ]\n }\n ],\n \"controlPlaneProfile\": {\n \"kubernetesVersion\": \"1.9.11\",\n \"name\": null,\n \"osType\": \"Linux\",\n \"upgrades\": [\n \"1.10.8\",\n \"1.10.9\"\n ]\n },\n \"id\": \"/subscriptions/f825790b-ac24-47a3-89b8-9b4b3974f0d5/resourcegroups/devops/providers/Microsoft.ContainerService/managedClusters/myAKS/upgradeprofiles/default\",\n \"name\": \"default\",\n \"resourceGroup\": \"devops\",\n \"type\": \"Microsoft.ContainerService/managedClusters/upgradeprofiles\"\n}\n```", "```\n# az aks upgrade --name myAKS --resource-group devops --kubernetes-version 1.10.9\n```", "```\n# az aks show --resource-group devops --name myAKS --output table\nName Location ResourceGroup KubernetesVersion ProvisioningState Fqdn\n------ ---------- --------------- ------------------- ------------------- ----------------------------------------------------\nmyAKS centralus devops 1.10.9 Succeeded myaks-devops-f82579-077667ba.hcp.centralus.azmk8s.io\n```", "```\n# kubectl get nodes\nNAME STATUS ROLES AGE VERSION\naks-nodepool1-37748545-2 Ready agent 6m v1.10.9\naks-nodepool1-37748545-3 Ready agent 6m v1.10.9\n```", "```\n# az aks create --resource-group devops --name myADAKS --generate-ssh-keys --aad-server-app-id c7d828e7-bca0-4771-8f9d-50b9e1ea0afc --aad-server-app-secret 'A/IqLPieuCqJzL9vPEI5IqCn0IaEyn5Zq/lgfovNn9g=' --aad-client-app-id b4309673-464e-4c95-adf9-afeb27cc8d4c --aad-tenant-id d41d3fd1-f004-45cf-a77b-09a532556331 --node-count 1 --enable-addons monitoring,http_application_routing --generate-ssh-keys\n```", "```\n// login as admin first to get the access to create the bindings\n# az aks get-credentials --resource-group devops --name myADAKS --admin\n\n// list cluster roles\n# kubectl get clusterrole\nNAME AGE\nadmin 2h\ncluster-admin 2h\n...\n```", "```\n# cat 12-3_user-clusterrolebinding.yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n name: azure-user-cluster-admins\nroleRef:\n apiGroup: rbac.authorization.k8s.io\n kind: ClusterRole\n name: cluster-admin\nsubjects:\n- apiGroup: rbac.authorization.k8s.io\n kind: User\n name: \"8698dcf8-4d97-43be-aacd-eca1fc1495b6\"\n\n# kubectl create -f 12-3_user-clusterrolebinding.yaml\nclusterrolebinding.rbac.authorization.k8s.io/azure-user-cluster-admins created\n```", "```\n// (optional) clean up kubeconfig if needed.\n# rm -f ~/.kube/config\n\n// setup kubeconfig with non-admin\n# az aks get-credentials --resource-group devops --name myADAKS \n\n// try get the nodes\n# kubectl get nodes\nTo sign in, use a web browser to open the page https://microsoft.com/devicelogin and enter the code A6798XUFB to authenticate.\n```", "```\n# kubectl get nodes\nTo sign in, use a web browser to open the page https://microsoft.com/devicelogin and enter the code A6798XUFB to authenticate.\nNAME STATUS ROLES AGE VERSION\naks-nodepool1-42766340-0 Ready agent 26m v1.9.11\n```", "```\n- apiGroup: rbac.authorization.k8s.io\n kind: Group\n name: \"$group_object_id\"\n```", "```\n# kubectl get storageclass\nNAME PROVISIONER AGE\ndefault (default) kubernetes.io/azure-disk 4h\nmanaged-premium kubernetes.io/azure-disk 11h\n```", "```\n# kubectl describe storageclass default\nName: default\nIsDefaultClass: Yes\nAnnotations: ...\n,storageclass.beta.kubernetes.io/is-default-class=true\nProvisioner: kubernetes.io/azure-disk\nParameters: cachingmode=None,kind=Managed,storageaccounttype=Standard_LRS\nAllowVolumeExpansion: <unset>\nMountOptions: <none>\nReclaimPolicy: Delete\nVolumeBindingMode: Immediate\nEvents: <none>\n\n# kubectl describe storageclass managed-premium\nName: managed-premium\nIsDefaultClass: No\nAnnotations: ...\nProvisioner: kubernetes.io/azure-disk\nParameters: kind=Managed,storageaccounttype=Premium_LRS\nAllowVolumeExpansion: <unset>\nMountOptions: <none>\nReclaimPolicy: Delete\nVolumeBindingMode: Immediate\nEvents: <none>\n```", "```\n// create storage class with Premium and Standard ZRS\n# cat chapter12/storageclass.yaml\nkind: StorageClass\napiVersion: storage.k8s.io/v1\nmetadata:\n name: fastzrs\nprovisioner: kubernetes.io/azure-disk\nparameters:\n skuName: Premium_ZRS\n location: centralus\n\n---\n\nkind: StorageClass\napiVersion: storage.k8s.io/v1\nmetadata:\n name: slowzrs\nprovisioner: kubernetes.io/azure-disk\nparameters:\n skuName: Standard_ZRS\n location: centralus\n\n// create the storage class\n# kubectl create -f chapter12/storageclass.yaml\nstorageclass.storage.k8s.io/fastzrs created\nstorageclass.storage.k8s.io/slowzrs created\n```", "```\n// we could find a set of resources starting with the name addon-http-application-routing-...\n# kubectl get pod -n kube-system\nNAME READY STATUS RESTARTS AGE\naddon-http-application-routing-default-http-backend-6584cdnpq69 1/1 Running 0 3h\naddon-http-application-routing-external-dns-7dc8d9f794-4t28c 1/1 Running 0 3h\naddon-http-application-routing-nginx-ingress-controller-78zs45d 1/1 Running 0 3h\n...\n```", "```\n// search the routing zone name.\n# az aks show --resource-group devops --name myADAKS --query addonProfiles.httpApplicationRouting.config.HTTPApplicationRoutingZoneName\n\"46de1b27375a4f7ebf30.centralus.aksapp.io\"\n```"]
["```\n$ kubectl create sa getmetrics\n$ kubectl create clusterrole get-metrics --non-resource-url=/metrics --verb=get\n$ kubectl create clusterrolebinding get-metrics --clusterrole=get-metrics --serviceaccount=default:getmetrics\n$ export TOKEN=$(kubectl create token getmetrics -n default)\n$ curl -v --insecure -H \"Authorization: Bearer $TOKEN\" https://0.0.0.0:6443/metrics\n# HELP aggregator_discovery_aggregation_count_total [ALPHA] Counter of number of times discovery was aggregated\n.\n.\n. \n```", "```\n$ cd chapter15/simple\n$ ./deploy-prometheus-charts.sh \n```", "```\n# HELP kube_pod_deletion_timestamp Unix deletion timestamp\n# TYPE kube_pod_deletion_timestamp gauge\n# HELP kube_pod_info [STABLE] Information about pod.\n# TYPE kube_pod_info gauge\nkube_pod_info{namespace=\"calico-system\",pod=\"calico-typha-699dc7b758-bgr5f\",uid=\"33ec61b1-bb56-4a4c-853c-6a0ee56023c2\",host_ip=\"172.18.0.2\",pod_ip=\"172.18.0.2\",node=\"cluster01-worker\",created_by_kind=\"ReplicaSet\",created_by_name=\"calico-typha-699dc7b758\",priority_class=\"system-cluster-critical\",host_network=\"true\"} 1 \n```", "```\nmetric_name{annotation1=\"value1\",annotation2=\"value2\"} value \n```", "```\n$ kubectl apply -f chapter15/alertmanager-webhook/alertmanager-webhook.yaml \n```", "```\napiVersion: monitoring.coreos.com/v1alpha1\nkind: AlertmanagerConfig\nmetadata:\n  name: critical-alerts\n  namespace: kube-system\n  labels:\n    alertmanagerConfig: critical\nspec:\n  receivers:\n    - name: nginx-webhook\n      webhookConfigs:\n        - sendResolved: true\n          url: http://nginx-alerts.alert-manager-webhook.svc/webhook\n  route:\n    repeatInterval: 30s\n    receiver: 'nginx-webhook'\n    matchers:\n    - name: severity\n      matchType: \"=\"\n      value: critical\n    groupBy: ['namespace']\n    groupWait: 30s\n    groupInterval: 5m \n```", "```\n0.240.189.139 - - [12/Jan/2024:22:15:22 +0000] \"POST /webhook HTTP/1.1\" body:\"{\\x22receiver\\x22:\\x22kube-system/critical-alerts/nginx-we… \" 200 2 \"-\" \"Alertmanager/0.26.0\" \"-\" \n```", "```\n$ cd chapter15/user-auth\n$ ./deploy_openunison_imp_impersonation.sh \n```", "```\n---\napiVersion: monitoring.coreos.com/v1\nkind: PrometheusRule\nmetadata:\n  creationTimestamp: null\n  labels:\n    release: prometheus\n  name: openunison-has-activesessions\nspec:\n  groups:\n  - name: openunison.rules\n    rules:\n    - alert: no-sessions\n      annotations:\n        description: Fires when there are no OpenUnison sessions\n      expr: absent(active_sessions)\n      for: 1m\n      labels:\n        severity: openunison-critical\n        source: openunison \n```", "```\n$ kubectl delete application metrics -n openunison \n```", "```\n$ helm upgrade orchestra-login-portal tremolo/orchestra-login-portal -n openunison -f /tmp/openunison-values.yaml \n```", "```\n    apiVersion: v1\n    kind: ConfigMap\n    metadata:\n      labels:\n        grafana_dashboard: \"1\"\n      name: openunison-activesessions-dashboard-configmap\n      namespace: monitoring\n    data:\n      openunison-activesessions-dashboard.json: |-\n        {\n          \"annotations\": {\n    . \n    ```", "```\n$ cd chapter15/user-auth\n$ ./deploy_openunison_imp_impersonation.sh \n```", "```\n---\napiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  labels:\n    release: prometheus\n  name: orchestra\n  namespace: monitoring\nspec:\n  endpoints:\n  - bearerTokenFile: /var/run/secrets/kubernetes.io/serviceaccount/token\n    interval: 30s\n    port: openunison-secure-orchestra\n    scheme: https\n    targetPort: 8443\n    tlsConfig:\n      insecureSkipVerify: true\n  namespaceSelector:\n    matchNames:\n    - openunison\n  selector:\n    matchLabels:\n      app: openunison-orchestra \n```", "```\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: monitoring-list-services\n  namespace: openunison\nrules:\n- apiGroups:\n  - \"\"\n  resources:\n  - endpoints\n  - pods\n  - services\n  verbs:\n  - get\n  - list\n  - watch\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: monitoring-list-services\n  namespace: openunison\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: monitoring-list-services\nsubjects:\n- kind: ServiceAccount\n  name: prometheus-kube-prometheus-prometheus\n  namespace: openunison \n```", "```\n[2024-01-16 03:18:22,254][XNIO-1 task-4] INFO  AccessLog - [AuSuccess] - metrics - https://10.240.189.139:8443/metrics - username=system:serviceaccount:monitoring:prometheus-kube-prometheus-prometheus,ou=oauth2,o=Tremolo - 20 / oauth2k8s [10.240.189.165] - [f763bbd1a1c474929d91bfe89a2fd8e5f5b49a1d5]\n[2024-01-16 03:18:22,254][XNIO-1 task-4] INFO  AccessLog - [AzSuccess] - metrics - https://10.240.189.139:8443/metrics - username=system:serviceaccount:monitoring:prometheus-kube-prometheus-prometheus,ou=oauth2,o=Tremolo - NONE [10.240.189.165] - [f763bbd1a1c474929d91bfe89a2fd8e5f5b49a1d5] \n```", "```\nkubectl logs mypod -n myns \n```", "```\n$ cd chapter2\n$ kind delete cluster -n cluster01\n$ ./create-cluster.sh\n.\n.\n.\n$ cd ../chapter15/simple\n$ ./deploy-prometheus-charts.sh\n.\n.\n.\n$ cd ../user-auth/\n$ ./deploy_openunison_imp_impersonation.sh \n```", "```\n$ cd ../opensearch/\n$ ./deploy_opensearch.sh \n```", "```\n$ k logs fluent-bit-grhvw -n fluentbit | grep nginx\n[2024/01/26 01:26:23] [ info] [input:tail:tail.0] inotify_fs_add(): inode=1606570 watch_fd=19 name=/var/log/containers/ingress-nginx-admission-create-k8fxz_ingress-nginx_create-6….log\n[2024/01/26 01:26:23] [ info] [input:tail:tail.0] inotify_fs_add(): inode=1606592 watch_fd=20 name=/var/log/containers/ingress-nginx-admission-patch-fhwpx_ingress-nginx_patch-0….log\n**[2024/01/26 01:26:23] [ info] [input:tail:tail.0] inotify_fs_add(): inode=1610601 watch_fd=21 name=/var/log/containers/ingress-nginx-controller-977d987f8-4xxvr_ingress-nginx_controller-8….log** \n```", "```\nsource = logstash-*\n| where kubernetes.namespace_name=\"ingress-nginx\"\n| fields log \n```"]
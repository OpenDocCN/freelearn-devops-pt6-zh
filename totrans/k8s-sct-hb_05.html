<html><head></head><body>
<div id="_idContainer030">
<h1 class="chapter-number" id="_idParaDest-90"><a id="_idTextAnchor092"/><span class="koboSpan" id="kobo.1.1">5</span></h1>
<h1 id="_idParaDest-91"><a id="_idTextAnchor093"/><span class="koboSpan" id="kobo.2.1">Security, Auditing, and Compliance</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In the previous chapters, we established the foundations from a design, implementation, and operational perspective to address the challenges of Kubernetes Secrets management. </span><span class="koboSpan" id="kobo.3.2">We also highlighted key areas of concern by peeling each layer of our full-stack infrastructure onion while considering paths to reduce or even mitigate security exposures. </span><span class="koboSpan" id="kobo.3.3">However, no matter how much effort we put into motion, the following questions will always </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">float around:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.5.1">How can our IT environments be </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">secured enough?</span></span></li>
<li><span class="koboSpan" id="kobo.7.1">What are the best practices from a control and </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">audit perspective?</span></span></li>
<li><span class="koboSpan" id="kobo.9.1">What are my </span><strong class="bold"><span class="koboSpan" id="kobo.10.1">Chief Information Security Officer</span></strong><span class="koboSpan" id="kobo.11.1"> (</span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.12.1">CISO</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">) requirements?</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.14.1">This chapter kicks off the advanced topics of this handbook with a reversed approach based on the last question, “</span><em class="italic"><span class="koboSpan" id="kobo.15.1">What are my CISO team requirements?</span></em><span class="koboSpan" id="kobo.16.1">” The answer is usually in the form of another question, such as “</span><em class="italic"><span class="koboSpan" id="kobo.17.1">What are the regulations that my organization has to comply with?</span></em><span class="koboSpan" id="kobo.18.1">”, which implies a </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">legal perspective.</span></span></p>
<p><span class="koboSpan" id="kobo.20.1">In this chapter, we will expand on the </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.22.1">Understanding cybersecurity versus cyber </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">risk management</span></span></li>
<li><span class="koboSpan" id="kobo.24.1">The most common </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">compliance standards</span></span></li>
<li><span class="koboSpan" id="kobo.26.1">Best practices for controlling, auditing, and mitigating </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">security risks</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.28.1">By the end of this chapter, you will know how to address the security concerns at the people, process, and technology levels through a simple </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">reusable blueprint.</span></span></p>
<h1 id="_idParaDest-92"><a id="_idTextAnchor094"/><span class="koboSpan" id="kobo.30.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.31.1">To complete the hands-on parts of this chapter, we will be leveraging a series of tools and platforms that are commonly used to interact with containers, Kubernetes, and Secrets management. </span><span class="koboSpan" id="kobo.31.2">For this chapter, we will be continuing with the same set </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">of tools:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.33.1">Docker</span></strong><span class="koboSpan" id="kobo.34.1"> (</span><a href="https://docker.com"><span class="koboSpan" id="kobo.35.1">https://docker.com</span></a><span class="koboSpan" id="kobo.36.1">) or Podman (</span><a href="https://podman.io"><span class="koboSpan" id="kobo.37.1">https://podman.io</span></a><span class="koboSpan" id="kobo.38.1">) as a container engine. </span><span class="koboSpan" id="kobo.38.2">Both are</span><a id="_idIndexMarker253"/><span class="koboSpan" id="kobo.39.1"> ok, although I do have a personal preference for Podman as it offers benefits </span><a id="_idIndexMarker254"/><span class="koboSpan" id="kobo.40.1">such as being daemonless for easy installation, rootless for added security, fully OCI compliant, Kubernetes ready, and the ability to integrate with </span><strong class="source-inline"><span class="koboSpan" id="kobo.41.1">systemd</span></strong><span class="koboSpan" id="kobo.42.1"> at the user level to </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">autostart containers/Pods.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.44.1">Podman Desktop</span></strong><span class="koboSpan" id="kobo.45.1"> (</span><a href="https://podman-desktop.io"><span class="koboSpan" id="kobo.46.1">https://podman-desktop.io</span></a><span class="koboSpan" id="kobo.47.1">) is open source software that provides a graphical</span><a id="_idIndexMarker255"/><span class="koboSpan" id="kobo.48.1"> user interface for building, starting, and debugging containers, running local Kubernetes instances, easing the migration from containers to Pods, and even connecting with remote platforms such as Red Hat OpenShift, Azure Kubernetes Engine, </span><span class="No-Break"><span class="koboSpan" id="kobo.49.1">and more.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.50.1">Git</span></strong><span class="koboSpan" id="kobo.51.1"> (</span><a href="https://git-scm.com"><span class="koboSpan" id="kobo.52.1">https://git-scm.com</span></a><span class="koboSpan" id="kobo.53.1">) is a version control system that we will be using to cover this book’s </span><a id="_idIndexMarker256"/><span class="koboSpan" id="kobo.54.1">examples but also leverage in our discovery of Secrets </span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">management solutions.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.56.1">Kube-bench </span></strong><span class="koboSpan" id="kobo.57.1">(</span><a href="https://github.com/aquasecurity/kube-bench"><span class="koboSpan" id="kobo.58.1">https://github.com/aquasecurity/kube-bench</span></a><span class="koboSpan" id="kobo.59.1">) is a community tool that can measure </span><a id="_idIndexMarker257"/><span class="koboSpan" id="kobo.60.1">your Kubernetes cluster against the </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">CIS Benchmarks.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.62.1">Compliance Operator</span></strong><span class="koboSpan" id="kobo.63.1"> (</span><a href="https://github.com/ComplianceAsCode/compliance-operator"><span class="koboSpan" id="kobo.64.1">https://github.com/ComplianceAsCode/compliance-operator</span></a><span class="koboSpan" id="kobo.65.1">) is a community tool that measures </span><a id="_idIndexMarker258"/><span class="koboSpan" id="kobo.66.1">and remediates security controls on the </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">Kubernetes cluster.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.68.1">HashiCorp Vault</span></strong><span class="koboSpan" id="kobo.69.1"> (</span><a href="https://www.vaultproject.io/community"><span class="koboSpan" id="kobo.70.1">https://www.vaultproject.io/community</span></a><span class="koboSpan" id="kobo.71.1">) is a community Vault with an Enterprise</span><a id="_idIndexMarker259"/><span class="koboSpan" id="kobo.72.1"> offering for storing credentials, tokens, and </span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">more safely.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.74.1">Trousseau</span></strong><span class="koboSpan" id="kobo.75.1"> (</span><a href="https://trousseau.io"><span class="koboSpan" id="kobo.76.1">https://trousseau.io</span></a><span class="koboSpan" id="kobo.77.1">) is a KMS provider plugin that leverages external KMSs such as</span><a id="_idIndexMarker260"/><span class="koboSpan" id="kobo.78.1"> HashiCorp Vault, Azure Key Vault, and their </span><span class="No-Break"><span class="koboSpan" id="kobo.79.1">AWS equivalents.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.80.1">This book’s GitHub repository contains the digital material linked to this </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">book: </span></span><a href="https://github.com/PacktPublishing/Kubernetes-Secrets-Handbook"><span class="No-Break"><span class="koboSpan" id="kobo.82.1">https://github.com/PacktPublishing/Kubernetes-Secrets-Handbook</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.83.1">.</span></span></p>
<h1 id="_idParaDest-93"><a id="_idTextAnchor095"/><span class="koboSpan" id="kobo.84.1">Cybersecurity versus cyber risk</span></h1>
<p><span class="koboSpan" id="kobo.85.1">While (cyber)security </span><a id="_idIndexMarker261"/><span class="koboSpan" id="kobo.86.1">and cyber risk</span><a id="_idIndexMarker262"/><span class="koboSpan" id="kobo.87.1"> have more than enough publications, they are often mistaken to be the </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">same thing.</span></span></p>
<p><span class="koboSpan" id="kobo.89.1">The purpose of this section is to help you reflect on reshaping the traditional understanding of </span><em class="italic"><span class="koboSpan" id="kobo.90.1">doing</span></em><span class="koboSpan" id="kobo.91.1"> security from an IT-centric perspective to </span><em class="italic"><span class="koboSpan" id="kobo.92.1">practicing</span></em><span class="koboSpan" id="kobo.93.1"> security while having a holistic understanding of the organization’s needs and requirements. </span><span class="koboSpan" id="kobo.93.2">This will help you perform a dynamic risk management assessment for appropriate security </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">measure implementation.</span></span></p>
<h2 id="_idParaDest-94"><a id="_idTextAnchor096"/><span class="koboSpan" id="kobo.95.1">Cybersecurity</span></h2>
<p><span class="koboSpan" id="kobo.96.1">Most organizations assign the </span><a id="_idIndexMarker263"/><span class="koboSpan" id="kobo.97.1">security domain to their respective IT departments by designating a set of limited individuals almost working in isolation. </span><span class="koboSpan" id="kobo.97.2">Doing so introduces three limitations to their </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">cybersecurity mission:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.99.1">A limited scope only related to the infrastructure stack with no or limited consideration to critical </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">business applications</span></span></li>
<li><span class="koboSpan" id="kobo.101.1">Limited knowledge of the organization’s business </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">continuity plan</span></span></li>
<li><span class="koboSpan" id="kobo.103.1">The operations team has limited capabilities to respond appropriately to a </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">security incident</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.105.1">This model has a </span><span class="No-Break"><span class="koboSpan" id="kobo.106.1">twofold approach:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.107.1">Incident-driven </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">or reactive</span></span></li>
<li><span class="koboSpan" id="kobo.109.1">Lock everything down to address the reduced capabilities to monitor and discover </span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">security breaches</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.111.1">Since security is seen as a constraint by all IT staff, from developers to operations of all domains, drastic changes will be made either on an internal incident basis or when there is a public reference within the </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">same industry.</span></span></p>
<p><span class="koboSpan" id="kobo.113.1">Some argue that they have monitoring and processes in place that help identify and drive incidents to resolution. </span><span class="koboSpan" id="kobo.113.2">They also agree that there is a lack of fire drills to train their IT staff, a similar situation to </span><a id="_idIndexMarker264"/><span class="koboSpan" id="kobo.114.1">the </span><strong class="bold"><span class="koboSpan" id="kobo.115.1">Disaster Recovery </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.116.1">Plan</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.117.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.118.1">DRP</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.119.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.120.1">In our fast-paced digital economy, this cybersecurity model does not respond appropriately to our </span><span class="No-Break"><span class="koboSpan" id="kobo.121.1">three questions:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.122.1">How can our IT environments be </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">secured enough?</span></span></li>
<li><span class="koboSpan" id="kobo.124.1">What are the best practices from a control and </span><span class="No-Break"><span class="koboSpan" id="kobo.125.1">audit perspective?</span></span></li>
<li><span class="koboSpan" id="kobo.126.1">What are my </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">CISO’s requirements?</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.128.1">A typical example of ensuring security within this model would be implementing a strong login credential </span><a id="_idIndexMarker265"/><span class="koboSpan" id="kobo.129.1">policy, including a 30-day password update with additional multi-factor authentication with limited integration with the organization’s resources. </span><span class="koboSpan" id="kobo.129.2">This solution might fit an engineering team working on development but not the business team, who mainly uses web-based solutions that time out within a </span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">short period.</span></span></p>
<h2 id="_idParaDest-95"><a id="_idTextAnchor097"/><span class="koboSpan" id="kobo.131.1">Cyber risk</span></h2>
<p><span class="koboSpan" id="kobo.132.1">A different approach must be</span><a id="_idIndexMarker266"/><span class="koboSpan" id="kobo.133.1"> considered here: risk management from a business angle to address the governance and compliance requirements of each organization department. </span><span class="koboSpan" id="kobo.133.2">This will help prioritize the design and implementation of security measures while acquiring the appropriate skills at the organizational level. </span><span class="koboSpan" id="kobo.133.3">This approach demands an understanding of the organization’s mechanics, from finance to post-sales support, to prevent technical experts under/over-investing in security tools that are inefficient for the different </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">business units.</span></span></p>
<p><span class="koboSpan" id="kobo.135.1">Like a DRP, cyber risk management is about defining the minimal set of requirements to enable the organization to achieve its business goals, even in the case of a cyber-attack. </span><span class="koboSpan" id="kobo.135.2">When building such governance, not only must we answer the three aforementioned questions but also get the board to ask each executive </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">the following:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.137.1">CEO</span></strong><span class="koboSpan" id="kobo.138.1">: What </span><a id="_idIndexMarker267"/><span class="koboSpan" id="kobo.139.1">would be the brand damage of a </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">security breach?</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.141.1">CFO</span></strong><span class="koboSpan" id="kobo.142.1">: What</span><a id="_idIndexMarker268"/><span class="koboSpan" id="kobo.143.1"> would be the financial impact of a </span><span class="No-Break"><span class="koboSpan" id="kobo.144.1">security breach?</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.145.1">CISO</span></strong><span class="koboSpan" id="kobo.146.1">: Are </span><a id="_idIndexMarker269"/><span class="koboSpan" id="kobo.147.1">we prioritizing our investment to improve our </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">security posture?</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.149.1">COO</span></strong><span class="koboSpan" id="kobo.150.1">: Would</span><a id="_idIndexMarker270"/><span class="koboSpan" id="kobo.151.1"> our customers/partners trust doing business with </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">our organization?</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.153.1">While cybersecurity is seen as a cost, cyber risk management provides the reporting capabilities to show the business value of security investments and associated posture with a </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">near-real-time response.</span></span></p>
<p><span class="koboSpan" id="kobo.155.1">A typical example of security within this model would be implementing a strong login credential policy using a one-time password method. </span><span class="koboSpan" id="kobo.155.2">This solution offers sufficient security for the organization’s employees who are using web-based solutions. </span><span class="koboSpan" id="kobo.155.3">An additional multi-factor authentication with security auditing could be implemented when an employee wants to have access or push changes to the application </span><span class="No-Break"><span class="koboSpan" id="kobo.156.1">source code.</span></span></p>
<p><span class="koboSpan" id="kobo.157.1">Compared to the </span><a id="_idIndexMarker271"/><span class="koboSpan" id="kobo.158.1">cybersecurity approach, the cyber risk assessment addresses different risk levels with corresponding measures from a security, compliance, and usability perspective and additional measures when interacting with </span><span class="No-Break"><span class="koboSpan" id="kobo.159.1">critical assets.</span></span></p>
<h2 id="_idParaDest-96"><a id="_idTextAnchor098"/><span class="koboSpan" id="kobo.160.1">Conclusion</span></h2>
<p><span class="koboSpan" id="kobo.161.1">Doing (cyber)security for the sake of ticking a box will not provide any benefit to the organization and will frustrate all members of staff, including the IT department, resulting in security measures being disabled and shadow infrastructure </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">being built.</span></span></p>
<p><span class="koboSpan" id="kobo.163.1">Governance brings vision, mission, and execution in terms of how to operate within the digital economy regarding cyber-attacks. </span><span class="koboSpan" id="kobo.163.2">Adding a risk management framework will organically introduce the </span><em class="italic"><span class="koboSpan" id="kobo.164.1">security</span></em><span class="koboSpan" id="kobo.165.1"> part within your DevOps practice. </span><span class="koboSpan" id="kobo.165.2">At this point, we can embrace a model that will allow us to identify, protect, detect, respond to, and recover from security breaches while considering the necessary level of effort per risk to </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">the organization.</span></span></p>
<p><span class="koboSpan" id="kobo.167.1">As a follow-up to this topic, the following references provide more details about the frameworks that aid in </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">this area:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.169.1">National Institute of Standards and Technology (2018), </span><em class="italic"><span class="koboSpan" id="kobo.170.1">Framework for Improving Critical Infrastructure </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.171.1">Cybersecurity</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.172.1">. </span><span class="koboSpan" id="kobo.172.2">Self-Publishing.</span></span></li>
<li><span class="koboSpan" id="kobo.173.1">European Union Agency for Cybersecurity (2023), </span><em class="italic"><span class="koboSpan" id="kobo.174.1">Good Practices for Supply Chain </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.175.1">Cybersecurity</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">. </span><span class="koboSpan" id="kobo.176.2">Self-Publishing.</span></span></li>
<li><span class="koboSpan" id="kobo.177.1">Brown, J. </span><span class="koboSpan" id="kobo.177.2">(2023), </span><em class="italic"><span class="koboSpan" id="kobo.178.1">Executive’s Cybersecurity Program Handbook</span></em><span class="koboSpan" id="kobo.179.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">Packt Publishing.</span></span></li>
</ul>
<h1 id="_idParaDest-97"><a id="_idTextAnchor099"/><span class="koboSpan" id="kobo.181.1">Compliance standards</span></h1>
<p><span class="koboSpan" id="kobo.182.1">The concept of compliance is</span><a id="_idIndexMarker272"/><span class="koboSpan" id="kobo.183.1"> about how an organization will operate respectfully while considering a set of laws and policies that are specific to its industry, headquarters location, and the countries it may do business with to ensure privacy and security. </span><span class="koboSpan" id="kobo.183.2">Compliance requirements will dictate most of the requirements of an </span><span class="No-Break"><span class="koboSpan" id="kobo.184.1">organization’s governance.</span></span></p>
<p><span class="koboSpan" id="kobo.185.1">Any business might have to comply with more than one regulation, depending on their activities. </span><span class="koboSpan" id="kobo.185.2">A good example would be a US-based software company leveraging </span><strong class="bold"><span class="koboSpan" id="kobo.186.1">artificial intelligence</span></strong><span class="koboSpan" id="kobo.187.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.188.1">AI</span></strong><span class="koboSpan" id="kobo.189.1">) within </span><a id="_idIndexMarker273"/><span class="koboSpan" id="kobo.190.1">the healthcare sector, with </span><strong class="bold"><span class="koboSpan" id="kobo.191.1">Software-as-a-Service</span></strong><span class="koboSpan" id="kobo.192.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.193.1">SaaS</span></strong><span class="koboSpan" id="kobo.194.1">) and </span><a id="_idIndexMarker274"/><span class="koboSpan" id="kobo.195.1">on-premises offerings for medical practice across the globe. </span><span class="koboSpan" id="kobo.195.2">This implies the following </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">legal compliance:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.197.1">The United States </span><strong class="bold"><span class="koboSpan" id="kobo.198.1">Health Insurance Portability and Accountability Act</span></strong><span class="koboSpan" id="kobo.199.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.200.1">HIPAA</span></strong><span class="koboSpan" id="kobo.201.1">), for </span><a id="_idIndexMarker275"/><span class="koboSpan" id="kobo.202.1">handling </span><span class="No-Break"><span class="koboSpan" id="kobo.203.1">patient records</span></span></li>
<li><span class="koboSpan" id="kobo.204.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.205.1">European Union General Data Protection Regulation</span></strong><span class="koboSpan" id="kobo.206.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.207.1">GDPR</span></strong><span class="koboSpan" id="kobo.208.1">), a European Union regulation for</span><a id="_idIndexMarker276"/><span class="koboSpan" id="kobo.209.1"> collecting, processing, and storing personal user data from </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">third parties</span></span></li>
<li><span class="koboSpan" id="kobo.211.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.212.1">Payment Card Industry Data Security Standard</span></strong><span class="koboSpan" id="kobo.213.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.214.1">PCI-DSS</span></strong><span class="koboSpan" id="kobo.215.1">), an international industry standard </span><a id="_idIndexMarker277"/><span class="koboSpan" id="kobo.216.1">when transacting </span><span class="No-Break"><span class="koboSpan" id="kobo.217.1">payment cards</span></span></li>
<li><span class="koboSpan" id="kobo.218.1">Additional legal compliance, such as the European Union AI Act, which regulates the use of AI, the Cyber Resilience Act, which addresses the secure software supply chain, the Data Act, which supports the portability of data across cloud providers, and</span><a id="_idIndexMarker278"/><span class="koboSpan" id="kobo.219.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.220.1">Network Information System 2</span></strong><span class="koboSpan" id="kobo.221.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.222.1">NIS2</span></strong><span class="koboSpan" id="kobo.223.1">) directive, which ensures security and incident management best practices for </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">critical infrastructure</span></span></li>
<li><span class="koboSpan" id="kobo.225.1">Do not (in)directly (re)sell a solution with any sanctioned country listed by, and not limited to, the United States Department </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">of Commerce</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.227.1">Navigating the overall compliance obligations could be overwhelming. </span><span class="koboSpan" id="kobo.227.2">However, most regulations have overlapping security control rules that can be leveraged for a simplified or even unified approach. </span><span class="koboSpan" id="kobo.227.3">This is why</span><a id="_idIndexMarker279"/><span class="koboSpan" id="kobo.228.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.229.1">Center for Internet Security</span></strong><span class="koboSpan" id="kobo.230.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.231.1">CIS</span></strong><span class="koboSpan" id="kobo.232.1">) created a comprehensive benchmark per digital platform (operating system, mobile device, server software, cloud, virtualization, container, and </span><span class="No-Break"><span class="koboSpan" id="kobo.233.1">so on).</span></span></p>
<p><span class="koboSpan" id="kobo.234.1">The CIS Benchmarks help any organization’s IT department measure its current security posture from a security control perspective and related technical configurations, including exploit and mitigation details. </span><span class="koboSpan" id="kobo.234.2">These controls map with the most common regulatory frameworks, such as HIPAA, PCI DSS, SWIFT, ISO 27000, SOC 2, and NIST. </span><span class="koboSpan" id="kobo.234.3">Here is a mapping example of the CIS Benchmarks with NIST </span><span class="No-Break"><span class="koboSpan" id="kobo.235.1">800-53: </span></span><a href="https://www.cisecurity.org/insights/white-papers/cis-controls-v8-mapping-to-nist-800-53-rev-5"><span class="No-Break"><span class="koboSpan" id="kobo.236.1">https://www.cisecurity.org/insights/white-papers/cis-controls-v8-mapping-to-nist-800-53-rev-5</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.237.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.238.1">From a Kubernetes </span><a id="_idIndexMarker280"/><span class="koboSpan" id="kobo.239.1">perspective of the CIS Benchmarks (</span><a href="https://www.cisecurity.org/benchmark/kubernetes"><span class="koboSpan" id="kobo.240.1">https://www.cisecurity.org/benchmark/kubernetes</span></a><span class="koboSpan" id="kobo.241.1">), which is version 1.7.0 at the time of writing, here is an overview of the controls to be considered to </span><span class="No-Break"><span class="koboSpan" id="kobo.242.1">secure Secrets:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.243.1">Rule 1.2.29</span></strong><span class="koboSpan" id="kobo.244.1">: Ensure that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.245.1">--encryption-provider-config</span></strong><span class="koboSpan" id="kobo.246.1"> argument is set </span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">as appropriate:</span></span><ul><li><span class="koboSpan" id="kobo.248.1">This control description is about encrypting the </span><strong class="source-inline"><span class="koboSpan" id="kobo.249.1">etcd</span></strong><span class="koboSpan" id="kobo.250.1"> key-value store by using the remediation that we explored in </span><a href="B20970_03.xhtml#_idTextAnchor064"><em class="italic"><span class="koboSpan" id="kobo.251.1">Chapter 3</span></em></a><span class="koboSpan" id="kobo.252.1">, </span><em class="italic"><span class="koboSpan" id="kobo.253.1">Encrypting Secrets the Kubernetes-Native Way</span></em><span class="koboSpan" id="kobo.254.1">, in the </span><em class="italic"><span class="koboSpan" id="kobo.255.1">Key value </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.256.1">data</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.257.1"> section</span></span></li><li><span class="koboSpan" id="kobo.258.1">The benchmark also includes an audit by checking if </span><strong class="source-inline"><span class="koboSpan" id="kobo.259.1">kube-apiserver</span></strong><span class="koboSpan" id="kobo.260.1"> is running with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.261.1">--</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.262.1">encryption-provider-config</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.263.1"> flag</span></span></li></ul></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.264.1">Rule 1.2.30</span></strong><span class="koboSpan" id="kobo.265.1">: Ensure that encryption providers are </span><span class="No-Break"><span class="koboSpan" id="kobo.266.1">configured appropriately:</span></span><ul><li><span class="koboSpan" id="kobo.267.1">This control description is about making sure that the encryption provider set up for rule 1.2.29 is currently set using </span><strong class="source-inline"><span class="koboSpan" id="kobo.268.1">aescbc</span></strong><span class="koboSpan" id="kobo.269.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.270.1">aesgcm</span></strong><span class="koboSpan" id="kobo.271.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">or </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.273.1">kms</span></strong></span></li><li><span class="koboSpan" id="kobo.274.1">The benchmark also includes an audit that checks the configuration content from the file referenced by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.275.1">--</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.276.1">encryption-provider-config</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.277.1"> flag</span></span></li></ul></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.278.1">Rule 3.2.2</span></strong><span class="koboSpan" id="kobo.279.1">: Ensure that the audit policy covers key </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">security concerns:</span></span><ul><li><span class="koboSpan" id="kobo.281.1">This control description is about making sure that an audit policy is in place to confirm appropriate implementation for rules 1.2.29 </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">and 1.2.30.</span></span></li><li><span class="koboSpan" id="kobo.283.1">The benchmark also includes an audit overview of the required configuration to track access to, modify, and use </span><strong class="source-inline"><span class="koboSpan" id="kobo.284.1">Secret</span></strong><span class="koboSpan" id="kobo.285.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.286.1">ConfigMap</span></strong><span class="koboSpan" id="kobo.287.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">TokenReview</span></strong><span class="koboSpan" id="kobo.289.1"> via </span><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">Pod</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.291.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.292.1">Service</span></strong></span></li></ul></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.293.1">Rule 5.4.1</span></strong><span class="koboSpan" id="kobo.294.1">: Prefer using Secrets as files over Secrets as </span><span class="No-Break"><span class="koboSpan" id="kobo.295.1">environment variables:</span></span><ul><li><span class="koboSpan" id="kobo.296.1">This control description is about avoiding injecting </span><strong class="source-inline"><span class="koboSpan" id="kobo.297.1">Secret</span></strong><span class="koboSpan" id="kobo.298.1"> as a </span><strong class="source-inline"><span class="koboSpan" id="kobo.299.1">Pod</span></strong><span class="koboSpan" id="kobo.300.1"> environment variable due to its potential exposures within the node’s memory and </span><span class="No-Break"><span class="koboSpan" id="kobo.301.1">application logs</span></span></li><li><span class="koboSpan" id="kobo.302.1">The benchmark also includes an audit overview to help you perform a search about environment variables related to Secrets within </span><span class="No-Break"><span class="koboSpan" id="kobo.303.1">the logs</span></span></li></ul></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.304.1">Rule 5.4.2</span></strong><span class="koboSpan" id="kobo.305.1">: Consider external </span><span class="No-Break"><span class="koboSpan" id="kobo.306.1">secret storage:</span></span><ul><li><span class="koboSpan" id="kobo.307.1">This control description is about leveraging an external vault solution from a third party instead of the embedded </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">etcd</span></strong><span class="koboSpan" id="kobo.309.1"> key-value store, a subject that will be explored in </span><a href="B20970_11.xhtml#_idTextAnchor212"><em class="italic"><span class="koboSpan" id="kobo.310.1">Chapter 11</span></em></a><span class="koboSpan" id="kobo.311.1">, </span><em class="italic"><span class="koboSpan" id="kobo.312.1">Exploring External </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.313.1">Secret Stores</span></em></span></li><li><span class="koboSpan" id="kobo.314.1">The benchmark also includes an audit overview to help you review appropriate Secrets management implementation with this </span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">third-party solution</span></span></li></ul></li>
</ul>
<p><span class="koboSpan" id="kobo.316.1">Note that some </span><a id="_idIndexMarker281"/><span class="koboSpan" id="kobo.317.1">regulations might include physical security controls, such as data center and physical server access, which are not covered within the CIS Benchmarks. </span><span class="koboSpan" id="kobo.317.2">However, from our onion perspective and its security analysis in </span><a href="B20970_03.xhtml#_idTextAnchor064"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.318.1">Chapter 3</span></em></span></a><span class="koboSpan" id="kobo.319.1">, </span><em class="italic"><span class="koboSpan" id="kobo.320.1">Encrypting Secrets the Kubernetes-Native Way</span></em><span class="koboSpan" id="kobo.321.1">, these controls </span><span class="No-Break"><span class="koboSpan" id="kobo.322.1">are relevant.</span></span></p>
<p><span class="koboSpan" id="kobo.323.1">It is time to update our</span><a id="_idIndexMarker282"/><span class="koboSpan" id="kobo.324.1"> onion diagram so that it includes new layers representing the continuous effort to ensure compliance with regulatory obligations and standards that are described within the </span><span class="No-Break"><span class="koboSpan" id="kobo.325.1">organization’s governance:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer029">
<span class="koboSpan" id="kobo.326.1"><img alt="Figure 5.1 – The security posture framework for Kubernetes Secrets Management" src="image/B20970_05_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.327.1">Figure 5.1 – The security posture framework for Kubernetes Secrets management</span></p>
<p><span class="koboSpan" id="kobo.328.1">Considering</span><a id="_idIndexMarker283"/><span class="koboSpan" id="kobo.329.1"> the organization’s governance and this cyber risk assessment model, these additional layers provide continuous discovery, assessment, analysis, and (mitigation) execution so that we can define and improve the current security and </span><span class="No-Break"><span class="koboSpan" id="kobo.330.1">c</span><a id="_idTextAnchor100"/><span class="koboSpan" id="kobo.331.1">ompliance posture.</span></span></p>
<h1 id="_idParaDest-98"><a id="_idTextAnchor101"/><span class="koboSpan" id="kobo.332.1">Adopting a DevSecOps mindset</span></h1>
<p><span class="koboSpan" id="kobo.333.1">In the</span><a id="_idIndexMarker284"/><span class="koboSpan" id="kobo.334.1"> previous sections, we drafted a series of best practices that could be summarized with the following </span><span class="No-Break"><span class="koboSpan" id="kobo.335.1">key points:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.336.1">Consider the organization’s governance, which includes the regulatory frameworks they must </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">comply with</span></span></li>
<li><span class="koboSpan" id="kobo.338.1">Adopt a cyber risk management mindset to customize the security controls to be implemented that are appropriate to each business unit instead of a rigid one-size-fits-all </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">cybersecurity policy</span></span></li>
<li><span class="koboSpan" id="kobo.340.1">Consider </span><a id="_idIndexMarker285"/><span class="koboSpan" id="kobo.341.1">security as a continuous improvement effort of discovering, analyzing, and reporting during all </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">operational activities</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.343.1">We’ve used the term </span><em class="italic"><span class="koboSpan" id="kobo.344.1">security posture</span></em><span class="koboSpan" id="kobo.345.1"> a couple of times in this handbook. </span><span class="koboSpan" id="kobo.345.2">Let’s define what it is while utilizing the NIST 800-37 specifications: “</span><em class="italic"><span class="koboSpan" id="kobo.346.1">The security status of an enterprise’s networks, information, and systems based on information assurance resources (for example, people, hardware, software, and policies) and capabilities in place to manage the defense of the enterprise and to react as the situation changes. </span><span class="koboSpan" id="kobo.346.2">This is synonymous with </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.347.1">security status.</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.348.1">”</span></span></p>
<p><span class="koboSpan" id="kobo.349.1">Once you have established your current security posture against a framework such as the CIS Benchmarks for Kubernetes, then it will be easier to identify the gaps and continuously improve your posture with the current and future </span><span class="No-Break"><span class="koboSpan" id="kobo.350.1">missing controls.</span></span></p>
<p><span class="koboSpan" id="kobo.351.1">Embracing this approach introduces a change of mindset, which helps with continuously reviewing the organization’s security posture and highlighting the gaps to mitigate. </span><span class="koboSpan" id="kobo.351.2">This is also referred to as </span><span class="No-Break"><span class="koboSpan" id="kobo.352.1">DevSecOps practices.</span></span></p>
<p><span class="koboSpan" id="kobo.353.1">At this stage, a DevSecOps adoption will organically infuse the governance and compliance requirements within the entire DevOps cycle. </span><span class="koboSpan" id="kobo.353.2">This will shorten the feedback loop for the relevant teams to work on mitigation, and thus improve compliance, security response, and posture before deploying </span><span class="No-Break"><span class="koboSpan" id="kobo.354.1">to production.</span></span></p>
<p><span class="koboSpan" id="kobo.355.1">Do not consider the DevSecOps practices as a separate framework; instead, see them as complementary to the DevOps model. </span><span class="koboSpan" id="kobo.355.2">All security practices are tied together within </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">each step:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.357.1">Planning</span></strong><span class="koboSpan" id="kobo.358.1">: This includes security, governance, and compliance requirements within the initial project scope. </span><span class="koboSpan" id="kobo.358.2">The pitfall would be to consider these requirements as the last validation before releasing </span><span class="No-Break"><span class="koboSpan" id="kobo.359.1">the application.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.360.1">Development</span></strong><span class="koboSpan" id="kobo.361.1">: This infuses security into the organization’s coding governance to help mitigate common exposures. </span><span class="koboSpan" id="kobo.361.2">It includes code analysis tooling to help identify vulnerabilities before the code </span><span class="No-Break"><span class="koboSpan" id="kobo.362.1">is committed.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.363.1">CI/CD</span></strong><span class="koboSpan" id="kobo.364.1">: This involves performing security testing to scan code and container images for vulnerabilities. </span><span class="koboSpan" id="kobo.364.2">This helps with detecting and remediating these exposures before they make their way </span><span class="No-Break"><span class="koboSpan" id="kobo.365.1">into production.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.366.1">Continuous monitoring/auditing</span></strong><span class="koboSpan" id="kobo.367.1">: This helps with detecting and responding in near real-time to security exposures. </span><span class="koboSpan" id="kobo.367.2">This can also help with risk-based approaches, where some security exposures might be considered acceptable to carry on with but should be </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">closely monitored.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.369.1">Adding</span><a id="_idIndexMarker286"/><span class="koboSpan" id="kobo.370.1"> security within the DevOps flow will encourage all teams to collaborate and promote a culture of shared responsibility and accountability toward high-quality and secure software delivery by catching security exposures earlier in the </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">development process.</span></span></p>
<h1 id="_idParaDest-99"><a id="_idTextAnchor102"/><span class="koboSpan" id="kobo.372.1">Tools</span></h1>
<p><span class="koboSpan" id="kobo.373.1">From our Kubernetes </span><a id="_idIndexMarker287"/><span class="koboSpan" id="kobo.374.1">perspective and based on its dedicated CIS Benchmarks, the Secrets management part will require us to do </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.376.1">Enable encryption capabilities for the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.377.1">etcd</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.378.1"> service</span></span></li>
<li><span class="koboSpan" id="kobo.379.1">Define and enforce resource access policies for sensitive data payloads such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">Secret</span></strong><span class="koboSpan" id="kobo.381.1"> but also </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">ConfigMap</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.383.1"> objects</span></span></li>
<li><span class="koboSpan" id="kobo.384.1">Consider an external Secrets management solution to enhance the platform’s </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">security posture</span></span></li>
<li><span class="koboSpan" id="kobo.386.1">Audit all interactions that are done with these objects within and outside of </span><span class="No-Break"><span class="koboSpan" id="kobo.387.1">the platform</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.388.1">To do so, you’ll require a set of tools that help you discover, analyze, and mitigate potential security exposures. </span><span class="koboSpan" id="kobo.388.2">We will explore </span><span class="No-Break"><span class="koboSpan" id="kobo.389.1">five tools:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.390.1">Trivy, from Aqua Sec</span></strong><span class="koboSpan" id="kobo.391.1">: This </span><a id="_idIndexMarker288"/><span class="koboSpan" id="kobo.392.1">will help you not only scan container image vulnerabilities but also</span><a id="_idIndexMarker289"/><span class="koboSpan" id="kobo.393.1"> secret-related </span><span class="No-Break"><span class="koboSpan" id="kobo.394.1">security exposures.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.395.1">kube-bench</span></strong><span class="koboSpan" id="kobo.396.1">: For </span><a id="_idIndexMarker290"/><span class="koboSpan" id="kobo.397.1">assessing </span><a id="_idIndexMarker291"/><span class="koboSpan" id="kobo.398.1">the </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">CIS Benchmarks.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.400.1">Compliance Operator</span></strong><span class="koboSpan" id="kobo.401.1">: For</span><a id="_idIndexMarker292"/><span class="koboSpan" id="kobo.402.1"> assessing supported OpenSCAP profiles and providing</span><a id="_idIndexMarker293"/> <span class="No-Break"><span class="koboSpan" id="kobo.403.1">mitigating paths.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.404.1">StackRox</span></strong><span class="koboSpan" id="kobo.405.1">: For assessing supported security profiles for your clusters, container images, and networking flows. </span><span class="koboSpan" id="kobo.405.2">StackRox</span><a id="_idIndexMarker294"/><span class="koboSpan" id="kobo.406.1"> has a comprehensive user interface with a</span><a id="_idIndexMarker295"/><span class="koboSpan" id="kobo.407.1"> useful risk-based dashboard that ranks exposures by </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">risk level.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.409.1">Kubernetes logging</span></strong><span class="koboSpan" id="kobo.410.1">: For </span><a id="_idIndexMarker296"/><span class="koboSpan" id="kobo.411.1">harvesting all information and audit trails</span><a id="_idIndexMarker297"/><span class="koboSpan" id="kobo.412.1"> related to the interaction between the platform, the applications, </span><span class="No-Break"><span class="koboSpan" id="kobo.413.1">and users.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.414.1">Let’s have a look at the capabilities of these tools while illustrating their usage. </span><span class="koboSpan" id="kobo.414.2">All these tools help you comply with regulations and initiate the DevSecOps model while con</span><a id="_idTextAnchor103"/><span class="koboSpan" id="kobo.415.1">tinuously improving your </span><span class="No-Break"><span class="koboSpan" id="kobo.416.1">security posture.</span></span></p>
<h2 id="_idParaDest-100"><a id="_idTextAnchor104"/><span class="koboSpan" id="kobo.417.1">Trivy</span></h2>
<p><span class="koboSpan" id="kobo.418.1">Due to the </span><a id="_idIndexMarker298"/><span class="koboSpan" id="kobo.419.1">immutable nature of container images, it is important to continuously track vulnerabilities with a scanner such as</span><a id="_idIndexMarker299"/><span class="koboSpan" id="kobo.420.1"> Trivy. </span><span class="koboSpan" id="kobo.420.2">This tool also has a particular interest in Secrets management as it can target specific security severity related </span><span class="No-Break"><span class="koboSpan" id="kobo.421.1">to Secrets.</span></span></p>
<p><span class="koboSpan" id="kobo.422.1">Using the Trivy Kubernetes CLI, a scanning process can be triggered specif</span><a id="_idTextAnchor105"/><span class="koboSpan" id="kobo.423.1">ically for Secrets via the </span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.425.1">
trivy k8s –severity-checks=secret –report=summary cluster</span></pre> <p><span class="koboSpan" id="kobo.426.1">See the </span><strong class="source-inline"><span class="koboSpan" id="kobo.427.1">chapter 5</span></strong><span class="koboSpan" id="kobo.428.1"> folder in this book’s GitHub repository for an example of how to implem</span><a id="_idTextAnchor106"/><span class="koboSpan" id="kobo.429.1">ent Trivy on a local </span><strong class="source-inline"><span class="koboSpan" id="kobo.430.1">kind</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.431.1">Kubernetes cluster.</span></span></p>
<h2 id="_idParaDest-101"><a id="_idTextAnchor107"/><span class="koboSpan" id="kobo.432.1">kube-bench</span></h2>
<p><span class="koboSpan" id="kobo.433.1">Your IT department might </span><a id="_idIndexMarker300"/><span class="koboSpan" id="kobo.434.1">have already invested in a security suite for your entire </span><a id="_idIndexMarker301"/><span class="koboSpan" id="kobo.435.1">organization’s infrastructure, but let’s consider surgical tools versus </span><span class="No-Break"><span class="koboSpan" id="kobo.436.1">generic ones.</span></span></p>
<p><span class="koboSpan" id="kobo.437.1">When it comes to measuring your environment against the CIS Benchmarks, </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">kube-bench</span></strong><span class="koboSpan" id="kobo.439.1"> from Aqua Security Software might be one of the most interesting tools to run on your Kubernetes cluster(s). </span><span class="koboSpan" id="kobo.439.2">The benchmark job can be configured using a standard YAML manifest; you can customize it so that it’s relevant to your </span><span class="No-Break"><span class="koboSpan" id="kobo.440.1">organization’s governance.</span></span></p>
<p><span class="koboSpan" id="kobo.441.1">Here is an example of </span><span class="No-Break"><span class="koboSpan" id="kobo.442.1">a check:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.443.1">
---
controls:
id: 1
text: "Master Node Security Configuration"
type: "master"
groups:
- id: 1.1
  text: API Server
  checks:
    - id: 1.1.1
      text: "Ensure that the --allow-pri</span><a id="_idTextAnchor108"/><span class="koboSpan" id="kobo.444.1">vileged argument is set (Scored)"
      audit: "ps -ef | grep ku</span><a id="_idTextAnchor109"/><span class="koboSpan" id="kobo.445.1">be-apiserver | gr</span><a id="_idTextAnchor110"/><span class="koboSpan" id="kobo.446.1">ep -v grep"
      tests:
      bin_op: or
      test_items:
      - flag: "--allow-privileged"
        set: true
      - flag: "--some-other-flag"
        set: false
      remediation: "Edit the /etc/kubernetes/config file on the master node and
        set the KUBE_ALLOW_PRIV parameter to '--allow-privileged=false'"
      scored: true</span></pre> <p><span class="koboSpan" id="kobo.447.1">This control example assesses if privileged containers – that is, containers bypassing any limitations from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.448.1">cgroup</span></strong><span class="koboSpan" id="kobo.449.1"> controller – can elevate to the user root within the container, which also means the root on the </span><span class="No-Break"><span class="koboSpan" id="kobo.450.1">operating system.</span></span></p>
<p><span class="koboSpan" id="kobo.451.1">This example </span><a id="_idIndexMarker302"/><span class="koboSpan" id="kobo.452.1">shows how to</span><a id="_idIndexMarker303"/><span class="koboSpan" id="kobo.453.1"> disable a control by introducing the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.454.1">skip</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.455.1"> definition:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.456.1">
---
controls:
id: 1
text: "Master Node Security Configuration"
type: "master"
groups:
- id: 1.1
  text: API Server
  checks:
    - id: 1.1.1
      text: "Ensure that the --allow-privileged argument is set (Scored)"
      Type: "skip"
      scored: true</span></pre> <p><span class="koboSpan" id="kobo.457.1">See the </span><strong class="source-inline"><span class="koboSpan" id="kobo.458.1">chapter 5</span></strong><span class="koboSpan" id="kobo.459.1"> folder in this book’s GitHub repository for an example of how to implement </span><strong class="source-inline"><span class="koboSpan" id="kobo.460.1">kube-bench</span></strong><span class="koboSpan" id="kobo.461.1"> on a local </span><strong class="source-inline"><span class="koboSpan" id="kobo.462.1">kind</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.463.1">Kubernetes cluster.</span></span></p>
<h2 id="_idParaDest-102"><a id="_idTextAnchor111"/><span class="koboSpan" id="kobo.464.1">Compliance Operator</span></h2>
<p><span class="koboSpan" id="kobo.465.1">Another </span><a id="_idIndexMarker304"/><span class="koboSpan" id="kobo.466.1">way to utilize the</span><a id="_idIndexMarker305"/><span class="koboSpan" id="kobo.467.1"> capabilities of </span><strong class="source-inline"><span class="koboSpan" id="kobo.468.1">kube-bench</span></strong><span class="koboSpan" id="kobo.469.1"> on a Red Hat OpenShift Container Platform and Kubernetes distributions that support operators would be </span><strong class="bold"><span class="koboSpan" id="kobo.470.1">Compliance Operator</span></strong><span class="koboSpan" id="kobo.471.1">. </span><span class="koboSpan" id="kobo.471.2">This tool runs compliance checks against the CIS Benchmarks and </span><a id="_idIndexMarker306"/><span class="koboSpan" id="kobo.472.1">other </span><strong class="bold"><span class="koboSpan" id="kobo.473.1">Security Content Automation Protocol</span></strong><span class="koboSpan" id="kobo.474.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.475.1">SCAP</span></strong><span class="koboSpan" id="kobo.476.1">) profiles, such</span><a id="_idIndexMarker307"/><span class="koboSpan" id="kobo.477.1"> as the </span><strong class="bold"><span class="koboSpan" id="kobo.478.1">Australian Cyber Security Centre’s</span></strong><span class="koboSpan" id="kobo.479.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.480.1">ACSC’s</span></strong><span class="koboSpan" id="kobo.481.1">) </span><span class="No-Break"><span class="koboSpan" id="kobo.482.1">Essential Eight.</span></span></p>
<p><span class="koboSpan" id="kobo.483.1">This tool not only assesses security exposures but also provides remediation capabilities. </span><span class="koboSpan" id="kobo.483.2">Like scanning, each mitigation has a YAML definition and can be applied one at a time or in batches, which allows for granular testing and validation phases. </span><span class="koboSpan" id="kobo.483.3">This can also be done on existing clusters for </span><span class="No-Break"><span class="koboSpan" id="kobo.484.1">late implementations.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.485.1">Important notes</span></p>
<p class="callout"><span class="koboSpan" id="kobo.486.1">Both </span><strong class="source-inline"><span class="koboSpan" id="kobo.487.1">kube-bench</span></strong><span class="koboSpan" id="kobo.488.1"> and Compliance Operator require specific elevated privileges to run that might not fit a production environment. </span><span class="koboSpan" id="kobo.488.2">A good practice would be to run these scans and remediations on a test environment that reflects your production environment before retrofit</span><a id="_idTextAnchor112"/><span class="koboSpan" id="kobo.489.1">ting the security rules on a </span><span class="No-Break"><span class="koboSpan" id="kobo.490.1">production environment.</span></span></p>
<h2 id="_idParaDest-103"><a id="_idTextAnchor113"/><span class="koboSpan" id="kobo.491.1">StackRox</span></h2>
<p><span class="koboSpan" id="kobo.492.1">The open source </span><a id="_idIndexMarker308"/><span class="koboSpan" id="kobo.493.1">StackRox project is designed to address security challenges linked</span><a id="_idIndexMarker309"/><span class="koboSpan" id="kobo.494.1"> to the increased usage of containerized applications orchestrated by Kubernetes. </span><span class="koboSpan" id="kobo.494.2">Its fast adoption creates a growing space for security exposures, which requires a platform to offer a series of comprehensive capabilities so that it can do </span><span class="No-Break"><span class="koboSpan" id="kobo.495.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.496.1">Manage the vulnerabilities of container images with a remediation path. </span><span class="koboSpan" id="kobo.496.2">This reduces the known security exposures </span><span class="No-Break"><span class="koboSpan" id="kobo.497.1">at runtime.</span></span></li>
<li><span class="koboSpan" id="kobo.498.1">Secure the container runtime by monitoring the application patterns and detect any potential signs of malicious processes, also called mutations. </span><span class="koboSpan" id="kobo.498.2">Responses can be informative or isolated from </span><span class="No-Break"><span class="koboSpan" id="kobo.499.1">the workload.</span></span></li>
<li><span class="koboSpan" id="kobo.500.1">Secure the networking flows by providing a graphical view of how containers in the same and different namespaces could communicate and provide mitigation paths with network policies to limit lateral movements from </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">malicious workloads.</span></span></li>
<li><span class="koboSpan" id="kobo.502.1">Audit and comply by scanning against the top industry and regulatory standards, helping organizations to baseline, improve, and maintain their </span><span class="No-Break"><span class="koboSpan" id="kobo.503.1">security posture.</span></span></li>
<li><span class="koboSpan" id="kobo.504.1">Integrate with development pipelines by leveraging an API-driven approach, thereby enabling continuous security checks as early as possible within the </span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">development process.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.506.1">Available as an open source project and integrated within the OpenShift Container Platform from Red Hat, StackRox </span><a id="_idIndexMarker310"/><span class="koboSpan" id="kobo.507.1">plays a significant role in comprehensive platforms to ease the security part of the </span><a id="_idIndexMarker311"/><span class="No-Break"><span class="koboSpan" id="kobo.508.1">DevSecOps workflow.</span></span></p>
<p><span class="koboSpan" id="kobo.509.1">See the </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">chapter 5</span></strong><span class="koboSpan" id="kobo.511.1"> folder in this book’s GitHub repository for an example of how to implement StackRox on a </span><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">kind</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.513.1">Kubernetes cluster.</span></span></p>
<h2 id="_idParaDest-104"><a id="_idTextAnchor114"/><span class="koboSpan" id="kobo.514.1">Kubernetes logging</span></h2>
<p><span class="koboSpan" id="kobo.515.1">While this is a must from a</span><a id="_idIndexMarker312"/><span class="koboSpan" id="kobo.516.1"> compliance and best practices perspective, the diverse</span><a id="_idIndexMarker313"/><span class="koboSpan" id="kobo.517.1"> landscape of solutions available to accomplish these tasks is overwhelming. </span><span class="koboSpan" id="kobo.517.2">As such, we will address this using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.518.1">Audit</span></strong><span class="koboSpan" id="kobo.519.1"> object definition from the Kubernetes </span><span class="No-Break"><span class="koboSpan" id="kobo.520.1">standard API.</span></span></p>
<p><span class="koboSpan" id="kobo.521.1">Kubernetes comes with an easy way to provide security-relevant records within its audit logs by enabling the relevant resources to be monitor</span><a id="_idTextAnchor115"/><span class="koboSpan" id="kobo.522.1">ed. </span><span class="koboSpan" id="kobo.522.2">Here is an example of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">Secret</span></strong><span class="koboSpan" id="kobo.524.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">ConfigMap</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.526.1"> objects:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.527.1">
apiVersion: audit.k8s.io/v1
kind: Policy
rules:
  - level: Metadata
    resources:
    - group: ""
      resources: ["secrets", "configmaps"]</span></pre> <p><span class="koboSpan" id="kobo.528.1">Save the </span><a id="_idIndexMarker314"/><span class="koboSpan" id="kobo.529.1">preceding code into a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.530.1">auditlog-secrets.yaml</span></strong><span class="koboSpan" id="kobo.531.1"> and</span><a id="_idIndexMarker315"/><span class="koboSpan" id="kobo.532.1"> apply this configuration against your cluster using </span><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">kubectl apply -</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.534.1">f auditlog-secrets.yaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">.</span></span></p>
<h1 id="_idParaDest-105"><a id="_idTextAnchor116"/><span class="koboSpan" id="kobo.536.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.537.1">While security and compliance can be overwhelming and considered to be constraining, this chapter drafted guidance for an organization to adopt a DevSecOps mindset with the support of standard and </span><span class="No-Break"><span class="koboSpan" id="kobo.538.1">integrated tools.</span></span></p>
<p><span class="koboSpan" id="kobo.539.1">It is important to acknowledge that the concept of security and compliance is not a finite state, with no single and simple recipe to protect your organization from digital threats. </span><span class="koboSpan" id="kobo.539.2">(Cyber)security will be welcomed by the entire organization when it’s tailored to the business using a risk assessment approach, removing the feeling of constraints linked to operating in a so-called secured environment. </span><span class="koboSpan" id="kobo.539.3">When designed well, all stakeholders will organically participate in the continuous efforts of assessing, analyzing, executing, and discovering new policies, vulnerabilities, and potential </span><span class="No-Break"><span class="koboSpan" id="kobo.540.1">ongoing attacks.</span></span></p>
<p><span class="koboSpan" id="kobo.541.1">In the next chapter, we will address the business continuity aspect by introducing and implementing the disaster recovery and backup strategies of </span><span class="No-Break"><span class="koboSpan" id="kobo.542.1">Kubernetes Secrets.</span></span></p>
</div>
</body></html>
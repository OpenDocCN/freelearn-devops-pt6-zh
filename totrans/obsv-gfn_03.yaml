- en: '3'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '3'
- en: Setting Up a Learning Environment with Demo Applications
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用演示应用程序设置学习环境
- en: This chapter guides you through setting up a **learning environment** for the
    practical examples throughout this book and for independent experimentation. As
    Grafana Labs offers a free tier of their cloud service, we will use this for the
    storage and searching of data. To produce rich, useful data, we will use the **OpenTelemetry**
    demo application. This demo application deploys the services needed to run the
    OpenTelemetry Astronomy Shop locally. These applications are written in many different
    languages and are instrumented to produce metrics, logs, and distributed traces.
    This application will help you interact directly (and via load generators) with
    real applications and see observability telemetry in real time in the Grafana
    Labs instance.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将指导你设置一个 **学习环境**，用于本书中的实际示例以及独立实验。由于 Grafana Labs 提供了免费层云服务，我们将使用该服务进行数据存储和搜索。为了生成丰富有用的数据，我们将使用
    **OpenTelemetry** 演示应用程序。该演示应用程序部署了运行 OpenTelemetry Astronomy Shop 所需的服务。这些应用程序采用多种编程语言编写，并已进行仪器化以生成指标、日志和分布式追踪数据。此应用程序将帮助你直接与真实应用程序进行交互（包括通过负载生成器），并实时在
    Grafana Labs 实例中查看观察性遥测数据。
- en: 'In this chapter, we’re going to cover the following main topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主要主题：
- en: Introducing Grafana Cloud
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍 Grafana Cloud
- en: Installing the prerequisite tools
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装必备工具
- en: Installing the OpenTelemetry Demo application
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装 OpenTelemetry 演示应用程序
- en: Exploring telemetry from the demo application
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 探索来自演示应用程序的遥测数据
- en: Troubleshooting your OpenTelemetry demo application
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 故障排除 OpenTelemetry 演示应用程序
- en: Technical requirements
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: We assume you are working on at least Windows 10 version 2004, macOS version
    11, or a relatively recent installation of Linux (e.g., Ubuntu 20.10 or later);
    earlier versions are not supported. We will be using the OpenTelemetry Collector
    version 0.73.1 and the OpenTelemetry Demo version 0.26.0\. Full installation instructions
    for these components are provided in this chapter.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我们假设你正在使用至少 Windows 10 版本 2004、macOS 版本 11 或相对较新的 Linux 安装（例如，Ubuntu 20.10 或更高版本）；早期版本不受支持。我们将使用
    OpenTelemetry Collector 版本 0.73.1 和 OpenTelemetry 演示版本 0.26.0。本章提供了这些组件的完整安装说明。
- en: All commands and configuration files to complete these steps are included in
    the GitHub repository at [https://github.com/PacktPublishing/Observability-with-Grafana/tree/main/chapter3](https://github.com/PacktPublishing/Observability-with-Grafana/tree/main/chapter3).
    You'll find the *Code in Action* videos for this chapter at [https://packt.link/GNFyp](https://packt.link/GNFyp).
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 完成这些步骤所需的所有命令和配置文件都包含在 GitHub 仓库中，地址为 [https://github.com/PacktPublishing/Observability-with-Grafana/tree/main/chapter3](https://github.com/PacktPublishing/Observability-with-Grafana/tree/main/chapter3)。你可以在
    [https://packt.link/GNFyp](https://packt.link/GNFyp) 查看本章的 *代码实践* 视频。
- en: Introducing Grafana Cloud
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍 Grafana Cloud
- en: Grafana Cloud is a hosted platform-as-a-service observability tool. It offers
    the ability to quickly create infrastructure to receive and store log, metric,
    and trace data as well as tools to visualize the data. We are using Grafana Cloud
    to reduce the technical skill needed to engage with this book, although all the
    open source components from Grafana that we will introduce can be deployed locally
    as well.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: Grafana Cloud 是一个托管的基础设施即服务观察性工具平台。它提供了快速创建基础设施的能力，用于接收和存储日志、度量和追踪数据，并且提供可视化数据的工具。我们使用
    Grafana Cloud 来降低与本书内容互动所需的技术技能，尽管我们将介绍的所有 Grafana 开源组件也可以本地部署。
- en: Grafana Cloud offers free access. In this chapter, we will first set up a cloud
    account and familiarize ourselves with the administration and use of the tools.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: Grafana Cloud 提供免费访问。在本章中，我们将首先设置一个云账户，并熟悉工具的管理和使用。
- en: Important note
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Grafana Labs introduces changes on a regular basis. The information and screenshots
    in this chapter are based on Grafana version 10.2, which was released in October
    2023.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: Grafana Labs 会定期推出更新。本章中的信息和截图基于 2023 年 10 月发布的 Grafana 版本 10.2。
- en: Setting up an account
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置账户
- en: 'Creating a free Grafana Cloud account is simple. To do this, follow these steps:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 创建免费 Grafana Cloud 账户很简单。请按照以下步骤操作：
- en: Go to [https://www.grafana.com](https://www.grafana.com) and click on **Create**
    **Free Account**.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问 [https://www.grafana.com](https://www.grafana.com)，然后点击 **创建** **免费账户**。
- en: 'Sign up using any of the following:'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下任一方式注册
- en: A Google account
  id: totrans-21
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个 Google 账户
- en: A GitHub account
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个 GitHub 账户
- en: A Microsoft account
  id: totrans-23
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个 Microsoft 账户
- en: An Amazon account
  id: totrans-24
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个 Amazon 账户
- en: An email address
  id: totrans-25
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个电子邮件地址
- en: 'Choose a team URL. This is the URL used to access your Grafana instance. In
    our sample setup, we chose `observabilitywithgrafana`:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择一个团队 URL。这是用来访问您的 Grafana 实例的 URL。在我们的示例设置中，我们选择了 `observabilitywithgrafana`：
- en: '![Figure 3.1 – Creating a Grafana stack](img/B18277_figure_3.1.jpg)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.1 – 创建 Grafana stack](img/B18277_figure_3.1.jpg)'
- en: Figure 3.1 – Creating a Grafana stack
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.1 – 创建 Grafana stack
- en: Choose a deployment region from the available list and then wait for a few minutes
    for your Grafana account to be created.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从可用列表中选择一个部署区域，然后等待几分钟以完成您的 Grafana 账户创建。
- en: 'When the account creation is completed, you will see a screen titled **GET
    STARTED**, as shown in the following screenshot. We encourage you to explore the
    screens in Grafana, but for this introduction, you can just click on **I’m already
    familiar** **with Grafana**:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当账户创建完成后，您将看到一个名为 **GET STARTED** 的屏幕，如下图所示。我们鼓励您探索 Grafana 的各个屏幕，但在这次介绍中，您可以直接点击
    **I’m already familiar** **with Grafana**：
- en: '![Figure 3.2 – Get started with Grafana](img/B18277_figure_3.2.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.2 – 开始使用 Grafana](img/B18277_figure_3.2.jpg)'
- en: Figure 3.2 – Get started with Grafana
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.2 – 开始使用 Grafana
- en: 'Then click on the Grafana icon in the top-left corner to return to the home
    screen, and finally, click on **Stacks**, which you will find just under the welcome
    message:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 然后点击左上角的 Grafana 图标返回到主屏幕，最后点击 **Stacks**，它位于欢迎信息的下方：
- en: '![Figure 3.3 – Welcome to Grafana Cloud](img/B18277_figure_3.3.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.3 – 欢迎来到 Grafana Cloud](img/B18277_figure_3.3.jpg)'
- en: Figure 3.3 – Welcome to Grafana Cloud
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.3 – 欢迎来到 Grafana Cloud
- en: This will take you to the Grafana Cloud Portal, which will look like this.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将带您进入 Grafana Cloud 门户，界面如下所示。
- en: '![Figure 3.4 – The Grafana Cloud Portal](img/B18277_figure_3.4.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.4 – Grafana Cloud 门户](img/B18277_figure_3.4.jpg)'
- en: Figure 3.4 – The Grafana Cloud Portal
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.4 – Grafana Cloud 门户
- en: Before we set up the local data-producing environment, let’s take a few moments
    to explore the basics of the Grafana Cloud Portal and your new Grafana Stack.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们设置本地数据生成环境之前，先花点时间探索一下 Grafana Cloud 门户和您的新 Grafana Stack 的基础内容。
- en: Exploring the Grafana Cloud Portal
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索 Grafana Cloud 门户
- en: The home page of the portal shows your subscription and billing information,
    as well as details about your single Grafana Stack. When you first sign up for
    a **Cloud Free** subscription, you will be granted access to a 14-day trial for
    Cloud Pro. To access your instance of Grafana, you need to click on the **Launch**
    button in the **Grafana** section. This gives you access to view data you send
    to Grafana Cloud.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 门户网站的首页展示了您的订阅和账单信息，以及有关您的单一 Grafana Stack 的详细信息。当您首次注册 **Cloud Free** 订阅时，您将获得
    14 天的 Cloud Pro 试用访问权限。要访问您的 Grafana 实例，您需要点击 **Grafana** 部分中的 **Launch** 按钮。这将使您能够查看发送到
    Grafana Cloud 的数据。
- en: 'A full Grafana **Stack** consists of the following installations:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 完整的 Grafana **Stack** 包括以下安装：
- en: '**Visualization**:'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可视化**：'
- en: A Grafana instance
  id: totrans-44
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 Grafana 实例
- en: '**Metrics**:'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**指标**：'
- en: A Prometheus remote write endpoint
  id: totrans-46
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 Prometheus 远程写入端点
- en: A Graphite endpoint
  id: totrans-47
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 Graphite 端点
- en: A Mimir backend storage instance
  id: totrans-48
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 Mimir 后端存储实例
- en: '**Logs**:'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日志**：'
- en: A Loki endpoint
  id: totrans-50
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 Loki 端点
- en: A Loki backend storage instance
  id: totrans-51
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 Loki 后端存储实例
- en: '**Traces**:'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**追踪**：'
- en: A Tempo endpoint
  id: totrans-53
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 Tempo 端点
- en: A Tempo backend storage instance
  id: totrans-54
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 Tempo 后端存储实例
- en: '**Alerting**:'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**告警**：'
- en: An Alerting instance for managing Prometheus-based alerts
  id: totrans-56
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个用于管理基于 Prometheus 的告警的告警实例
- en: '**Load testing**:'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**负载测试**：'
- en: A k6 cloud runner
  id: totrans-58
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 k6 云端运行器
- en: '**Profiling**:'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**性能分析**：'
- en: A Pyroscope endpoint
  id: totrans-60
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 Pyroscope 端点
- en: A Pyroscope backend storage instance
  id: totrans-61
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 Pyroscope 后端存储实例
- en: 'Let’s take a look at some of the sections you can access in your portal:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一下您可以在门户中访问的一些部分：
- en: '**Security**: In this section, you can manage **access policies** and **access
    tokens**, **Open Authorization** (**OAuth**), **Security Assertion Markup Language**
    (**SAML**), and **Lightweight Directory Access** **Protocol** (**LDAP**).'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**安全性**：在此部分，您可以管理 **访问策略** 和 **访问令牌**、**开放授权**（**OAuth**）、**安全声明标记语言**（**SAML**）和
    **轻量级目录访问协议**（**LDAP**）。'
- en: Access policies are scoped to a **realm**; a realm can cover a specific stack,
    or it can cover the entire organization.
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 访问策略的范围是一个 **领域**；一个领域可以覆盖特定的 Stack，也可以覆盖整个组织。
- en: '**Support**: This section gives access to support from the community via **Community
    Forums**, and from Grafana Labs via **Support Ticket** and **Chat** **with Support**.'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**支持**：此部分通过 **社区论坛** 提供社区支持，并通过 **支持票** 和 **与支持人员聊天** 提供来自 Grafana Labs 的支持。'
- en: '**Billing**: The **Billing** section is where invoices and subscriptions are
    managed. A Cloud Free subscription provides a monthly limit of 10,000 metrics,
    50 GB logs and 50 GB traces, 50 GB profiles, as well as three **Incident Response
    & Management** (**IRM**) users and 500 k6 **virtual user hours** (**VUh**). This
    subscription is plenty for the demo applications we will be using during the book
    and similar small demo, personal-use installations. For larger installations,
    Grafana Cloud also offers two additional tiers, Cloud Pro and Cloud Advanced.
    These tiers give access to different key features, with Cloud Advanced being geared
    toward enterprise-level installations. Grafana then bills based on ingest and
    active users in different areas. Grafana provides a very easy-to-use monthly cost
    estimation tool:'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**账单**：**账单**部分是用于管理发票和订阅的地方。Cloud Free 订阅提供每月 10,000 个度量标准、50 GB 日志、50 GB
    跟踪、50 GB 配置文件、三个 **事件响应与管理** (**IRM**) 用户和 500 个 k6 **虚拟用户小时** (**VUh**) 的配额。这个订阅对于我们在本书中使用的示例应用程序以及类似的小型演示和个人用途安装非常充足。对于更大的安装，Grafana
    Cloud 还提供了两个额外的套餐，Cloud Pro 和 Cloud Advanced。这些套餐提供对不同关键功能的访问，其中 Cloud Advanced
    主要面向企业级安装。Grafana 根据不同领域的摄取量和活跃用户进行计费。Grafana 提供了一个非常易于使用的月度费用估算工具：'
- en: '![Figure 3.5 – Grafana cost estimator](img/B18277_figure_3.5.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.5 – Grafana 成本估算器](img/B18277_figure_3.5.jpg)'
- en: Figure 3.5 – Grafana cost estimator
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.5 – Grafana 成本估算器
- en: With a Cloud Free subscription, you will only have access to a single stack.
    With a subscription to **Cloud Pro** or **Cloud Advanced**, you will be able to
    create multiple stacks in your account. These stacks can be in different regions.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Cloud Free 订阅，你将只能访问一个堆栈。如果你订阅了 **Cloud Pro** 或 **Cloud Advanced**，你将能够在你的账户中创建多个堆栈。这些堆栈可以位于不同的区域。
- en: '**Org Settings**: Here, you can manage the users who can access Grafana Cloud.
    You can also update your avatar, organization name, and any plugins or dashboards
    you have shared with the community.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**组织设置**：在这里，你可以管理可以访问 Grafana Cloud 的用户。你还可以更新你的头像、组织名称以及你与社区共享的插件或仪表板。'
- en: Now that you have explored the Grafana Cloud Portal and have an overview of
    managing a Grafana Cloud account, let’s explore the Grafana instance in your cloud
    stack.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经探索了 Grafana Cloud 门户，并且了解了如何管理 Grafana Cloud 账户，接下来让我们探索你云堆栈中的 Grafana
    实例。
- en: Exploring the Grafana instance
  id: totrans-72
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索 Grafana 实例
- en: 'The main way to interact with the tools provided by the Grafana Stack is to
    access the **Grafana instance**. This instance provides visualization tools to
    view the data that is collected by the rest of the Grafana stack or other linked
    tools. To access your Grafana instance, you can click on the **Launch** button
    in your Cloud Portal:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 与 Grafana Stack 提供的工具互动的主要方式是访问 **Grafana 实例**。该实例提供可视化工具，用于查看由其他 Grafana 堆栈或其他连接工具收集的数据。要访问你的
    Grafana 实例，你可以点击 Cloud Portal 中的 **启动** 按钮：
- en: '![Figure 3.6 – Launching Grafana](img/B18277_figure_3.6.jpg)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.6 – 启动 Grafana](img/B18277_figure_3.6.jpg)'
- en: Figure 3.6 – Launching Grafana
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.6 – 启动 Grafana
- en: To access it more directly, you can use the direct URL based on the team name
    selected during account creation. For instance, our sample account has the URL
    `https://observabilitywithgraf``ana.grafana.net`.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更直接地访问，你可以使用基于帐户创建时选择的团队名称的直接 URL。例如，我们的示例账户的 URL 是 `https://observabilitywithgraf``ana.grafana.net`。
- en: 'Once you have accessed Grafana, you will be greeted with a home page that shows
    your current usage. Navigation is done using the menu available at the top left
    of the page:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你访问了 Grafana，你将看到一个主页，显示你当前的使用情况。导航是通过页面左上角的菜单进行的：
- en: '![Figure 3.7 – The main navigation panel in Grafana](img/B18277_figure_3.7.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.7 – Grafana 中的主要导航面板](img/B18277_figure_3.7.jpg)'
- en: Figure 3.7 – The main navigation panel in Grafana
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.7 – Grafana 中的主要导航面板
- en: Let’s talk through the different sections available in the menu shown in the
    preceding figure.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们逐一讲解前面图中显示的菜单中不同的部分。
- en: Dashboards and Starred dashboards
  id: totrans-81
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 仪表板与收藏的仪表板
- en: 'The **Dashboards** section allows you to create, import, organize, and tag
    dashboards in your Grafana installation. Under **Dashboards**, you can also access
    **Playlists**, **Snapshot**, **Library panels**, and **Reporting**:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '**仪表板**部分允许你在 Grafana 安装中创建、导入、组织和标记仪表板。在 **仪表板**下，你还可以访问 **播放列表**、**快照**、**库面板**
    和 **报告**：'
- en: The **Playlists** subsection lets you manage groups of dashboards that are displayed
    in a sequence, for instance, on TVs in an office.
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**播放列表**子部分让你管理按顺序显示的仪表板组，例如，在办公室的电视上。'
- en: The **Snapshot** tab gives you the ability to take a snapshot of a dashboard
    with the data to share. This will give the recipients the ability to explore the
    data much better than by sharing a simple screenshot.
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**快照**标签让你能够拍摄一个仪表盘的快照并分享数据。这将使接收者能够比共享简单的屏幕截图更好地探索数据。'
- en: '**Library panels** provides reusable panels that can be used in multiple dashboards
    to aid in offering a standardized UI.'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**库面板**提供了可重复使用的面板，可以在多个仪表盘中使用，以帮助提供标准化的UI。'
- en: Finally, **Reporting** allows you to automatically generate PDFs from any dashboard
    and send them to interested parties on a schedule.
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，**报告**功能允许你从任何仪表盘自动生成PDF并按预定计划发送给相关方。
- en: The **Starred** dashboards section lets you customize the UI by saving dashboards
    you frequently use at the top of the menu. We will explore using dashboards more
    fully in [*Chapter 8*](B18277_08.xhtml#_idTextAnchor172).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '**星标**仪表盘部分允许你通过将常用的仪表盘保存到菜单顶部来自定义界面。我们将在[*第8章*](B18277_08.xhtml#_idTextAnchor172)中更全面地探讨如何使用仪表盘。'
- en: Explore
  id: totrans-88
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 探索
- en: '**Explore** is the way to get direct access to the data that is connected to
    the Grafana instance. This is the foundation of building custom dashboards and
    exploring data to understand the current state of the system. We will look at
    this briefly later in this chapter in the section titled *Exploring telemetry
    from the demo application*, and in a lot more detail in *Chapters 4*, *5*, and
    *6*.'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '**探索**是直接访问连接到Grafana实例的数据的方式。这是构建自定义仪表盘并探索数据以理解系统当前状态的基础。我们将在本章后面标题为*从示例应用程序探索遥测数据*的部分简要讨论这一点，之后将在*第4章*、*第5章*和*第6章*中详细介绍。'
- en: Alerts & IRM
  id: totrans-90
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 警报与IRM
- en: 'The **Alerts & IRM** section contains Grafana’s **Alerting**, **OnCall**, and
    **Incident** systems for IRM, as well as machine learning capabilities and the
    SLO service. These can help with identifying anomalies in the system (for more
    details on this, you can refer to [*Chapter 9*](B18277_09.xhtml#_idTextAnchor183)):'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '**警报与IRM**部分包含了Grafana的**警报管理**、**值班**和**事件**系统用于IRM，还包括机器学习能力和SLO服务。这些功能可以帮助识别系统中的异常（有关详细信息，请参见[*第9章*](B18277_09.xhtml#_idTextAnchor183)）：'
- en: '![Figure 3.8 – Alerts & IRM](img/B18277_figure_3.8.jpg)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.8 – 警报与IRM](img/B18277_figure_3.8.jpg)'
- en: Figure 3.8 – Alerts & IRM
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.8 – 警报与IRM
- en: '**Alerting**, or Alertmanager, allows teams to manage rules for when an alert
    should be triggered. It also gives teams control over the method of notification
    used for the alert and whether there are any schedules for when to alert. Grafana
    **Alerting** is geared toward notifying an individual team of alerts in their
    system, and it has been battle-tested by many organizations.'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '**警报管理**（Alertmanager）允许团队管理触发警报的规则。它还允许团队控制警报通知的方式，并决定是否有任何预定的警报时间表。Grafana的**警报管理**旨在通知特定团队其系统中的警报，并且已经通过许多组织的实际使用进行了验证。'
- en: '**OnCall** and **Incident** form Grafana’s IRM toolkit. This gives organizations
    the ability to receive notifications from many monitoring systems and manage schedules
    and escalation chains, as well as giving high-level visibility of sent, acknowledged,
    resolved, and silenced alerts. The **Incident** section gives organizations the
    ability to start incidents. These follow predefined processes for involving the
    right people and communicating with stakeholders. Once the incident is initiated,
    Grafana can record key moments during the incident process ready for any post-incident
    processes. Both **OnCall** and **Incident** are aimed at organizations that need
    a central hub to manage the technical aspects of problem and incident management.
    [*Chapter 9*](B18277_09.xhtml#_idTextAnchor183) will explore these tools in greater
    detail and show you how to configure them.'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '**值班**和**事件**构成了Grafana的IRM工具包。它使组织能够接收来自多个监控系统的通知，管理排班和升级链，并提供关于已发送、已确认、已解决和已静默的警报的高级可视化。**事件**部分使组织能够启动事件处理。这些事件遵循预定义的流程，涉及正确的人员并与利益相关者进行沟通。一旦事件启动，Grafana可以记录事件过程中关键时刻的内容，以便后续的事件后处理。**值班**和**事件**旨在帮助需要集中管理技术方面的问题和事件管理的组织。[*第9章*](B18277_09.xhtml#_idTextAnchor183)将更详细地探讨这些工具并展示如何配置它们。'
- en: Performance testing
  id: totrans-96
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 性能测试
- en: The **Performance testing** area is where the k6 performance testing tool is
    integrated with the Grafana UI, allowing teams to manage tests and projects. k6
    allows your teams to use the same performance testing tools in the CI/CD pipeline
    as they use to test against production. k6 will be covered in [*Chapter 13*](B18277_13.xhtml#_idTextAnchor239).
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '**性能测试**区域是 k6 性能测试工具与 Grafana UI 集成的地方，允许团队管理测试和项目。k6 使团队能够在 CI/CD 流水线中使用与生产环境测试相同的性能测试工具。k6
    将在 [*第 13 章*](B18277_13.xhtml#_idTextAnchor239)中详细介绍。'
- en: Observability
  id: totrans-98
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 可观察性
- en: The **Observability** section brings together Kubernetes infrastructure and
    application monitoring, with synthetic tests used to simulate critical user journeys
    in your application alongside frontend **real user monitoring** (**RUM**) and
    **profiles** from Pyroscope. By combining these data sources, you gain an end-to-end
    view of the current performance of your products.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '**可观察性**部分将 Kubernetes 基础设施和应用监控整合在一起，并通过合成测试模拟应用中的关键用户旅程，同时结合前端 **真实用户监控**
    (**RUM**) 和 Pyroscope 的 **性能配置文件**。通过结合这些数据源，您可以获得对产品当前性能的端到端视图。'
- en: Connections
  id: totrans-100
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 连接
- en: 'The **Connections** section is an administrative area to set up and manage
    connections from Grafana to the 160+ data sources and infrastructure components
    that it can connect and show data from. Some examples of available connections
    are Elastisearch, Datadog, Splunk, AWS, Azure, cert-manager, GitHub, Ethereum,
    and Snowflake. The page to configure these connections is shown in the following
    figure:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '**连接**部分是一个管理区域，用于设置和管理 Grafana 与 160 多个数据源及基础设施组件之间的连接，这些数据源和组件可以连接并显示数据。一些可用连接的示例包括
    Elasticsearch、Datadog、Splunk、AWS、Azure、cert-manager、GitHub、Ethereum 和 Snowflake。配置这些连接的页面如下图所示：'
- en: '![Figure 3.9 – Connections screen](img/B18277_figure_3.9.jpg)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.9 – 连接屏幕](img/B18277_figure_3.9.jpg)'
- en: Figure 3.9 – Connections screen
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.9 – 连接屏幕
- en: Administration
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 管理
- en: 'The **Administration** panel allows for the management of many aspects of Grafana,
    from plugins and recorded queries to users, authentication, teams, and service
    accounts:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '**管理**面板允许管理 Grafana 的许多方面，从插件和已记录查询到用户、身份验证、团队和服务帐户：'
- en: '![Figure 3.10 – Administration panel](img/B18277_figure_3.10.jpg)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.10 – 管理面板](img/B18277_figure_3.10.jpg)'
- en: Figure 3.10 – Administration panel
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.10 – 管理面板
- en: Now that we’ve explored the Grafana Cloud Portal, let’s prepare your local environment
    to send data.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经探索了 Grafana Cloud 门户，接下来让我们准备本地环境以发送数据。
- en: Installing the prerequisite tools
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装前提工具
- en: Grafana is much more exciting with data! To build a realistic view of how Grafana
    works and can help your organization, we have chosen to install the OpenTelemetry
    demo application. This is a demonstration web store that sells telescopes and
    other observational equipment. We’ll take you through the installation process
    to get this running locally on your machine.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: Grafana 与数据结合时更加精彩！为了构建一个真实的 Grafana 工作原理视图，并帮助您的组织，我们选择安装 OpenTelemetry 演示应用程序。这是一个销售望远镜和其他观测设备的演示网店。我们将带您完成安装过程，帮助您在本地计算机上运行该应用程序。
- en: But first, there are a few prerequisites that your local environment has, and
    they depend on the operating system you use.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 但首先，您的本地环境需要具备一些前提条件，这些条件取决于您使用的操作系统。
- en: 'In this section, we will explain how to install the following:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将解释如何安装以下内容：
- en: 'Tools based on your operating system:'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于您的操作系统的工具：
- en: '**Windows Subsystem for Linux version** **2** (**WSL2**)'
  id: totrans-114
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Windows 子系统 Linux 版本** **2** (**WSL2**)'
- en: macOS Homebrew
  id: totrans-115
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: macOS Homebrew
- en: Docker or Podman
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Docker 或 Podman
- en: A single-node Kubernetes cluster
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单节点 Kubernetes 集群
- en: Helm
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Helm
- en: Installing WSL2
  id: totrans-119
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 WSL2
- en: 'WSL is a way of running a Linux filesystem and tools directly on Windows. This
    is used to give a standard set of commands and tools across operating systems.
    It is possible to run these systems outside of WSL, but the processes are much
    easier using WSL. Follow these steps to set up WSL2:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: WSL 是一种直接在 Windows 上运行 Linux 文件系统和工具的方式。它用于在不同操作系统之间提供一套标准的命令和工具。虽然也可以在 WSL
    外运行这些系统，但使用 WSL 会简化许多流程。请按照以下步骤设置 WSL2：
- en: Open a PowerShell terminal or Windows Command Prompt as an administrator.
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以管理员身份打开 PowerShell 终端或 Windows 命令提示符。
- en: 'Run the following command to install WSL2:'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令以安装 WSL2：
- en: '[PRE0]'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This will install the Ubuntu distribution of Linux.
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这将安装 Ubuntu 版本的 Linux。
- en: You should see a message that Ubuntu is installing and then you will be prompted
    for a new UNIX username. If you see any other message, you may have a version
    of WSL installed already; please refer to the Microsoft website to address this.
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你应该看到一个信息，表示 Ubuntu 正在安装，随后会提示输入新的 UNIX 用户名。如果看到任何其他信息，可能你已经安装了某个版本的 WSL；请参考微软官网解决这个问题。
- en: Create a new user for your Ubuntu installation by entering a username and password.
    These do not need to match your Windows username and password.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为你的 Ubuntu 安装创建一个新的用户，输入用户名和密码。这个用户名和密码无需与 Windows 的用户名和密码相匹配。
- en: 'Upgrade packages by running the following command:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过运行以下命令来升级软件包：
- en: '[PRE1]'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'It is recommended to install the Windows Terminal to use WSL. This can be downloaded
    from the Microsoft Store: https://learn[.microsoft.com/en-us/windows/terminal/install](http://.microsoft.com/en-us/windows/terminal/install).'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 推荐安装 Windows Terminal 来使用 WSL。你可以从微软商店下载： https://learn[.microsoft.com/en-us/windows/terminal/install](http://.microsoft.com/en-us/windows/terminal/install)。
- en: More detailed instructions on how to complete this installation process and
    troubleshoot any issues that may arise can be found at [https://learn.microsoft.com/en-us/windows/wsl/install](https://learn.microsoft.com/en-us/windows/wsl/install).
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 更详细的安装说明以及如何解决可能出现的任何问题，请参考 [https://learn.microsoft.com/en-us/windows/wsl/install](https://learn.microsoft.com/en-us/windows/wsl/install)。
- en: Installing Homebrew
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 Homebrew
- en: '**Homebrew** is a package management tool for macOS. To install it on your
    system, follow these steps:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '**Homebrew** 是 macOS 的一个包管理工具。要在系统上安装它，请按照以下步骤操作：'
- en: Open a terminal window.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开终端窗口。
- en: 'Run the following command to install Homebrew:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令安装 Homebrew：
- en: '[PRE2]'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: $ brew install wget
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $ brew install wget
- en: '[PRE3]'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Detailed instructions on this installation can be found at [https://brew.sh/](https://brew.sh/).
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 该安装的详细说明可以在 [https://brew.sh/](https://brew.sh/) 找到。
- en: Installing container orchestration tools
  id: totrans-139
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装容器编排工具
- en: '**Docker** and **Podman** are both **container orchestration tools**. Docker
    has been the de facto standard for about a decade. Podman is a newer tool. It
    was first released in 2018\. The major functions of Docker are also offered in
    Podman, but support and information may be more difficult to find.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '**Docker** 和 **Podman** 都是 **容器编排工具**。Docker 已经是事实上的标准约十年。Podman 是一个较新的工具，首次发布于
    2018 年。Docker 的主要功能也在 Podman 中提供，但支持和信息可能更难找到。'
- en: In 2021, Docker made licensing changes that became fully effective in January
    2023\. These licensing changes may impact readers using devices belonging to businesses.
    We will only provide instructions for Docker, but we will highlight the potential
    issues, so you are aware of them. The aim of providing a container orchestration
    tool is to run a single-node Kubernetes cluster on that tool.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 在 2021 年，Docker 做出了许可更改，这些更改在 2023 年 1 月正式生效。这些许可更改可能会影响使用企业设备的读者。我们将只提供 Docker
    的安装说明，但我们会指出潜在的问题，以便你了解。提供容器编排工具的目的是在该工具上运行单节点 Kubernetes 集群。
- en: Installing Docker Desktop
  id: totrans-142
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 Docker Desktop
- en: The following sections briefly describe how **Docker Desktop** can be installed
    on Windows, macOS, and Linux. Let’s look at the Windows installation process first.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 以下部分简要描述了如何在 Windows、macOS 和 Linux 上安装 **Docker Desktop**。我们首先来看一下 Windows 安装过程。
- en: Windows installation
  id: totrans-144
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Windows 安装
- en: 'To install Docker Desktop on Windows, do the following:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 Windows 上安装 Docker Desktop，请执行以下操作：
- en: Go to [https://docs.docker.com/desktop/install/windows-install/](https://docs.docker.com/desktop/install/windows-install/)
    and download the latest Docker installer `.``exe` file.
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问 [https://docs.docker.com/desktop/install/windows-install/](https://docs.docker.com/desktop/install/windows-install/)
    并下载最新的 Docker 安装程序 `.``exe` 文件。
- en: Run the installation package. You will be prompted to enable WSL2\. Select **Yes**.
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行安装包。系统会提示你启用 WSL2，选择 **是**。
- en: After installation, start Docker Desktop.
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装完成后，启动 Docker Desktop。
- en: Navigate to **Settings** | **General**. Select the **Use WSL2 based** **engine**
    checkbox.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 **设置** | **常规**。勾选 **使用基于 WSL2 的** **引擎** 复选框。
- en: Select **Apply &** **Restart**.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 **应用并** **重启**。
- en: 'In your WSL terminal, validate the Docker installation by running the following
    command:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你的 WSL 终端中，通过运行以下命令验证 Docker 安装：
- en: '[PRE4]'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: macOS installation
  id: totrans-153
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: macOS 安装
- en: 'For the macOS installation of Docker Desktop, do the following:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 macOS 上的 Docker Desktop 安装，请执行以下操作：
- en: Go to [https://docs.docker.com/desktop/install/mac-install/](https://docs.docker.com/desktop/install/mac-install/)
    and download the latest Docker installer for your Mac.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问 [https://docs.docker.com/desktop/install/mac-install/](https://docs.docker.com/desktop/install/mac-install/)
    并下载适用于你 Mac 的最新 Docker 安装程序。
- en: Run the installation package.
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行安装包。
- en: 'In your terminal, validate the Docker installation by running the following:'
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你的终端中，通过运行以下命令验证 Docker 安装：
- en: '[PRE5]'
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Linux installation
  id: totrans-159
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Linux 安装
- en: Linux users may consider using Podman Desktop as it has better native support
    for Linux environments. Installation instructions are available at [https://podman-desktop.io/docs/Installation/linux-install](https://podman-desktop.io/docs/Installation/linux-install).
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 用户可以考虑使用 Podman Desktop，因为它对 Linux 环境有更好的原生支持。安装说明可以在 [https://podman-desktop.io/docs/Installation/linux-install](https://podman-desktop.io/docs/Installation/linux-install)
    找到。
- en: 'However, if you do wish to use Docker, please follow the installation guide
    provided as the process will vary by distribution: https://docs.docker.com/desktop/install/linux-install/.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，如果你确实希望使用 Docker，请按照提供的安装指南操作，因为安装过程会因发行版而有所不同：https://docs.docker.com/desktop/install/linux-install/。
- en: The full documentation can be found at https://docs.docker.com/desktop/.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 完整的文档可以在 https://docs.docker.com/desktop/ 找到。
- en: With a base system that now supports containerization, let’s set up a single-node
    Kubernetes cluster. This will be used to easily and repeatably install the OpenTelemetry
    demo application.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个支持容器化的基础系统上，让我们设置一个单节点 Kubernetes 集群。这将用于轻松且可重复地安装 OpenTelemetry 示例应用程序。
- en: Installing a single-node Kubernetes cluster
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装单节点 Kubernetes 集群
- en: 'There are a few different tools to run local Kubernetes clusters, including
    **Kubernetes in Docker** (**KinD**), **Minikube**, and **MicroK8s**. However,
    we have chosen to use **k3d** due to the ease of installation across operating
    systems. Follow these steps:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种不同的工具可以运行本地 Kubernetes 集群，包括**Kubernetes in Docker**（**KinD**）、**Minikube**和**MicroK8s**。然而，我们选择使用**k3d**，因为它在不同操作系统上的安装非常简便。请按照以下步骤操作：
- en: 'Install k3d using the following command:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令安装 k3d：
- en: '[PRE6]'
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Full details can be found at [https://k3d.io/stable/](https://k3d.io/stable/).
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 完整的详情请参见[https://k3d.io/stable/](https://k3d.io/stable/)。
- en: 'Create a k3d cluster:'
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个 k3d 集群：
- en: '[PRE7]'
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Validate the cluster status:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 验证集群状态：
- en: '[PRE8]'
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: With a Kubernetes cluster installed, we now need a way to install applications
    easily. OpenTelemetry provides Helm charts, which allow us to deploy applications
    to Kubernetes; we will install Helm to use these.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 安装了 Kubernetes 集群后，我们现在需要一种便捷的方式来安装应用程序。OpenTelemetry 提供了 Helm 图表，允许我们将应用程序部署到
    Kubernetes 上；我们将安装 Helm 来使用这些图表。
- en: Installing Helm
  id: totrans-174
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 Helm
- en: '**Helm** is a package manager for Kubernetes clusters. A lot of infrastructure-level
    components are provided as Helm charts for installation, and OpenTelemetry is
    no exception. To install Helm, follow these steps:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: '**Helm** 是 Kubernetes 集群的包管理器。许多基础设施级别的组件都以 Helm 图表形式提供以供安装，OpenTelemetry 也不例外。要安装
    Helm，请按照以下步骤操作：'
- en: 'Install Helm using the following command (details can be found at [https://helm.sh/docs/intro/install/](https://helm.sh/docs/intro/install/)):'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令安装 Helm（详细信息请参见[https://helm.sh/docs/intro/install/](https://helm.sh/docs/intro/install/)）：
- en: '[PRE9]'
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Validate the Helm installation:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 验证 Helm 安装：
- en: '[PRE10]'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: With our local system ready to start running applications, we can now install
    the demo application provided by OpenTelemetry.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们的本地系统已经准备好运行应用程序时，我们可以安装 OpenTelemetry 提供的示例应用程序。
- en: Installing the OpenTelemetry Demo application
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 OpenTelemetry 示例应用程序
- en: As we need to send data from our local machine to our Grafana Cloud instance,
    we need to provide some credentials and tell our local machine where to send data.
    Before we install the demo application, we need to set up access tokens so we
    can send data to our Grafana Cloud stack.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们需要将数据从本地机器发送到 Grafana Cloud 实例，我们需要提供一些凭据，并告诉本地机器将数据发送到哪里。在安装示例应用程序之前，我们需要设置访问令牌，以便将数据发送到我们的
    Grafana Cloud 堆栈。
- en: Setting up access credentials
  id: totrans-183
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置访问凭据
- en: 'Access tokens allow the Open Telemetry application to send data securely to
    your Grafana Cloud stack. To set up an access token, we need to do the following:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 访问令牌允许 OpenTelemetry 应用程序将数据安全地发送到你的 Grafana Cloud 堆栈。要设置访问令牌，我们需要执行以下步骤：
- en: In the Grafana Cloud Portal, select **Access Policies** in the **Security**
    section.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Grafana Cloud 门户中，选择**Security**部分中的**Access Policies**。
- en: Click **Create** **access policy**.
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**Create** **access policy**。
- en: Choose a name and display name, and set **Realm** to **All Stacks**.
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择一个名称和显示名称，并将**Realm**设置为**All Stacks**。
- en: Set the **Write** scope for metrics, logs, and traces and click **Create**.
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置**Write**范围，用于指标、日志和跟踪，然后点击**Create**。
- en: On the new access policy, click **Add token**.
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在新的访问策略中，点击**Add token**。
- en: Give the token a name and set the expiration date. Click **Create**.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 给令牌命名并设置过期日期。点击**Create**。
- en: Finally, copy the token and save it securely.
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，复制令牌并安全保存。
- en: Now that we’ve created our token, let’s download the GitHub repository for this
    book and set it up.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经创建了令牌，接下来让我们下载本书的 GitHub 仓库并进行设置。
- en: Downloading the repository and adding credentials and endpoints
  id: totrans-193
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 下载仓库并添加凭证和端点。
- en: 'The Git repository contains configuration files for each of the chapters that
    will use live data. Downloading the repository is simple. Go to the Git repository:
    [https://github.com/PacktPublishing/Observability-with-Grafana](https://github.com/PacktPublishing/Observability-with-Grafana).
    Click on the green **Code** button and follow the instructions to clone the repository.
    Once downloaded, the repository should look like this:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: Git 仓库包含每一章节使用实时数据的配置文件。下载这个仓库很简单。访问 Git 仓库：[https://github.com/PacktPublishing/Observability-with-Grafana](https://github.com/PacktPublishing/Observability-with-Grafana)。点击绿色的
    **代码** 按钮，并按照提示克隆仓库。下载后，仓库应该像这样：
- en: '![Figure 3.11 – Observability with Grafana repo](img/B18277_figure_3.11.jpg)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.11 – 使用 Grafana 的可观测性仓库](img/B18277_figure_3.11.jpg)'
- en: Figure 3.11 – Observability with Grafana repo
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.11 – 使用 Grafana 的可观测性仓库
- en: 'To set up the demo application, we need to add the token we saved in the previous
    section and the correct endpoints in the `OTEL-Creds.yaml` file. The information
    you will need is the following:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 为了设置演示应用，我们需要将之前保存的令牌和正确的端点添加到 `OTEL-Creds.yaml` 文件中。你需要的信息如下：
- en: '**Password**: This is the token you saved earlier and is shared by each telemetry
    type'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码**：这是你之前保存的令牌，每种遥测类型共享此令牌。'
- en: '**Username**: This is specific to each telemetry type'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户名**：这对于每种遥测类型是特定的。'
- en: '**Endpoint**: This is also specific to each telemetry type'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**端点**：这对于每种遥测类型是特定的。'
- en: 'Let’s take Loki as an example of how to get this information. In the Grafana
    Cloud Portal, do the following to get the correct information:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 以 Loki 为例，以下是在 Grafana Cloud Portal 中获取正确信息的步骤：
- en: 'Click on the **Send Logs** button in the Loki box. At the top of the page is
    an information box that looks like this:'
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 Loki 框中的 **发送日志** 按钮。页面顶部有一个信息框，样式如下：
- en: '![Figure 3.12 – Grafana Data Source settings](img/B18277_figure_3.12.jpg)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.12 – Grafana 数据源设置](img/B18277_figure_3.12.jpg)'
- en: Figure 3.12 – Grafana Data Source settings
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.12 – Grafana 数据源设置
- en: The **User** field is used as the username.
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**用户** 字段用于输入用户名。'
- en: The `/loki/api/v1/push` to the end of the URL
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 `/loki/api/v1/push` 添加到 URL 的末尾。
- en: For metrics, add `/api/prom/push` to the end of the URL
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于指标，在 URL 末尾添加 `/api/prom/push`。
- en: For traces, remove `https://` and add `:443` to the end of the URL
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于追踪信息，去掉 `https://` 并在 URL 末尾添加 `:443`。
- en: Add this information into the relevant fields in the `OTEL-Creds.yaml` file.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将这些信息添加到 `OTEL-Creds.yaml` 文件中相应的字段。
- en: With Loki completed, we can follow the same process for Prometheus (click **Send
    Metrics**) and Tempo (click **Send Traces**).
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: Loki 配置完成后，我们可以按照相同的过程配置 Prometheus（点击 **发送指标**）和 Tempo（点击 **发送追踪**）。
- en: These instructions are repeated and expanded on in the `README.md` file in the
    repository. With the credentials saved, we are now ready to deploy OpenTelemetry.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 这些步骤在仓库中的 `README.md` 文件中有重复并扩展。凭证保存后，我们现在准备部署 OpenTelemetry。
- en: Installing the OpenTelemetry Collector
  id: totrans-212
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 OpenTelemetry 收集器。
- en: 'With the credentials file updated, we can now install the Helm chart for the
    OpenTelemetry Collector. This is the component that will collect and transmit
    the data produced by the demo application. To proceed with the installation, perform
    the following steps:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 更新凭证文件后，我们可以安装 OpenTelemetry 收集器的 Helm 图表。这是收集和传输演示应用产生的数据的组件。继续安装的步骤如下：
- en: 'Add the OpenTelemetry repository:'
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加 OpenTelemetry 仓库：
- en: '[PRE11]'
  id: totrans-215
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Install the collector with Helm:'
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 Helm 安装收集器：
- en: '[PRE12]'
  id: totrans-217
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Validate that the installation was successful:'
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 验证安装是否成功：
- en: '[PRE13]'
  id: totrans-219
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: We are now ready to install the OpenTelemetry demo application.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在准备安装 OpenTelemetry 演示应用。
- en: Installing the OpenTelemetry demo application
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 OpenTelemetry 演示应用。
- en: 'The OpenTelemetry demo application is an example web store that sells telescopes
    and other tools to observe the universe. To install this demo application, follow
    these steps:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: OpenTelemetry 演示应用是一个示例网店，出售望远镜及其他观测宇宙的工具。要安装此演示应用，按照以下步骤操作：
- en: 'Install the demo application with Helm:'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 Helm 安装演示应用：
- en: '[PRE14]'
  id: totrans-224
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Validate that the installation was successful. This process may take a few
    minutes on the first install:'
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 验证安装是否成功。首次安装此过程可能需要几分钟：
- en: '[PRE15]'
  id: totrans-226
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: $ kubectl port-forward svc/owg-demo-frontendproxy 8080:8080 &
  id: totrans-227
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $ kubectl port-forward svc/owg-demo-frontendproxy 8080:8080 &
- en: '[PRE16]'
  id: totrans-228
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Open a port for browser spans:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-230
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Check you can access the OpenTelemetry demo application on http://localhost:8080:'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 3.13 – OpenTelemetry demo application](img/B18277_figure_3.13.jpg)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
- en: Figure 3.13 – OpenTelemetry demo application
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
- en: Explore the OpenTelemetry demo application to generate some data. Take some
    time to add items to your cart and purchase them. While a load generator is part
    of the installation, it is worth getting familiar with the application as it will
    help put the telemetry generated in context.
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now that you have an application that produces data, let’s start exploring that
    data.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
- en: Exploring telemetry from the demo application
  id: totrans-236
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Assuming the installation was successful, you will have data flowing into your
    Grafana instance. To view these, head to your Grafana instance, either from your
    team URL or by clicking **Launch** in the Cloud Portal.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
- en: 'On the front page, you should see information detailing your current or billable
    usage of logs, metrics, and traces. If everything is correct, these should all
    be greater than 0\. It may take a few minutes for this to show up completely,
    sometimes up to an hour:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 3.14 – Grafana Cloud usage](img/B18277_figure_3.14.jpg)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
- en: Figure 3.14 – Grafana Cloud usage
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
- en: If you don’t see usage for metrics, logs, and traces, you might need to troubleshoot.
    We have included some tips at the end of this chapter.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on the menu and select **Explore**. This will take you to the page to
    run queries on the telemetry from the demo application. The highest-level concept
    in Grafana is a **data source**. These are selectable just below the main menu.
    Each data source is a connection from the Grafana instance to either a component
    in the Grafana Stack or a connection to another tool. Each data source is self-contained.
    The data source menu can be seen in the following figure:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 3.15 – Data source menu](img/B18277_figure_3.15.jpg)'
  id: totrans-244
  prefs: []
  type: TYPE_IMG
- en: Figure 3.15 – Data source menu
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
- en: You will see that there are data sources for **logs**, **prom** (Prometheus
    metrics), and **traces**. There are other data sources, but for this chapter,
    we will only concentrate on these three, as they are the data sources related
    to the Grafana Stack we have provisioned.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
- en: These data sources relate to our Loki, Mimir, and Tempo components, used to
    collect logs, metrics, and traces, respectively. We’ll discuss these next.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
- en: Logs in Loki
  id: totrans-248
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Loki stores the log data produced by the demo application. Let’s have a quick
    look at the interface for a Loki data source and see some of the log data the
    demo application is producing.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
- en: 'Select the `grafanacloud-<team name>-logs` data source. In **Label filters**,
    add **exporter = OTLP** and click **Run query**. You should now see a screen like
    this:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18277_figure_3.16.jpg)'
  id: totrans-251
  prefs: []
  type: TYPE_IMG
- en: Fig 3.16 – Reviewing logs
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
- en: 'The upper area of the screen is where you enter and modify your query. In the
    middle of the screen, you will see the volume of logs returned by your search
    over time. This can provide a lot of contextual information at a glance. The lower
    part of the screen displays the results of your query:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 屏幕的上方区域是您输入和修改查询的地方。在屏幕中间，您将看到通过搜索返回的日志量随时间的变化。这可以一眼提供大量上下文信息。屏幕的下部显示您的查询结果：
- en: '![Figure 3.17 Query panel details](img/B18277_figure_3.17.jpg)'
  id: totrans-254
  prefs: []
  type: TYPE_IMG
  zh: '![图3.17 查询面板详情](img/B18277_figure_3.17.jpg)'
- en: Figure 3.17 Query panel details
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.17 查询面板详情
- en: 'Let’s break the preceding screenshot down into its components:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们将前面的截图分解成各个组件：
- en: You can select the time range and add the query to various tools by clicking
    on **Add**.
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以选择时间范围并通过点击**添加**将查询添加到各种工具中。
- en: Using the buttons at the bottom of this section, you can use **Add query** to
    produce a more complex analysis of the data. **Query history** lets you review
    your query history. **Query inspector** helps to understand how your query is
    performing.
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用本节底部的按钮，您可以通过**添加查询**进行更复杂的数据分析。**查询历史**让您查看查询历史。**查询检查器**帮助您了解查询的执行情况。
- en: The **Builder** or **Code** selector allows you to switch between the UI-focused
    query builder you see by default and a query language entry box, which is useful
    for directly entering queries.
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**构建器**或**代码**选择器允许您在默认显示的以UI为中心的查询构建器和查询语言输入框之间切换，这对于直接输入查询非常有用。'
- en: The **Kick start your query** button will give you some starter queries and
    the **Label browser** button will let you explore the labels currently available
    in your collected log data.
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**启动您的查询**按钮将为您提供一些初始查询，**标签浏览器**按钮将让您浏览当前在收集的日志数据中可用的标签。'
- en: Finally, the **Explain query** slider will give you a detailed explanation of
    each step of the query you currently have.
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，**解释查询**滑块将为您提供有关当前查询每个步骤的详细解释。
- en: 'Let’s take a look at the components in the query result panel:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看查询结果面板中的组件：
- en: '![Figure 3.18 – Query result panel details](img/B18277_figure_3.18.jpg)'
  id: totrans-263
  prefs: []
  type: TYPE_IMG
  zh: '![图3.18 – 查询结果面板详情](img/B18277_figure_3.18.jpg)'
- en: Figure 3.18 – Query result panel details
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.18 – 查询结果面板详情
- en: 'These components can be used as follows:'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 这些组件可以按如下方式使用：
- en: You can customize the display of this data to show the timestamp, highlight
    any unique labels, wrap lines, or prettify JSON.
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以自定义数据显示时间戳，突出显示任何独特的标签，换行或美化JSON。
- en: You can also apply deduplication.
  id: totrans-267
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您还可以应用去重。
- en: You can choose to view the oldest or newest log events first.
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以选择先查看最旧或最新的日志事件。
- en: Finally, you can download the data as `.txt` or `.json`.
  id: totrans-269
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，您可以将数据下载为`.txt`或`.json`格式。
- en: We will look at these features in more depth in [*Chapter 4*](B18277_04.xhtml#_idTextAnchor092)
    and introduce the LogQL query language.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在[*第4章*](B18277_04.xhtml#_idTextAnchor092)中更深入地探讨这些功能，并介绍LogQL查询语言。
- en: Now that you have familiarized yourself with the query panels for logs in a
    Loki data source, let’s see how querying metrics from a Mimir data source is very
    similar.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经熟悉了Loki数据源中的日志查询面板，让我们看看从Mimir数据源查询度量数据是如何相似的。
- en: Metrics in Prometheus/Mimir
  id: totrans-272
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Prometheus/Mimir中的度量数据
- en: Grafana uses similar repeating blocks for querying data. In this section, we
    will explore how to query metrics.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: Grafana使用类似的重复块来查询数据。在本节中，我们将探讨如何查询度量数据。
- en: 'Select the **grafanacloud-<team name>-prom** data source. In the **Metric**
    dropdown, select **kafka_consumer_commit_rate** and leave **Label filters** blank.
    Click on **Run query** and you should see a screen like this:'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 选择**grafanacloud-<团队名称>-prom**数据源。在**度量**下拉框中选择**kafka_consumer_commit_rate**，并将**标签过滤器**留空。点击**运行查询**，您应该会看到像这样的屏幕：
- en: '![Figure 3.19 – Kafka consumer commit rate](img/B18277_figure_3.19.jpg)'
  id: totrans-275
  prefs: []
  type: TYPE_IMG
  zh: '![图3.19 – Kafka消费者提交速率](img/B18277_figure_3.19.jpg)'
- en: Figure 3.19 – Kafka consumer commit rate
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.19 – Kafka消费者提交速率
- en: Similar to Loki, we have a query section at the top, although the structure
    is slightly different. The major difference is the **Options** section, which
    controls how the data is presented. **Legend** manages the graph’s legend display.
    The **Format** option allows you to select between a **Time series** representation
    (the graph shown in the preceding screenshot); a **Table** representation, showing
    each value of each time series; and a **Heatmap** representation. The **Type**
    selector allows you to select either a range of time, the latest instant of each
    time series, or both. The **Exemplars** slider will show trace data that is linked
    to each metric.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 类似于 Loki，我们在顶部有一个查询部分，尽管结构略有不同。主要的区别在于 **选项** 部分，它控制数据的展示方式。**图例** 管理图表的图例显示。**格式**
    选项允许你选择 **时间序列** 表示（如前面截图中显示的图表）；**表格** 表示，显示每个时间序列的每个值；以及 **热图** 表示。**类型** 选择器允许你选择时间范围、每个时间序列的最新时刻或两者。**示例**
    滑块将显示与每个度量相关联的追踪数据。
- en: The bottom section shows the data, with options to display it in different ways.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 底部部分显示了数据，并提供了以不同方式展示数据的选项。
- en: 'To see how Grafana represents multiple plots, from the **Metric** dropdown,
    select **process_runtime_jvm_cpu_utilization_ratio** and click **Run query**.
    You should see a chart like this:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看 Grafana 如何表示多个图表，从 **Metric** 下拉菜单中选择 **process_runtime_jvm_cpu_utilization_ratio**，然后点击
    **运行查询**。你应该会看到一个像这样的图表：
- en: '![Figure 3.20 – JVM CPU utilization](img/B18277_figure_3.20.jpg)'
  id: totrans-280
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.20 – JVM CPU 使用率](img/B18277_figure_3.20.jpg)'
- en: Figure 3.20 – JVM CPU utilization
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.20 – JVM CPU 使用率
- en: Each of the plotted lines in the chart in the preceding screenshot represents
    the CPU utilization of a different service running in the demo application. We
    will look at these features in more depth in [*Chapter 5*](B18277_05.xhtml#_idTextAnchor106)
    and introduce the PromQL query language.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 前面截图中绘制的每一条线都代表了演示应用中不同服务的 CPU 使用率。我们将在[*第五章*](B18277_05.xhtml#_idTextAnchor106)中更深入地探讨这些功能，并介绍
    PromQL 查询语言。
- en: A Tempo trace data source is very similar to a Loki log data source and a Mimir
    metric data source. Let’s look at this now.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: Tempo 追踪数据源非常类似于 Loki 日志数据源和 Mimir 度量数据源。现在让我们来看一下。
- en: Traces in Tempo
  id: totrans-284
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Tempo 中的追踪
- en: Traces use a little bit more querying, as we have to find and select an individual
    trace, and then show the spans in the trace in detail.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 追踪需要更多的查询操作，因为我们必须找到并选择一个单独的追踪记录，然后详细展示该追踪中的跨度。
- en: 'Select the **grafanacloud-<team name>-traces** data source. For **Query type**,
    choose **Search**, for **Service Name**, select **checkoutservice**, and click
    **Run query**. You should see a screen like this:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 选择 **grafanacloud-<team name>-traces** 数据源。对于 **查询类型**，选择 **搜索**，对于 **服务名称**，选择
    **checkoutservice**，然后点击 **运行查询**。你应该看到像这样的屏幕：
- en: '![Figure 3.21 – Selecting a trace](img/B18277_figure_3.21.jpg)'
  id: totrans-287
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.21 – 选择一个追踪](img/B18277_figure_3.21.jpg)'
- en: Figure 3.21 – Selecting a trace
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.21 – 选择一个追踪
- en: 'Click on one of the **Trace ID** links and you will see a screen like this:'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 点击一个 **Trace ID** 链接，你会看到像这样的屏幕：
- en: '![Figure 3.22 – Trace view](img/B18277_figure_3.22.jpg)'
  id: totrans-290
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.22 – 追踪视图](img/B18277_figure_3.22.jpg)'
- en: Figure 3.22 – Trace view
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.22 – 追踪视图
- en: This view shows the split view that Grafana offers. This can be accessed from
    any data source and can provide the ability to use linked data points to move
    between logs, metrics, and traces to see the same point in time or event in each
    of the telemetry types. If you select the bar between the panels, indicated by
    the number **1** in the preceding screenshot, you can make the trace view bigger
    by clicking and dragging.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 这个视图展示了 Grafana 提供的分屏视图。可以从任何数据源访问此视图，并提供通过链接的数据点在日志、度量和追踪之间切换的能力，以便查看每种遥测类型中相同时间点或事件。如果你选择面板之间的条形，如前面截图中所示的数字
    **1**，可以通过点击并拖动来放大追踪视图。
- en: Looking through the trace, each line represents a span with information on which
    service was involved alongside specific information from that service. For example,
    **checkoutservice** will show you the count of items in the cart and the shipping
    amount. The bars with each span show the total time that span took and are stacked
    to represent the relative start and end times of the span. You might see that
    **productcatalogueservice** takes up a significant portion of the time in the
    transaction in *Figure 3**.21*.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 查看追踪记录时，每一行代表一个跨度，显示了涉及的服务以及该服务的具体信息。例如，**checkoutservice** 会显示购物车中的商品数量和运费。每个跨度上的条形显示了该跨度所用的总时间，并以堆叠的方式表示跨度的相对开始和结束时间。你可能会看到
    **productcatalogueservice** 在交易中占用了大量时间，如*图 3.21*所示。
- en: Adding your own applications
  id: totrans-294
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 添加你自己的应用程序
- en: It is possible to add your own application to this demo installation. The OpenTelemetry
    Collector has been deployed with receivers available for OTLP-formatted data on
    port `4317` for gRPC data and `4318` for HTTP(s) data. To deploy your application,
    it will need to be packaged as a container and then just follow a standard deployment
    mechanism for a Kubernetes deployment. Please do note that k3d is opinionated
    and by default uses Flannel and Traefik for networking and ingress, respectively.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以将自己的应用程序添加到此演示安装中。OpenTelemetry Collector已经部署，接收器可用于OTLP格式的数据，gRPC数据使用端口`4317`，HTTP(s)数据使用端口`4318`。要部署你的应用程序，需要将其打包为容器，并按照Kubernetes的标准部署机制进行部署。请注意，k3d有自己的约定，默认使用Flannel进行网络配置，使用Traefik进行入口控制。
- en: Now that we’ve understood this demo application, let’s look at some troubleshooting
    tips that will help you if you’re facing any issues while setting it up or using
    it.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了这个演示应用程序，让我们来看一些排查问题的技巧，这些技巧会帮助你在设置或使用时遇到问题时解决它们。
- en: Troubleshooting your OpenTelemetry Demo installation
  id: totrans-297
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 排查你的OpenTelemetry演示安装问题
- en: There are various things that could go wrong while using this application, so
    this section is not necessarily exhaustive. We will assume that all the prerequisite
    tools were installed correctly.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用此应用程序时可能会发生各种问题，因此本节内容未必涵盖所有情况。我们假设所有先决条件工具已正确安装。
- en: Let’s first take a look at the correct formatting of Grafana credentials.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先看看Grafana凭证的正确格式。
- en: Checking Grafana credentials
  id: totrans-300
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检查Grafana凭证
- en: If the OpenTelemetry Collector is giving authentication errors, or you are not
    receiving data from it, it is likely that the credentials are not formatted correctly.
    These details are entered into the `OTEL-Creds.yaml` file from this book’s Git
    repository.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 如果OpenTelemetry Collector出现身份验证错误，或者未收到数据，可能是凭证格式不正确。这些详细信息需要从本书的Git仓库中的`OTEL-Creds.yaml`文件中输入。
- en: 'The Grafana credentials should be formed like this:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: Grafana凭证应按照以下格式：
- en: '**Username**: Number, typically six digits.'
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户名**：数字，通常为六位数字。'
- en: '**Password**: API token, which is a long string of letters and numbers. When
    troubleshooting the token there are some important considerations:'
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码**：API令牌，这是一个由字母和数字组成的长字符串。在排查令牌问题时有一些重要的注意事项：'
- en: The same token can be shared by all the exporters.
  id: totrans-305
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 相同的令牌可以被所有导出器共享。
- en: The **Access policy** associated with the API token needs to be able to write
    logs, metrics and traces. This can be checked in the Grafana Cloud portal.
  id: totrans-306
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与API令牌关联的**访问策略**需要具备写入日志、指标和追踪的权限。可以在Grafana Cloud门户中检查这一点。
- en: '`loki`: `https://logs-prod-006.grafana.net/loki/api/v1/push`'
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`loki`：`https://logs-prod-006.grafana.net/loki/api/v1/push`'
- en: '`prometheusremotewrite`: `https://prometheus-prod-13-prod-us-east-0.grafana.net/api/prom/push`'
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`prometheusremotewrite`：`https://prometheus-prod-13-prod-us-east-0.grafana.net/api/prom/push`'
- en: '`otlp` (`tempo`): `tempo-prod-04-prod-us-east-0.grafana.net:443`'
  id: totrans-309
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`otlp`（`tempo`）：`tempo-prod-04-prod-us-east-0.grafana.net:443`'
- en: Important note
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: The OTLP endpoint for Tempo is different from the others.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: Tempo的OTLP端点与其他端点不同。
- en: 'If you notice that you have made a mistake, you will need to use `helm upgrade`
    to deploy the changes you make to the `OTEL-Creds.yaml` file:'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你发现自己犯了错误，需要使用`helm upgrade`将对`OTEL-Creds.yaml`文件所做的更改部署到系统中：
- en: '[PRE18]'
  id: totrans-313
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: $ kubectl get pods --selector=app.kubernetes.io/instance=owg
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: $ kubectl get pods --selector=app.kubernetes.io/instance=owg
- en: NAME                              READY   STATUS    RESTARTS   AGE
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 名称                              就绪   状态    重启次数   运行时间
- en: owg-opentelemetry-collector-567579558c-std2x   1/1     Running   0          6h26m
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: owg-opentelemetry-collector-567579558c-std2x   1/1     正在运行   0          6小时26分钟
- en: '[PRE19]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: $ kubectl logs owg-opentelemetry-collector-567579558c-std2x
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: $ kubectl logs owg-opentelemetry-collector-567579558c-std2x
- en: '[PRE20]'
  id: totrans-319
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: $ helm upgrade owg open-telemetry/opentelemetry-collector -f OTEL-Collector.yaml
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: $ helm upgrade owg open-telemetry/opentelemetry-collector -f OTEL-Collector.yaml
- en: '[PRE21]'
  id: totrans-321
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Part 2: Implement Telemetry in Grafana'
  id: totrans-322
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二部分：在Grafana中实现遥测
- en: 'This part of the book will take you through the different telemetry sources,
    explaining what they are, when to use them, and problems to watch out for. You
    will look at integrations with major cloud vendors: AWS, Azure, and Google. This
    part will also investigate real user monitoring with Faro, profiling with Pyroscope,
    and performance with k6.'
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 本部分将带你了解不同的遥测来源，解释它们是什么、何时使用它们，以及需要注意的问题。你将查看与主要云服务提供商的集成：AWS、Azure和Google。本部分还将探讨使用Faro进行的真实用户监控、使用Pyroscope进行的性能分析，以及使用k6进行的性能测试。
- en: 'This part has the following chapters:'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 本部分包含以下章节：
- en: '[*Chapter 4*](B18277_04.xhtml#_idTextAnchor092), *Looking at Logs with Grafana
    Loki*'
  id: totrans-325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第四章*](B18277_04.xhtml#_idTextAnchor092)，*使用 Grafana Loki 查看日志*'
- en: '[*Chapter 5*](B18277_05.xhtml#_idTextAnchor106), *Monitoring with Metrics Using
    Grafana Mimir and Prometheus*'
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第五章*](B18277_05.xhtml#_idTextAnchor106)，*使用 Grafana Mimir 和 Prometheus 进行指标监控*'
- en: '[*Chapter 6*](B18277_06.xhtml#_idTextAnchor134), *Tracing Technicalities with
    Grafana Tempo*'
  id: totrans-327
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第六章*](B18277_06.xhtml#_idTextAnchor134)，*使用 Grafana Tempo 跟踪技术细节*'
- en: '[*Chapter 7*](B18277_07.xhtml#_idTextAnchor147), *Interrogating Infrastructure
    with Kubernetes, AWS, GCP, and Azure*'
  id: totrans-328
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第七章*](B18277_07.xhtml#_idTextAnchor147)，*使用 Kubernetes、AWS、GCP 和 Azure 进行基础设施查询*'

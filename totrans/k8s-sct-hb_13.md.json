["```\n$ gcloud iam workload-identity-pools create \"ga-ksm-pool\" --project=\"${GCP_PROJECT_ID}\" --location=\"global\" --display-name=\"GitHub actions Pool\"\n```", "```\n$ gcloud iam workload-identity-pools providers create-oidc \"github\" \\\n--project=\"${GCP_PROJECT_ID}\" \\\n--location=\"global\" \\\n--workload-identity-pool=\"ga-ksm-pool\" \\\n--display-name=\"Github provider\" \\\n--attribute-mapping=\"google.subject=assertion.sub,attribute.repository=assertion.repository\" \\\n--issuer-uri=\"https://token.actions.githubusercontent.com\"\n```", "```\n$ gcloud iam service-accounts create github-service-account --project=\"${GCP_PROJECT_ID}\"\n$ project_number=$(gcloud projects list --filter=\"$(gcloud config get-value project)\" --format=\"value(PROJECT_NUMBER)\")\n$ gcloud secrets add-iam-policy-binding ksm-secret --member=\"serviceAccount:github-service-account@${GCP_PROJECT_ID}.iam.gserviceaccount.com\" --role=roles/secretmanager.viewer\n$ gcloud secrets add-iam-policy-binding ksm-secret --member=\"serviceAccount:github-service-account@${GCP_PROJECT_ID}.iam.gserviceaccount.com\" --role=roles/secretmanager.secretAccessor\n$ gcloud iam service-accounts add-iam-policy-binding \"github-service-account@${GCP_PROJECT_ID}.iam.gserviceaccount.com\" \\\n--project=\"${GCP_PROJECT_ID}\" \\\n--role=\"roles/iam.workloadIdentityUser\" \\\n--member=\"principalSet://iam.googleapis.com/projects/${project_number}/locations/global/workloadIdentityPools/ga-ksm-pool/attribute.repository/${github_organisation_or_username}/${github_repositoryname}\"\n```", "```\nname: Read from Secret Manager\non:\n push:\n  branches:\n   - 'main'\njobs:\n run:\n  name: 'get secret'\n  permissions:\n   id-token: write\n   contents: read\n  runs-on: 'ubuntu-latest'\n  steps:\n  - id: 'auth'\n    uses: 'google-github-actions/auth@v1'\n    with:\n      workload_identity_provider: 'projects/{project-id}/locations/global/workloadIdentityPools/ga-ksm-pool /providers/github'\n      service_account: 'github-service-account@${GCP_PROJECT_ID}.iam.gserviceaccount.com'\n  - id: fetch\n    run: |-\n      curl -H 'Bearer: ${{ steps.auth.outputs.access_token }}' https://secretmanager.googleapis.com/v1/projects/project-name/secrets/secret-name/versions/latest:access\n```", "```\n$ kubectl create namespace argocd\n$ kubectl config set-context --current --namespace=argocd\n$ kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/v2.5.8/manifests/install.yaml\n```", "```\n$ kubectl port-forward svc/argocd-server -n argocd 8080:443\n```", "```\n$ argocd admin initial-password -n argocd\n$ argocd login 127.0.0.1:8080 --username admin --password ***-** --insecure\n```", "```\n$ argocd app create guestbook --repo https://github.com/argoproj/argocd-example-apps.git --path guestbook --dest-server https://kubernetes.default.svc --dest-namespace default\n```", "```\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: secret-rotator\nspec:\n  template:\n    spec:\n      containers:\n      - name: secret-rotator\n        image: user-implemented-rotator-image\n        env:\n        - name: VAULT_ADDR\n          value: \"http://vault:8200\"\n        - name: SECRET_PATH\n          value: \"secret/my-app\"\n        - name: KUBERNETES_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_SELECTOR\n          value: \"app=my-app\"\n      restartPolicy: Never\n  backoffLimit: 0\n```", "```\n# serviceaccount.yaml\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: myapp-sa\n---\n# role.yaml\nkind: Role\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: myapp-role\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"pods\", \"secrets\"]\n    verbs: [\"get\", \"watch\", \"list\", \"create\", \"update\", \"delete\"]\n---\n# misconfigured-role-binding.yaml\nkind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: myapp-role-binding\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: myapp-role\nsubjects:\n  - kind: ServiceAccount\n    name: myapp-sa\n```"]
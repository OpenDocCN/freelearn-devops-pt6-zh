<html><head></head><body>
<div id="_idContainer161">
<h1 class="chapter-number" id="_idParaDest-150"><a id="_idTextAnchor150"/><span class="koboSpan" id="kobo.1.1">8</span></h1>
<h1 id="_idParaDest-151"><a id="_idTextAnchor151"/><span class="koboSpan" id="kobo.2.1">Enhancing Developer Productivity with Tanzu Application Platform</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In the world of enterprise software, we have the concept of </span><em class="italic"><span class="koboSpan" id="kobo.4.1">Big A</span></em><span class="koboSpan" id="kobo.5.1"> applications and </span><em class="italic"><span class="koboSpan" id="kobo.6.1">Little A</span></em><span class="koboSpan" id="kobo.7.1"> applications. </span><em class="italic"><span class="koboSpan" id="kobo.8.1">Big A</span></em><span class="koboSpan" id="kobo.9.1"> might be a giant corporate billing system with hundreds of components, whereas a </span><em class="italic"><span class="koboSpan" id="kobo.10.1">Little A</span></em><span class="koboSpan" id="kobo.11.1"> application might be a single job that pulls records from a mainframe and writes them </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">to MongoDB.</span></span></p>
<p><span class="koboSpan" id="kobo.13.1">Similarly, there are </span><em class="italic"><span class="koboSpan" id="kobo.14.1">Big P</span></em><span class="koboSpan" id="kobo.15.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.16.1">Little P</span></em><span class="koboSpan" id="kobo.17.1"> problems that need to be solved when delivering software in the enterprise. </span><span class="koboSpan" id="kobo.17.2">An example of a </span><em class="italic"><span class="koboSpan" id="kobo.18.1">Little P</span></em><span class="koboSpan" id="kobo.19.1"> problem I faced today was moving some container images from the VMware corporate container registry to a customer’s private registry so they could use them internally without having to allow egress to the internet. </span><span class="koboSpan" id="kobo.19.2">On the other hand, some </span><em class="italic"><span class="koboSpan" id="kobo.20.1">Big P</span></em><span class="koboSpan" id="kobo.21.1"> problems you might face in the enterprise space might be </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.23.1">Making a company’s developers measurably </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">more productive</span></span></li>
<li><span class="koboSpan" id="kobo.25.1">Getting applications into production quickly, safely, and consistently – minimizing toil </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">and blockers</span></span></li>
<li><span class="koboSpan" id="kobo.27.1">Getting developers, operators, and security specialists all pointed in the same direction and focused on the </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">same problems</span></span></li>
<li><span class="koboSpan" id="kobo.29.1">Delivering applications to modern container platforms such as Kubernetes when developers have limited exposure </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">and experience</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.31.1">Coincidentally, those </span><a id="_idIndexMarker544"/><span class="koboSpan" id="kobo.32.1">are exactly the four problems we talk about when we discuss </span><strong class="bold"><span class="koboSpan" id="kobo.33.1">Tanzu </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.34.1">Application Platform</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.36.1">In this chapter, we will cover </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">these topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.38.1">Why should I use Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.39.1">Application Platform?</span></span></li>
<li><span class="koboSpan" id="kobo.40.1">The building blocks of Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">Application Platform</span></span></li>
<li><span class="koboSpan" id="kobo.42.1">Day 1 – installing and configuring Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">Application Platform</span></span></li>
<li><span class="koboSpan" id="kobo.44.1">Day 2 – deploying applications to Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">Application Platform</span></span></li>
<li><span class="koboSpan" id="kobo.46.1">Day 3 – common operational activities on Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">Application Platform</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.48.1">Next steps</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.49.1">Now that we know what we’re going to accomplish in this chapter, let’s jump in and talk about the reasons you and your team might need to use Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">Application Platform.</span></span></p>
<h1 id="_idParaDest-152"><a id="_idTextAnchor152"/><span class="koboSpan" id="kobo.51.1">Why should I use Tanzu Application Platform?</span></h1>
<p><span class="koboSpan" id="kobo.52.1">As I mentioned in the chapter introduction, there are small problems that can be encountered </span><a id="_idIndexMarker545"/><span class="koboSpan" id="kobo.53.1">when writing software, such as efficiently sorting a list in place or moving streaming data from a legacy database to the latest NoSQL offering, and there are big problems, such as </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">the following:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.55.1">Developer productivity</span></strong><span class="koboSpan" id="kobo.56.1">: Enterprise software only exists because big companies hire software developers to write the software that they use to bring in revenue and differentiate the company from their competition. </span><span class="koboSpan" id="kobo.56.2">Companies with good platforms can focus their developers’ time and effort on meaningful tasks that directly affect the company’s bottom line. </span><span class="koboSpan" id="kobo.56.3">This makes the developers feel valued. </span><span class="koboSpan" id="kobo.56.4">Those without a good platform grow to view their developers as an expensive cost center, sparking a painful downward spiral into low morale and </span><span class="No-Break"><span class="koboSpan" id="kobo.57.1">low productivity.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.58.1">Getting software into production</span></strong><span class="koboSpan" id="kobo.59.1">: If you haven’t written software for a large company, you may be surprised at how difficult it is to get a piece of software into production. </span><span class="koboSpan" id="kobo.59.2">There are often dozens of manual, tedious tasks to check all the boxes for security, compliance, and downstream risk. </span><span class="koboSpan" id="kobo.59.3">The enlightened players in this space have figured out how to automate away the tedium, building these steps into an automated process, abstracted away </span><span class="No-Break"><span class="koboSpan" id="kobo.60.1">from developers.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.61.1">Align developers, operators, and security toward the same goal</span></strong><span class="koboSpan" id="kobo.62.1">: By building compliance, governance, best practices, and security into a streamlined automated process, you eliminate the friction often found between developers, operators, and security specialists. </span><span class="koboSpan" id="kobo.62.2">While the operators push back against any sort of change, security specialists want releases scrutinized down to the last bit. </span><span class="koboSpan" id="kobo.62.3">This can swallow up weeks of time and effort on a development team while crushing morale. </span><span class="koboSpan" id="kobo.62.4">By building checks and controls into the software supply chain, operators and security specialists can rest easy that their guidance is being followed, while developers are freed up to deliver software at a consistently </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">high velocity.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.64.1">On-ramp to Kubernetes</span></strong><span class="koboSpan" id="kobo.65.1">: Enterprise adoption of Kubernetes is on an upswing and shows few signs of slowing down. </span><span class="koboSpan" id="kobo.65.2">Kubernetes is a very powerful platform that enables some big outcomes. </span><span class="koboSpan" id="kobo.65.3">However, it comes with considerable complexity and a steep learning curve. </span><span class="koboSpan" id="kobo.65.4">Tanzu Application Platform abstracts away some of this complexity, allowing software teams to leverage Kubernetes while benefitting from some abstractions that simplify the path </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">to production.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.67.1">To summarize, Tanzu Application Platform is an end-to-end supply chain for delivering software to </span><a id="_idIndexMarker546"/><span class="koboSpan" id="kobo.68.1">production safely, securely, and reliably at scale. </span><span class="koboSpan" id="kobo.68.2">Now that we know at a high level what it is, let’s proceed to break it down and look at the </span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">individual components.</span></span></p>
<h1 id="_idParaDest-153"><a id="_idTextAnchor153"/><span class="koboSpan" id="kobo.70.1">The building blocks of Tanzu Application Platform</span></h1>
<p><span class="koboSpan" id="kobo.71.1">Tanzu Application Platform is an opinionated set of technologies working together to deliver </span><a id="_idIndexMarker547"/><span class="koboSpan" id="kobo.72.1">significant outcomes for platform operators, developers, and security professionals. </span><span class="koboSpan" id="kobo.72.2">Covering each component in depth would require more space than this chapter allows, so I encourage you to visit the official documentation for more detail on any of </span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">these components.</span></span></p>
<p><span class="koboSpan" id="kobo.74.1">The diagram that follows offers a high-level view of Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.75.1">Application Platform:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer151">
<span class="koboSpan" id="kobo.76.1"><img alt="Figure ﻿8.1 – Tanzu Application Platform components" src="image/B18145_08_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.77.1">Figure 8.1 – Tanzu Application Platform components</span></p>
<p><span class="koboSpan" id="kobo.78.1">This diagram </span><a id="_idIndexMarker548"/><span class="koboSpan" id="kobo.79.1">attempts to group and categorize the various components. </span><span class="koboSpan" id="kobo.79.2">Here’s a breakdown of the products that follow the hierarchy from </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">the diagram:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.81.1">Developer Tools</span></strong><span class="koboSpan" id="kobo.82.1">: In the previous section, we mentioned that Tanzu Application Platform is a ramp for developers to get onto Kubernetes, as well as a </span><a id="_idIndexMarker549"/><span class="koboSpan" id="kobo.83.1">platform designed to make them as efficient and productive as possible. </span><span class="koboSpan" id="kobo.83.2">Here are the components that help </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">accomplish this:</span></span><ul><li><strong class="bold"><span class="koboSpan" id="kobo.85.1">Tanzu CLI</span></strong><span class="koboSpan" id="kobo.86.1">: Unless this is the first chapter of this book that you’re reading, you’ll </span><a id="_idIndexMarker550"/><span class="koboSpan" id="kobo.87.1">have seen this tool before. </span><span class="koboSpan" id="kobo.87.2">The Tanzu CLI is </span><a id="_idIndexMarker551"/><span class="koboSpan" id="kobo.88.1">a tool that allows developers to deal with higher-level abstractions rather than interact directly with infrastructure and Kubernetes </span><strong class="bold"><span class="koboSpan" id="kobo.89.1">Custom Resources</span></strong><span class="koboSpan" id="kobo.90.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.91.1">CRs</span></strong><span class="koboSpan" id="kobo.92.1">). </span><span class="koboSpan" id="kobo.92.2">It does </span><a id="_idIndexMarker552"/><span class="koboSpan" id="kobo.93.1">so via </span><em class="italic"><span class="koboSpan" id="kobo.94.1">plugins</span></em><span class="koboSpan" id="kobo.95.1"> specific to a </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">particular feature.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.97.1">Apps CLI plugin</span></strong><span class="koboSpan" id="kobo.98.1">: This plugin to the Tanzu CLI deals with two abstractions that will </span><a id="_idIndexMarker553"/><span class="koboSpan" id="kobo.99.1">become very familiar to developers </span><a id="_idIndexMarker554"/><span class="koboSpan" id="kobo.100.1">on the platform: </span><em class="italic"><span class="koboSpan" id="kobo.101.1">cluster supply chains</span></em><span class="koboSpan" id="kobo.102.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.103.1">workloads</span></em><span class="koboSpan" id="kobo.104.1">. </span><span class="koboSpan" id="kobo.104.2">A </span><em class="italic"><span class="koboSpan" id="kobo.105.1">supply chain</span></em><span class="koboSpan" id="kobo.106.1"> is a Kubernetes CR representing all the steps from the developer’s desktop to production application. </span><span class="koboSpan" id="kobo.106.2">A </span><em class="italic"><span class="koboSpan" id="kobo.107.1">workload</span></em><span class="koboSpan" id="kobo.108.1"> is the application itself that makes the journey into production via a supply chain. </span><span class="koboSpan" id="kobo.108.2">This CLI plugin lets you get a workload into production without manually configuring </span><span class="No-Break"><span class="koboSpan" id="kobo.109.1">YAML files.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.110.1">Insight CLI plugin</span></strong><span class="koboSpan" id="kobo.111.1">: As we mentioned in the previous point, you can use the </span><a id="_idIndexMarker555"/><span class="koboSpan" id="kobo.112.1">Tanzu CLI to deploy an application and run it through </span><a id="_idIndexMarker556"/><span class="koboSpan" id="kobo.113.1">a supply chain, which will move it onto the platform as a running app. </span><span class="koboSpan" id="kobo.113.2">Many supply chains include steps that scan resources for vulnerabilities. </span><span class="koboSpan" id="kobo.113.3">This plugin allows you to manually run those scans or report on the results of those scans. </span><span class="koboSpan" id="kobo.113.4">The four entities that this plugin allows you to work with are </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">as follows:</span></span><ul><li><strong class="bold"><span class="koboSpan" id="kobo.115.1">Images</span></strong><span class="koboSpan" id="kobo.116.1">: This </span><a id="_idIndexMarker557"/><span class="koboSpan" id="kobo.117.1">is a container image that exists in a registry. </span><span class="koboSpan" id="kobo.117.2">Often, these images are built as part of a supply chain, but </span><a id="_idIndexMarker558"/><span class="koboSpan" id="kobo.118.1">they don’t have to be. </span><span class="koboSpan" id="kobo.118.2">You can send a </span><strong class="bold"><span class="koboSpan" id="kobo.119.1">Software Bill Of Materials</span></strong><span class="koboSpan" id="kobo.120.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.121.1">SBOM</span></strong><span class="koboSpan" id="kobo.122.1">) for scanning or querying the results of previous scans against an image that the platform already </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">knows about.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.124.1">Packages</span></strong><span class="koboSpan" id="kobo.125.1">: This </span><a id="_idIndexMarker559"/><span class="koboSpan" id="kobo.126.1">is just what it sounds like. </span><span class="koboSpan" id="kobo.126.2">Many programming languages have their own package management and distribution mechanisms. </span><span class="koboSpan" id="kobo.126.3">The same goes for operating systems, whose root filesystems may very well be embedded in a container image. </span><span class="koboSpan" id="kobo.126.4">Most of the vulnerabilities that get surfaced in a scan are in these packages. </span><span class="koboSpan" id="kobo.126.5">This plugin lets you query the specific packages, which were identified in a source or an image scan, that contain </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">known vulnerabilities.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.128.1">Source</span></strong><span class="koboSpan" id="kobo.129.1">: This </span><a id="_idIndexMarker560"/><span class="koboSpan" id="kobo.130.1">allows you to scan your source code’s SBOM in real time or query past source code scans that happened on </span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">the platform.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.132.1">Vulnerabilities</span></strong><span class="koboSpan" id="kobo.133.1">: This </span><a id="_idIndexMarker561"/><span class="koboSpan" id="kobo.134.1">represents a vulnerability that turned up in a source or image scan. </span><span class="koboSpan" id="kobo.134.2">The Insight plugin allows you to query individual vulnerabilities (e.g., Log4Shell or Log4Spring) and tie them back to specific scans </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">or packages.</span></span></li></ul></li><li><strong class="bold"><span class="koboSpan" id="kobo.136.1">Developer IDE plugins</span></strong><span class="koboSpan" id="kobo.137.1">: Tanzu </span><a id="_idIndexMarker562"/><span class="koboSpan" id="kobo.138.1">Application Platform </span><a id="_idIndexMarker563"/><span class="koboSpan" id="kobo.139.1">provides IDE plugins for both </span><strong class="bold"><span class="koboSpan" id="kobo.140.1">Visual Studio Code</span></strong><span class="koboSpan" id="kobo.141.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.142.1">VS Code</span></strong><span class="koboSpan" id="kobo.143.1">) and </span><em class="italic"><span class="koboSpan" id="kobo.144.1">IntelliJ IDEA</span></em><span class="koboSpan" id="kobo.145.1">. </span><span class="koboSpan" id="kobo.145.2">As developers </span><a id="_idIndexMarker564"/><span class="koboSpan" id="kobo.146.1">move toward a distributed cloud-native model, it becomes increasingly difficult to replicate the runtime environment on their desktops. </span><span class="koboSpan" id="kobo.146.2">Tanzu Application Platform provides the ability to quickly iterate on and debug their code on a running Kubernetes cluster. </span><span class="koboSpan" id="kobo.146.3">Here is a current list of those </span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">IDE plugins:</span></span><ul><li><strong class="bold"><span class="koboSpan" id="kobo.148.1">Direct Deploy</span></strong><span class="koboSpan" id="kobo.149.1">: This </span><a id="_idIndexMarker565"/><span class="koboSpan" id="kobo.150.1">saves developers the steps of piecing together a complex </span><strong class="source-inline"><span class="koboSpan" id="kobo.151.1">tanzu</span></strong><span class="koboSpan" id="kobo.152.1"> CLI command or a </span><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">workload.yaml</span></strong><span class="koboSpan" id="kobo.154.1"> file. </span><span class="koboSpan" id="kobo.154.2">Developers can deploy workloads directly to a Kubernetes cluster from </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">their IDEs.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.156.1">Live Update</span></strong><span class="koboSpan" id="kobo.157.1">: Developers can make a local change on their workstations </span><a id="_idIndexMarker566"/><span class="koboSpan" id="kobo.158.1">and see it running live on a Kubernetes cluster in seconds. </span><span class="koboSpan" id="kobo.158.2">This uses </span><em class="italic"><span class="koboSpan" id="kobo.159.1">Tilt</span></em><span class="koboSpan" id="kobo.160.1"> under the covers to sync the local code base with the workload running remotely </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">on Kubernetes.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.162.1">Remote Debug</span></strong><span class="koboSpan" id="kobo.163.1">: Sometimes log messages just aren’t sufficient and you need </span><a id="_idIndexMarker567"/><span class="koboSpan" id="kobo.164.1">to step through your code, examining local and wider-scoped variables in the process. </span><span class="koboSpan" id="kobo.164.2">As we just mentioned, this is straightforward on a local workstation, but in a modern environment, this often isn’t sufficient to debug an issue occurring in Kubernetes. </span><span class="koboSpan" id="kobo.164.3">Directly debugging a workload on Kubernetes often entails </span><a id="_idIndexMarker568"/><span class="koboSpan" id="kobo.165.1">a messy array of startup parameters and port forwards. </span><span class="koboSpan" id="kobo.165.2">This plugin automates the whole process, giving developers a one-click solution to </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">remote debugging.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.167.1">Running Workloads</span></strong><span class="koboSpan" id="kobo.168.1">: With this VS Code-only feature, developers get a panel </span><a id="_idIndexMarker569"/><span class="koboSpan" id="kobo.169.1">inside their IDE to visualize all workloads running in their current </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">Kubernetes context.</span></span></li></ul></li></ul></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.171.1">Tanzu Application Platform GUI</span></strong><span class="koboSpan" id="kobo.172.1">: The Tanzu Application GUI, based on the </span><em class="italic"><span class="koboSpan" id="kobo.173.1">Backstage</span></em><span class="koboSpan" id="kobo.174.1"> open source project, is a central dashboard for Tanzu Application Platform. </span><span class="koboSpan" id="kobo.174.2">It </span><a id="_idIndexMarker570"/><span class="koboSpan" id="kobo.175.1">provides some out-of-the-box functionality that it gets from Backstage, as well as a number of very useful custom plugins that are only available </span><a id="_idIndexMarker571"/><span class="koboSpan" id="kobo.176.1">to Tanzu Application Platform users. </span><span class="koboSpan" id="kobo.176.2">Here’s a quick peek at what you can expect to see in the Tanzu Application Platform GUI, starting with a visual overview of the UI and </span><span class="No-Break"><span class="koboSpan" id="kobo.177.1">its layout:</span></span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer152">
<span class="koboSpan" id="kobo.178.1"><img alt="Figure ﻿8.2 – Tanzu Application Platform GUI" src="image/B18145_08_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.179.1">Figure 8.2 – Tanzu Application Platform GUI</span></p>
<p><span class="koboSpan" id="kobo.180.1">This is the screen you’ll see when first accessing the Tanzu Application GUI. </span><span class="koboSpan" id="kobo.180.2">The following is a breakdown of the </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">GUI’s components:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.182.1">Organization Catalog</span></strong><span class="koboSpan" id="kobo.183.1">: Tanzu Application Platform GUI provides a central repository </span><a id="_idIndexMarker572"/><span class="koboSpan" id="kobo.184.1">for an entire organization to publish and catalog their software. </span><span class="koboSpan" id="kobo.184.2">If we dig into </span><strong class="bold"><span class="koboSpan" id="kobo.185.1">tanzu-java-web-app</span></strong><span class="koboSpan" id="kobo.186.1"> in the preceding screenshot, we’ll see the </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">following screen:</span></span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer153">
<span class="koboSpan" id="kobo.188.1"><img alt="Figure ﻿8.3 – Tanzu Application Platform GUI catalog entry" src="image/B18145_08_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.189.1">Figure 8.3 – Tanzu Application Platform GUI catalog entry</span></p>
<p><span class="koboSpan" id="kobo.190.1">The catalog entry allows teams to provide a “one-stop shop” for their application’s source code, tech docs, API definition, and any </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">relevant links:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.192.1">TechDocs</span></strong><span class="koboSpan" id="kobo.193.1">: This is a backstage plugin that allows development teams to create </span><a id="_idIndexMarker573"/><span class="koboSpan" id="kobo.194.1">documentation in Markdown format, and will present that documentation as part of the application’s entry in the </span><span class="No-Break"><span class="koboSpan" id="kobo.195.1">organization catalog.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.196.1">Runtime Resources Visibility</span></strong><span class="koboSpan" id="kobo.197.1">: Users </span><a id="_idIndexMarker574"/><span class="koboSpan" id="kobo.198.1">of other Tanzu products, such as </span><em class="italic"><span class="koboSpan" id="kobo.199.1">Tanzu Application Service</span></em><span class="koboSpan" id="kobo.200.1"> (</span><a href="https://tanzu.vmware.com/application-service"><span class="koboSpan" id="kobo.201.1">https://tanzu.vmware.com/application-service</span></a><span class="koboSpan" id="kobo.202.1">), have </span><a id="_idIndexMarker575"/><span class="koboSpan" id="kobo.203.1">benefitted from being able to see all their runtime resources in one place. </span><span class="koboSpan" id="kobo.203.2">The Tanzu team brought this to Tanzu Application Platform GUI as well. </span><span class="koboSpan" id="kobo.203.3">Anything associated with a registered catalog entity will be </span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">visible here.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.205.1">Application Live View</span></strong><span class="koboSpan" id="kobo.206.1">: This </span><a id="_idIndexMarker576"/><span class="koboSpan" id="kobo.207.1">feature works with other components, such as </span><em class="italic"><span class="koboSpan" id="kobo.208.1">Convention Service</span></em><span class="koboSpan" id="kobo.209.1">, to provide deep insight into the runtime state of a </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">running application.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.211.1">Application Accelerator</span></strong><span class="koboSpan" id="kobo.212.1">: This </span><a id="_idIndexMarker577"/><span class="koboSpan" id="kobo.213.1">feature, which we covered in depth in </span><a href="B18145_02.xhtml#_idTextAnchor033"><em class="italic"><span class="koboSpan" id="kobo.214.1">Chapter 2</span></em></a><em class="italic"><span class="koboSpan" id="kobo.215.1">, Developing Cloud-Native Applications</span></em><span class="koboSpan" id="kobo.216.1">, is part of Tanzu Application </span><span class="No-Break"><span class="koboSpan" id="kobo.217.1">Platform GUI.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.218.1">API Documentation</span></strong><span class="koboSpan" id="kobo.219.1">: This </span><a id="_idIndexMarker578"/><span class="koboSpan" id="kobo.220.1">feature, which we covered in depth in </span><a href="B18145_05.xhtml#_idTextAnchor093"><em class="italic"><span class="koboSpan" id="kobo.221.1">Chapter 5</span></em></a><em class="italic"><span class="koboSpan" id="kobo.222.1">, Defining and Managing Business APIs</span></em><span class="koboSpan" id="kobo.223.1">, is also part of Tanzu Application </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">Platform GUI.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.225.1">Supply Chain Choreographer Visualization</span></strong><span class="koboSpan" id="kobo.226.1">: Supply Chain Choreographer, which lies at the heart of Tanzu Application Platform, is just what </span><a id="_idIndexMarker579"/><span class="koboSpan" id="kobo.227.1">it sounds like, a chained set of inputs and outputs that guide an application from its source to a running application in a production environment. </span><span class="koboSpan" id="kobo.227.2">This plugin provides a compelling visualization of those </span><span class="No-Break"><span class="koboSpan" id="kobo.228.1">supply chains.</span></span></li>
</ul>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.229.1">Supply Chain Choreographer</span></strong><span class="koboSpan" id="kobo.230.1">: If you think of Tanzu Application Platform GUI as the “eyes and ears” of the platform, then Supply Chain Choreographer would </span><a id="_idIndexMarker580"/><span class="koboSpan" id="kobo.231.1">be its beating heart. </span><span class="koboSpan" id="kobo.231.2">Supply Chain Choreographer is based on the open source </span><em class="italic"><span class="koboSpan" id="kobo.232.1">Cartographer</span></em><span class="koboSpan" id="kobo.233.1"> project (</span><a href="https://github.com/vmware-tanzu/cartographer"><span class="koboSpan" id="kobo.234.1">https://github.com/vmware-tanzu/cartographer</span></a><span class="koboSpan" id="kobo.235.1">), and it allows platform operators and software architects to preconfigure and pre-approve multiple paths to production. </span><span class="koboSpan" id="kobo.235.2">There might be a path to production for Spring Boot APIs that fall under PCI controls and another path to production for event-driven data processing applications. </span><span class="koboSpan" id="kobo.235.3">Just as was the case with Tanzu Application Platform GUI, Supply Chain Choreographer is a feature of the platform that bundles and contains other features. </span><span class="koboSpan" id="kobo.235.4">Here’s a list of some of the platform features that fall within the realm of Supply </span><span class="No-Break"><span class="koboSpan" id="kobo.236.1">Chain Choreographer:</span></span><ul><li><strong class="bold"><span class="koboSpan" id="kobo.237.1">Live View Convention Service</span></strong><span class="koboSpan" id="kobo.238.1">: One of the features mentioned in our discussion </span><a id="_idIndexMarker581"/><span class="koboSpan" id="kobo.239.1">of Tanzu Application Platform GUI was the </span><em class="italic"><span class="koboSpan" id="kobo.240.1">Application Live View</span></em><span class="koboSpan" id="kobo.241.1"> GUI plugin. </span><span class="koboSpan" id="kobo.241.2">For this plugin to work, an application needs to expose its inner workings via an opinionated, well-known API. </span><span class="koboSpan" id="kobo.241.3">A naïve approach to this might be to require all application teams to implement this themselves, by bringing in a particular version of Spring Boot Actuator with its own web listener running on a specific port with specific endpoint naming conventions. </span><span class="koboSpan" id="kobo.241.4">This would result in added burden on the development teams as well as the potential for misconfiguration. </span><span class="koboSpan" id="kobo.241.5">A better approach would be to modify every workload as it passes through the supply chain to expose the inner workings in a consistent, opinionated way. </span><span class="koboSpan" id="kobo.241.6">That’s exactly what this service does. </span><span class="koboSpan" id="kobo.241.7">It sits in the supply chain and adds consistent Java or .NET Core configuration parameters to every eligible application that uses the </span><span class="No-Break"><span class="koboSpan" id="kobo.242.1">supply chain.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.243.1">Cartographer Conventions</span></strong><span class="koboSpan" id="kobo.244.1">: Application Live View isn’t the only feature for </span><a id="_idIndexMarker582"/><span class="koboSpan" id="kobo.245.1">which supply chain conventions are a good fit. </span><span class="koboSpan" id="kobo.245.2">Any features that a platform operator or a DevOps lead wants to apply across the entire portfolio are a good fit here. </span><span class="koboSpan" id="kobo.245.3">One example is labeling all application artifacts with the owner of the project. </span><span class="koboSpan" id="kobo.245.4">Another might be to configure sane upper and lower limits to an app that auto-scales with </span><em class="italic"><span class="koboSpan" id="kobo.246.1">Cloud Native Runtimes</span></em><span class="koboSpan" id="kobo.247.1">. </span><span class="koboSpan" id="kobo.247.2">The possibilities are endless, and Cartographer Conventions is a convenient way to apply conventions across a wide range of applications running on </span><span class="No-Break"><span class="koboSpan" id="kobo.248.1">the platform.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.249.1">Cloud Native Runtimes</span></strong><span class="koboSpan" id="kobo.250.1">: This is the component that runs your deployable </span><a id="_idIndexMarker583"/><span class="koboSpan" id="kobo.251.1">application artifacts on Kubernetes. </span><span class="koboSpan" id="kobo.251.2">It is based on the open source </span><em class="italic"><span class="koboSpan" id="kobo.252.1">Knative</span></em><span class="koboSpan" id="kobo.253.1"> project (</span><a href="https://github.com/knative"><span class="koboSpan" id="kobo.254.1">https://github.com/knative</span></a><span class="koboSpan" id="kobo.255.1">), which, while it is often thought of as a serverless runtime, is also an excellent way to run regular web-facing workloads. </span><span class="koboSpan" id="kobo.255.2">It has a unique approach to load balancing that allows for auto-scaling based on configurable metrics while minimizing lost or </span><span class="No-Break"><span class="koboSpan" id="kobo.256.1">dropped requests.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.257.1">Services Toolkit</span></strong><span class="koboSpan" id="kobo.258.1">: This is another feature that evolved from the much-loved </span><em class="italic"><span class="koboSpan" id="kobo.259.1">Tanzu Application Service</span></em><span class="koboSpan" id="kobo.260.1">. </span><span class="koboSpan" id="kobo.260.2">That product allowed users to request a service </span><a id="_idIndexMarker584"/><span class="koboSpan" id="kobo.261.1">to be provisioned, perhaps a database or a message queue, and bind the credentials of that service to an application at runtime. </span><em class="italic"><span class="koboSpan" id="kobo.262.1">Services Toolkit</span></em><span class="koboSpan" id="kobo.263.1"> brings that same functionality to Kubernetes. </span><span class="koboSpan" id="kobo.263.2">You can think of it as data services for developers who, first, don’t want to think about managing data services, and second, don’t want to manually wire up their application to those </span><span class="No-Break"><span class="koboSpan" id="kobo.264.1">data services.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.265.1">Tanzu Build Service</span></strong><span class="koboSpan" id="kobo.266.1">: In a previous bullet, we talked about running deployable </span><a id="_idIndexMarker585"/><span class="koboSpan" id="kobo.267.1">artifacts. </span><span class="koboSpan" id="kobo.267.2">Tanzu Build Service is the component that takes an application’s source code as input and outputs a deployable artifact in the form of an OCI container image. </span><span class="koboSpan" id="kobo.267.3">We did a thorough deep-dive into this feature in </span><a href="B18145_03.xhtml#_idTextAnchor048"><em class="italic"><span class="koboSpan" id="kobo.268.1">Chapter 3</span></em></a><em class="italic"><span class="koboSpan" id="kobo.269.1">, Building Secure Container Images with </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.270.1">Build Service</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.271.1">.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.272.1">Workload Types</span></strong><span class="koboSpan" id="kobo.273.1">: You can think of this as a set of preconfigured, pre-curated </span><a id="_idIndexMarker586"/><span class="koboSpan" id="kobo.274.1">supply chains that you can use to get started quickly with several different kinds </span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">of workloads:</span></span><ul><li><strong class="bold"><span class="koboSpan" id="kobo.276.1">Web</span></strong><span class="koboSpan" id="kobo.277.1">: This is </span><a id="_idIndexMarker587"/><span class="koboSpan" id="kobo.278.1">a standard web-facing application that you want to be able to scale up </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">and down</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.280.1">TCP</span></strong><span class="koboSpan" id="kobo.281.1">: This is </span><a id="_idIndexMarker588"/><span class="koboSpan" id="kobo.282.1">a good fit for running a legacy application that handles its own web interactions and you want to pass network traffic directly </span><span class="No-Break"><span class="koboSpan" id="kobo.283.1">to it</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.284.1">Queues</span></strong><span class="koboSpan" id="kobo.285.1">: These </span><a id="_idIndexMarker589"/><span class="koboSpan" id="kobo.286.1">are applications that run in the background and process events as they arrive on </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">a queue</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.288.1">Functions</span></strong><span class="koboSpan" id="kobo.289.1">: These </span><a id="_idIndexMarker590"/><span class="koboSpan" id="kobo.290.1">are a hybrid of web and queue applications that allow developers to implement a single piece of functionality that only gets instantiated and called when a request </span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">comes in</span></span></li></ul></li></ul></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.292.1">App and Platform Security</span></strong><span class="koboSpan" id="kobo.293.1">: Here </span><a id="_idIndexMarker591"/><span class="koboSpan" id="kobo.294.1">are some </span><a id="_idIndexMarker592"/><span class="koboSpan" id="kobo.295.1">of the components that make security a first-class citizen on Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.296.1">Application Platform:</span></span><ul><li><strong class="bold"><span class="koboSpan" id="kobo.297.1">Tanzu Application Platform Authentication and RBAC Authorization</span></strong><span class="koboSpan" id="kobo.298.1">: Tanzu Application Platform GUI uses the single sign-on functionality </span><a id="_idIndexMarker593"/><span class="koboSpan" id="kobo.299.1">that comes with Backstage. </span><span class="koboSpan" id="kobo.299.2">This allows platform operators to </span><a id="_idIndexMarker594"/><span class="koboSpan" id="kobo.300.1">configure providers such as Okta, Google, Azure, and GitHub. </span><span class="koboSpan" id="kobo.300.2">Furthermore, the GUI can be configured such that it can monitor running resources across multiple Kubernetes clusters, not just the cluster it is </span><span class="No-Break"><span class="koboSpan" id="kobo.301.1">running on.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.302.1">App single sign-on</span></strong><span class="koboSpan" id="kobo.303.1">: This </span><a id="_idIndexMarker595"/><span class="koboSpan" id="kobo.304.1">is a very common request among application developers. </span><span class="koboSpan" id="kobo.304.2">They don’t want to </span><a id="_idIndexMarker596"/><span class="koboSpan" id="kobo.305.1">manage their own login, user </span><strong class="bold"><span class="koboSpan" id="kobo.306.1">authentication</span></strong><span class="koboSpan" id="kobo.307.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.308.1">authN</span></strong><span class="koboSpan" id="kobo.309.1">), or </span><strong class="bold"><span class="koboSpan" id="kobo.310.1">authorization</span></strong><span class="koboSpan" id="kobo.311.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.312.1">authZ</span></strong><span class="koboSpan" id="kobo.313.1">). </span><span class="koboSpan" id="kobo.313.2">Rather, they want to delegate </span><a id="_idIndexMarker597"/><span class="koboSpan" id="kobo.314.1">those functions to the platform and have it taken care of for them. </span><span class="koboSpan" id="kobo.314.2">That’s exactly what this feature does. </span><span class="koboSpan" id="kobo.314.3">It allows platform operators to stand up preconfigured, opinionated deployments of Spring Authorization Server, and make that server available to applications via integrations into the platform’s software supply chains. </span><span class="koboSpan" id="kobo.314.4">The idea of this service is to integrate single sign-on into the application from the very beginning rather than as a last-minute </span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">bolt-on solution.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.316.1">Supply Chain Security Tools</span></strong><span class="koboSpan" id="kobo.317.1">: Software supply chain attacks are top-of-mind </span><a id="_idIndexMarker598"/><span class="koboSpan" id="kobo.318.1">for many in the enterprise software space, and for good reason. </span><span class="koboSpan" id="kobo.318.2">Supply Chain Security Tools is a suite of tools that plug directly into a software supply chain such that whenever any part of that supply chain changes, the source code, bundled dependencies, and generated container images get scanned for all known vulnerabilities using a constantly updated database. </span><span class="koboSpan" id="kobo.318.3">These tools handle scanning the artifacts, storing the scan results, reporting on the stored results, and cryptographically signing the generated artifacts so they can’t be changed after they’ve been scanned. </span><span class="koboSpan" id="kobo.318.4">This allows platform operators to enable best-of-breed security for all their running workloads simply by incorporating them into a </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">supply chain.</span></span></li></ul></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.320.1">Enablement</span></strong><span class="koboSpan" id="kobo.321.1">: Any product of the size and scope of Tanzu Application Platform needs </span><a id="_idIndexMarker599"/><span class="koboSpan" id="kobo.322.1">a way for users and operators of the product to get up to speed. </span><span class="koboSpan" id="kobo.322.2">Tanzu Application Platform bundles its own learning platform for enabling those users. </span><span class="koboSpan" id="kobo.322.3">This allows platform operators to quickly and easily set up hands-on workshops that walk the various personas through the product. </span><span class="koboSpan" id="kobo.322.4">It also includes a brief built-in workshop on how to build your own workshops. </span><span class="koboSpan" id="kobo.322.5">Here’s a quick look at </span><strong class="bold"><span class="koboSpan" id="kobo.323.1">Learning Center for Tanzu Application Platform</span></strong><span class="koboSpan" id="kobo.324.1"> showing my favorite feature, the browser-embedded VS </span><span class="No-Break"><span class="koboSpan" id="kobo.325.1">Code editor:</span></span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer154">
<span class="koboSpan" id="kobo.326.1"><img alt="Figure ﻿8.4 – Learning Center with the Embedded VS Code editor" src="image/B18145_08_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.327.1">Figure 8.4 – Learning Center with the Embedded VS Code editor</span></p>
<p><span class="koboSpan" id="kobo.328.1">This allows architects and operators to build hands-on real-world workshops that automatically provision and run completely self-contained in the browser. </span><span class="koboSpan" id="kobo.328.2">Here’s a quick list of some of the </span><span class="No-Break"><span class="koboSpan" id="kobo.329.1">available features:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.330.1">Fully functional console</span></strong><span class="koboSpan" id="kobo.331.1">: Any workshop tasks that must happen in a shell in </span><a id="_idIndexMarker600"/><span class="koboSpan" id="kobo.332.1">a console can be executed from within the browser. </span><span class="koboSpan" id="kobo.332.2">Furthermore, you can provide a link that will paste code directly into the console and execute it. </span><span class="koboSpan" id="kobo.332.3">Furthermore, these consoles can be preconfigured with </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">kubectl</span></strong><span class="koboSpan" id="kobo.334.1"> pointing to a live Kubernetes cluster and embedded </span><em class="italic"><span class="koboSpan" id="kobo.335.1">Docker</span></em><span class="koboSpan" id="kobo.336.1">, so anything requiring the Docker CLI, builds, runs, pushes, and so on, are </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">also possible.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.338.1">Embedded comprehension questions</span></strong><span class="koboSpan" id="kobo.339.1">: Workshop builders can embed questions </span><a id="_idIndexMarker601"/><span class="koboSpan" id="kobo.340.1">right into the workshop to make sure users are properly understanding </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">the concepts.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.342.1">Embedded VS Code editor</span></strong><span class="koboSpan" id="kobo.343.1">: Not only can workshop builders embed VS Code </span><a id="_idIndexMarker602"/><span class="koboSpan" id="kobo.344.1">right into their workshop, but they can provide links that will open files, select code blocks in the editor window, and even paste additional fragments in just the </span><span class="No-Break"><span class="koboSpan" id="kobo.345.1">right location.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.346.1">Embedded web pages</span></strong><span class="koboSpan" id="kobo.347.1">: This allows users to deploy something to their dedicated </span><a id="_idIndexMarker603"/><span class="koboSpan" id="kobo.348.1">workshop Kubernetes instance and immediately see it running right in the same window. </span><span class="koboSpan" id="kobo.348.2">It also enables tools like the Kubernetes web console to </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">be exposed.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.350.1">Verify Workshop State</span></strong><span class="koboSpan" id="kobo.351.1">: Users can click a link that will trigger Kubernetes commands </span><a id="_idIndexMarker604"/><span class="koboSpan" id="kobo.352.1">that don’t appear in a console. </span><span class="koboSpan" id="kobo.352.2">This allows workshop developers to ensure that the workshop state is as desired before </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">moving on.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.354.1">Docker builds</span></strong><span class="koboSpan" id="kobo.355.1">: The </span><a id="_idIndexMarker605"/><span class="koboSpan" id="kobo.356.1">embedded console uses </span><strong class="bold"><span class="koboSpan" id="kobo.357.1">Docker in Docker</span></strong><span class="koboSpan" id="kobo.358.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.359.1">DIND</span></strong><span class="koboSpan" id="kobo.360.1">) to </span><a id="_idIndexMarker606"/><span class="koboSpan" id="kobo.361.1">allow for the full range of </span><span class="No-Break"><span class="koboSpan" id="kobo.362.1">Docker commands.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.363.1">Download files</span></strong><span class="koboSpan" id="kobo.364.1">: Workshop </span><a id="_idIndexMarker607"/><span class="koboSpan" id="kobo.365.1">developers can enable users to download a local copy of any or all workshop files for </span><span class="No-Break"><span class="koboSpan" id="kobo.366.1">future reference.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.367.1">Now that we’ve covered whom Tanzu Application Platform is targeted to and what it consists of, it’s time to get our hands dirty and install it, which is exactly what we’ll do in the </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">next section.</span></span></p>
<h1 id="_idParaDest-154"><a id="_idTextAnchor154"/><span class="koboSpan" id="kobo.369.1">Day 1 – installing and configuring Tanzu Application Platform</span></h1>
<p><span class="koboSpan" id="kobo.370.1">To install </span><a id="_idIndexMarker608"/><span class="koboSpan" id="kobo.371.1">Tanzu Application Platform, we’ll need </span><a id="_idIndexMarker609"/><span class="koboSpan" id="kobo.372.1">a few things in </span><span class="No-Break"><span class="koboSpan" id="kobo.373.1">place first.</span></span></p>
<h2 id="_idParaDest-155"><a id="_idTextAnchor155"/><span class="koboSpan" id="kobo.374.1">Prerequisites and technical requirements</span></h2>
<p><span class="koboSpan" id="kobo.375.1">In </span><a id="_idIndexMarker610"/><span class="koboSpan" id="kobo.376.1">order to install and run Tanzu Application Platform, there are some technical prerequisites that must be in place. </span><span class="koboSpan" id="kobo.376.2">Here’s a list of what </span><span class="No-Break"><span class="koboSpan" id="kobo.377.1">is required:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.378.1">A (large) </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.379.1">Kubernetes cluster</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.380.1">The </span><a id="_idIndexMarker611"/><span class="koboSpan" id="kobo.381.1">Tanzu Application </span><a id="_idIndexMarker612"/><span class="koboSpan" id="kobo.382.1">Platform documentation lists </span><a id="_idIndexMarker613"/><span class="koboSpan" id="kobo.383.1">several supported </span><a id="_idIndexMarker614"/><span class="koboSpan" id="kobo.384.1">Kubernetes clusters, including Tanzu Kubernetes Grid and Minikube. </span><span class="koboSpan" id="kobo.384.2">However, to keep </span><a id="_idIndexMarker615"/><span class="koboSpan" id="kobo.385.1">these instructions manageable, I’m going to recommend three public cloud Kubernetes clusters. </span><span class="koboSpan" id="kobo.385.2">These clusters are </span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">as follows:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.387.1">Amazon Elastic Kubernetes </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.388.1">Service</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.389.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.390.1">EKS</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">)</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.392.1">Azure Kubernetes </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.393.1">Service</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.394.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.395.1">AKS</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.396.1">)</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.397.1">Google Kubernetes </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.398.1">Engine</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.399.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.400.1">GKE</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.401.1">)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.402.1">There are a number of reasons for this. </span><span class="koboSpan" id="kobo.402.2">Here are </span><span class="No-Break"><span class="koboSpan" id="kobo.403.1">a few:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.404.1">Easy out-of-the-box load balancer services. </span><span class="koboSpan" id="kobo.404.2">While we can make Tanzu Application Platform work with node ports, load balancer services make things </span><span class="No-Break"><span class="koboSpan" id="kobo.405.1">much easier.</span></span></li>
<li><span class="koboSpan" id="kobo.406.1">Easy out-of-the-box persistent volume claims. </span><span class="koboSpan" id="kobo.406.2">The same reasoning behind easy load balancers also applies to dynamic storage, which is also required for Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.407.1">Application Platform.</span></span></li>
<li><span class="koboSpan" id="kobo.408.1">Easy (albeit pricey) access to sufficient resources. </span><span class="koboSpan" id="kobo.408.2">While you can install Tanzu Application Platform on Minikube on a laptop, you’ll come up against RAM and CPU limitations. </span><span class="koboSpan" id="kobo.408.3">The public cloud options make it easy to stand up a cluster that can scale up to a size that runs Tanzu Application Platform </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">without issue.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.410.1">The Tanzu Application Platform documentation has some recommendations for RAM and CPU, but here’s what has worked </span><span class="No-Break"><span class="koboSpan" id="kobo.411.1">for me:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.412.1">One or more control plane nodes. </span><span class="koboSpan" id="kobo.412.2">If your Kubernetes cluster gives you access to the control plane, the node should have at least two vCPUs and 8 GB </span><span class="No-Break"><span class="koboSpan" id="kobo.413.1">of RAM.</span></span></li>
<li><span class="koboSpan" id="kobo.414.1">Five or more worker nodes. </span><span class="koboSpan" id="kobo.414.2">Each node should have at least two vCPUs and 8 GB </span><span class="No-Break"><span class="koboSpan" id="kobo.415.1">of RAM.</span></span></li>
</ul>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.416.1">A Tanzu </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.417.1">Network account</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.418.1">The </span><a id="_idIndexMarker616"/><span class="koboSpan" id="kobo.419.1">software </span><a id="_idIndexMarker617"/><span class="koboSpan" id="kobo.420.1">installation is via container images </span><a id="_idIndexMarker618"/><span class="koboSpan" id="kobo.421.1">hosted on the container registry associated with the Tanzu Network. </span><span class="koboSpan" id="kobo.421.2">You can sign up </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">here: </span></span><a href="https://network.tanzu.vmware.com/. "><span class="No-Break"><span class="koboSpan" id="kobo.423.1">https://network.tanzu.vmware.com/</span></span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">.</span></span></a></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.425.1">A production </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.426.1">container registry</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.427.1">Once again, there are multiple options here, but I’ll recommend two that will help </span><a id="_idIndexMarker619"/><span class="koboSpan" id="kobo.428.1">things go more smoothly. </span><span class="koboSpan" id="kobo.428.2">These require paid accounts, but they </span><a id="_idIndexMarker620"/><span class="koboSpan" id="kobo.429.1">greatly simplify the installation. </span><span class="koboSpan" id="kobo.429.2">I’ll point out that Amazon Elastic Container Registry isn’t yet supported. </span><span class="koboSpan" id="kobo.429.3">Here are the currently </span><a id="_idIndexMarker621"/><span class="koboSpan" id="kobo.430.1">supported options for a </span><span class="No-Break"><span class="koboSpan" id="kobo.431.1">container registry:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.432.1">A paid Docker </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.433.1">Hub account</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.434.1">    Docker Hub does offer a free tier, but the Tanzu Application Platform install requires a significant amount of space (at least 1 GB) and significant repeated image pushes and pulls. </span><span class="koboSpan" id="kobo.434.2">Docker limits both on their free tier and this will hinder </span><span class="No-Break"><span class="koboSpan" id="kobo.435.1">smooth operation.</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.436.1">Google Container </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.437.1">Registry (gcr.io)</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.438.1">     This is my preferred solution as you can quickly set up a registry for your GCP project and push to </span><span class="No-Break"><span class="koboSpan" id="kobo.439.1">multiple repositories.</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.440.1">Azure Container </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.441.1">Registry (azurecr.io)</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.442.1">     This is another good option, especially if you have an Azure account already </span><span class="No-Break"><span class="koboSpan" id="kobo.443.1">set up.</span></span></p>
<ul>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.444.1">Harbor (DIY)</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.445.1">    I’d urge caution in using bring-your-own Harbor unless you’re comfortable standing up trusted TLS with </span><a id="_idIndexMarker622"/><span class="koboSpan" id="kobo.446.1">a public </span><strong class="bold"><span class="koboSpan" id="kobo.447.1">certificate authority</span></strong><span class="koboSpan" id="kobo.448.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.449.1">CA</span></strong><span class="koboSpan" id="kobo.450.1">) or </span><em class="italic"><span class="koboSpan" id="kobo.451.1">Let’s Encrypt</span></em><span class="koboSpan" id="kobo.452.1">. </span><span class="koboSpan" id="kobo.452.2">If your Harbor presents a self-signed </span><a id="_idIndexMarker623"/><span class="koboSpan" id="kobo.453.1">certificate, the Tanzu Application Platform installation gets more complicated. </span><span class="koboSpan" id="kobo.453.2">Harbor works great as a container registry, but if you don’t already have it up and running, you’ll need to spend some time getting it properly </span><span class="No-Break"><span class="koboSpan" id="kobo.454.1">set up.</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.455.1">A custom domain with a </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.456.1">DNS server</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.457.1">All the public cloud providers will register a domain for you and provide DNS lookup for that domain. </span><span class="koboSpan" id="kobo.457.2">You can also do this with dedicated registrars such as GoDaddy. </span><span class="koboSpan" id="kobo.457.3">The only requirement here is that you’re able to create wildcard </span><em class="italic"><span class="koboSpan" id="kobo.458.1">A</span></em><span class="koboSpan" id="kobo.459.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.460.1">CNAME</span></em><span class="koboSpan" id="kobo.461.1"> records that </span><span class="No-Break"><span class="koboSpan" id="kobo.462.1">resolve publicly.</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.463.1">(Optional but recommended) A production </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.464.1">Git server</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.465.1">You can get through the demos without your own Git server or an account on a public service, but any significant real-world work with Tanzu Application Platform requires one. </span><span class="koboSpan" id="kobo.465.2">There are free options on GitLab (</span><a href="http://gitlab.com"><span class="koboSpan" id="kobo.466.1">gitlab.com</span></a><span class="koboSpan" id="kobo.467.1">) and GitHub (</span><a href="http://github.com"><span class="koboSpan" id="kobo.468.1">github.com</span></a><span class="koboSpan" id="kobo.469.1">) that work great for our purposes. </span><span class="koboSpan" id="kobo.469.2">You simply need to create an account and get a set of SSH or user/password credentials that the platform can use to push to and pull from a remote </span><span class="No-Break"><span class="koboSpan" id="kobo.470.1">Git repo.</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.471.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.472.1">kubcectl</span></strong><span class="koboSpan" id="kobo.473.1"> CLI as well </span><a id="_idIndexMarker624"/><span class="koboSpan" id="kobo.474.1">as the </span><em class="italic"><span class="koboSpan" id="kobo.475.1">Carvel</span></em><span class="koboSpan" id="kobo.476.1"> tools. </span><span class="koboSpan" id="kobo.476.2">You can find them at </span><a href="https://kubernetes.io/docs/tasks/tools/"><span class="koboSpan" id="kobo.477.1">https://kubernetes.io/docs/tasks/tools/</span></a><span class="koboSpan" id="kobo.478.1"> and </span><a href="https://carvel.dev/#install"><span class="koboSpan" id="kobo.479.1">https://carvel.dev/#install</span></a><span class="koboSpan" id="kobo.480.1">, respectively. </span><strong class="source-inline"><span class="koboSpan" id="kobo.481.1">Kubectl</span></strong><span class="koboSpan" id="kobo.482.1"> should be version 1.22 or 1.23. </span><span class="koboSpan" id="kobo.482.2">It should also be authorized with cluster-admin privileges on the Kubernetes cluster you’ll be installing to. </span><span class="koboSpan" id="kobo.482.3">All the Carvel tools are useful, but for this install, you only need </span><strong class="source-inline"><span class="koboSpan" id="kobo.483.1">imgpkg</span></strong><span class="koboSpan" id="kobo.484.1">. </span><span class="koboSpan" id="kobo.484.2">You’ll also need the Docker CLI installed such that you don’t need to be root to </span><span class="No-Break"><span class="koboSpan" id="kobo.485.1">run it.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.486.1">Let’s do </span><a id="_idIndexMarker625"/><span class="koboSpan" id="kobo.487.1">some quick spot-checks that we have all our prerequisites </span><span class="No-Break"><span class="koboSpan" id="kobo.488.1">in place:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.489.1">Let’s double-check our </span><em class="italic"><span class="koboSpan" id="kobo.490.1">Docker</span></em><span class="koboSpan" id="kobo.491.1"> for the dreaded </span><strong class="bold"><span class="koboSpan" id="kobo.492.1">permission denied</span></strong><span class="koboSpan" id="kobo.493.1"> error. </span><span class="koboSpan" id="kobo.493.2">This is what you can expect to see if your Docker daemon doesn’t allow </span><span class="No-Break"><span class="koboSpan" id="kobo.494.1">non-root access:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.495.1">
rob@rob-virtual-machine2:~$ docker info # no good, notice 'permission denied'</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.496.1">
Client:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.497.1">
 Context:    default</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.498.1">
 Debug Mode: false</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.499.1">
Server:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.500.1">
ERROR: Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.24/info: dial unix /var/run/docker.sock: connect: permission denied</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.501.1">
errors pretty printing info</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.502.1">
version.BuildInfo{Version:"v3.5.3", GitCommit:"041ce5a2c17a58be0fcd5f5e16fb3e7e95fea622", GitTreeState:"dirty", GoVersion:"go1.15.8"}</span></pre></li>
</ul>
<p><span class="koboSpan" id="kobo.503.1">This is what a successful installation </span><span class="No-Break"><span class="koboSpan" id="kobo.504.1">looks like:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.505.1">
rob@rob-virtual-machine2:~$ docker info # all good!
</span><span class="koboSpan" id="kobo.505.2">Client:
 Context:    default
 Debug Mode: false
Server:
 Containers: 0
  Running: 0</span></pre>
<ul>
<li><span class="koboSpan" id="kobo.506.1">Finally, let’s verify </span><strong class="source-inline"><span class="koboSpan" id="kobo.507.1">kubectl</span></strong><span class="koboSpan" id="kobo.508.1"> and our Carvel </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.509.1">imgpkg</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.510.1"> tool:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.511.1">
ubuntu@ip-172-31-33-59 ~&gt; kubectl version</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.512.1">
Client Version: version.Info{Major:"1", Minor:"22", GitVersion:"v1.22.13", GitCommit:"a43c0904d0de10f92aa3956c74489c45e6453d6e", GitTreeState:"clean", BuildDate:"2022-08-17T18:28:56Z", GoVersion:"go1.16.15", Compiler:"gc", Platform:"linux/amd64"}</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.513.1">
Server Version: version.Info{Major:"1", Minor:"22+", GitVersion:"v1.22.11-eks-18ef993", GitCommit:"b9628d6d3867ffd84c704af0befd31c7451cdc37", GitTreeState:"clean", BuildDate:"2022-07-06T18:06:23Z", GoVersion:"go1.16.15", Compiler:"gc", Platform:"linux/amd64"}</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.514.1">
ubuntu@ip-172-31-33-59 ~&gt; imgpkg version</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.515.1">
imgpkg version 0.27.0</span></pre></li>
</ul>
<p><span class="koboSpan" id="kobo.516.1">Once your </span><a id="_idIndexMarker626"/><span class="koboSpan" id="kobo.517.1">command-line tools are in order, you’re ready to proceed with installation in the </span><span class="No-Break"><span class="koboSpan" id="kobo.518.1">next section.</span></span></p>
<h2 id="_idParaDest-156"><a id="_idTextAnchor156"/><span class="koboSpan" id="kobo.519.1">Accepting end user license agreements</span></h2>
<p><span class="koboSpan" id="kobo.520.1">Before </span><a id="_idIndexMarker627"/><span class="koboSpan" id="kobo.521.1">we can commence with moving packages to our custom registry and installing them, we </span><a id="_idIndexMarker628"/><span class="koboSpan" id="kobo.522.1">need to accept the </span><strong class="bold"><span class="koboSpan" id="kobo.523.1">End User License Agreements</span></strong><span class="koboSpan" id="kobo.524.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.525.1">EULAs</span></strong><span class="koboSpan" id="kobo.526.1">). </span><span class="koboSpan" id="kobo.526.2">After logging into the Tanzu Network, navigate to the two products listed here and select the latest version of each. </span><span class="koboSpan" id="kobo.526.3">If you need to accept the EULA, you will see a yellow box right below the version dropdown. </span><span class="koboSpan" id="kobo.526.4">You can click the link in the yellow box to be prompted to accept </span><span class="No-Break"><span class="koboSpan" id="kobo.527.1">the EULA:</span></span></p>
<ul>
<li><a href="https://network.tanzu.vmware.com/products/tanzu-application-platform/"><span class="No-Break"><span class="koboSpan" id="kobo.528.1">https://network.tanzu.vmware.com/products/tanzu-application-platform/</span></span></a></li>
<li><a href="https://network.tanzu.vmware.com/products/tanzu-cluster-essentials/"><span class="No-Break"><span class="koboSpan" id="kobo.529.1">https://network.tanzu.vmware.com/products/tanzu-cluster-essentials/</span></span></a></li>
</ul>
<h2 id="_idParaDest-157"><a id="_idTextAnchor157"/><span class="koboSpan" id="kobo.530.1">Relocating Tanzu Application Platform packages</span></h2>
<p><span class="koboSpan" id="kobo.531.1">While this step isn’t absolutely necessary, it’s highly recommended to move all of the container </span><a id="_idIndexMarker629"/><span class="koboSpan" id="kobo.532.1">images from the Tanzu repository to your own. </span><span class="koboSpan" id="kobo.532.2">If you think about how Kubernetes works, when any of the dozens (or hundreds!) of pods that constitute Tanzu Application Platform needs to start or restart, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">kubelet</span></strong><span class="koboSpan" id="kobo.534.1"> process on a worker node will need to pull down that pod’s container images. </span><span class="koboSpan" id="kobo.534.2">If you don’t relocate those container images to your own registry, they’ll have to come directly from the Tanzu Network container registry, meaning you’ll have </span><strong class="source-inline"><span class="koboSpan" id="kobo.535.1">registry.tanzu.vmware.com</span></strong><span class="koboSpan" id="kobo.536.1"> in your runtime critical path. </span><span class="koboSpan" id="kobo.536.2">That means anytime you need to restart a pod on a Kubernetes worker that doesn’t already contain that pod’s container images, the Tanzu registry must be up and responsive. </span><span class="koboSpan" id="kobo.536.3">Now, the Tanzu team has very good SREs who do an excellent job of keeping the Tanzu </span><a id="_idIndexMarker630"/><span class="koboSpan" id="kobo.537.1">registry up and responsive, but their </span><strong class="bold"><span class="koboSpan" id="kobo.538.1">Service Level Objectives</span></strong><span class="koboSpan" id="kobo.539.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.540.1">SLOs</span></strong><span class="koboSpan" id="kobo.541.1">) may not line up with your apps’ SLOs, so it’s a good idea to manage your own destiny and maintain your own container registry. </span><span class="koboSpan" id="kobo.541.2">Furthermore, the Tanzu registry is shared with every other Tanzu customer, so you can’t rule out spikes in demand making container images </span><span class="No-Break"><span class="koboSpan" id="kobo.542.1">temporarily unresponsive.</span></span></p>
<p><span class="koboSpan" id="kobo.543.1">We’ll use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.544.1">imgpkg</span></strong><span class="koboSpan" id="kobo.545.1"> tool to copy all the Tanzu Application Platform images from the Tanzu registry into our custom registry. </span><span class="koboSpan" id="kobo.545.2">The examples here will use </span><strong class="source-inline"><span class="koboSpan" id="kobo.546.1">gcr.io</span></strong><span class="koboSpan" id="kobo.547.1">, but the steps are very similar for Azure Container Registry, Harbor, or </span><span class="No-Break"><span class="koboSpan" id="kobo.548.1">Docker Hub.</span></span></p>
<p><span class="koboSpan" id="kobo.549.1">First, let’s use the Docker CLI to log in to the </span><span class="No-Break"><span class="koboSpan" id="kobo.550.1">Tanzu registry:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.551.1">
ubuntu@ip-172-31-33-59 ~&gt; docker login registry.tanzu.vmware.com
Authenticating with existing credentials...
</span><span class="koboSpan" id="kobo.551.2">Login Succeeded
ubuntu@ip-172-31-33-59 ~&gt;</span></pre>
<p><span class="koboSpan" id="kobo.552.1">Then, log in once again to your personal registry. </span><span class="koboSpan" id="kobo.552.2">Here’s how you do it </span><span class="No-Break"><span class="koboSpan" id="kobo.553.1">for </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.554.1">gcr.io</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.555.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.556.1">
ubuntu@ip-172-31-33-59 ~/t/packt&gt; cat ./gcr-json-key.json | docker login -u _json_key --password-stdin gcr.io
Login Succeeded</span></pre>
<p><span class="koboSpan" id="kobo.557.1">For Docker Hub, Harbor, or Azure, you can issue </span><strong class="source-inline"><span class="koboSpan" id="kobo.558.1">docker login &lt;registry-host&gt;</span></strong><span class="koboSpan" id="kobo.559.1"> and type a username and password in at the prompts. </span><span class="koboSpan" id="kobo.559.2">At this point, we are authenticated to both the Tanzu registry and our custom registry (</span><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">gcr.io</span></strong><span class="koboSpan" id="kobo.561.1">). </span><span class="koboSpan" id="kobo.561.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.562.1">imgpkg</span></strong><span class="koboSpan" id="kobo.563.1"> tool requires the local Docker daemon to be authenticated before it can copy over </span><span class="No-Break"><span class="koboSpan" id="kobo.564.1">the images.</span></span></p>
<p><span class="koboSpan" id="kobo.565.1">Now, we </span><a id="_idIndexMarker631"/><span class="koboSpan" id="kobo.566.1">can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.567.1">imgpkg</span></strong><span class="koboSpan" id="kobo.568.1"> to pull images from the Tanzu registry and push them to our custom registry. </span><span class="koboSpan" id="kobo.568.2">We’ll set some environment variables </span><span class="No-Break"><span class="koboSpan" id="kobo.569.1">for readability:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.570.1">
ubuntu@ip-172-31-33-59:~/tap/packt$ export INSTALL_REGISTRY_USERNAME=_json_key
ubuntu@ip-172-31-33-59:~/tap/packt$ export INSTALL_REGISTRY_PASSWORD=$(cat gcr-json-key.json)
ubuntu@ip-172-31-33-59:~/tap/packt$ export INSTALL_REGISTRY_HOSTNAME=gcr.io
ubuntu@ip-172-31-33-59:~/tap/packt$ export INSTALL_REGISTRY_PROJECT_NAME=my-gcr-project
ubuntu@ip-172-31-33-59:~/tap/packt$ export TAP_VERSION=1.3.2
ubuntu@ip-172-31-33-59:~/tap/packt$ imgpkg copy -b registry.tanzu.vmware.com/tanzu-application-platform/tap-packages:${TAP_VERSION} --to-repo ${INSTALL_REGISTRY_HOSTNAME}/${INSTALL_REGISTRY_PROJECT_NAME}/tap-packages
copy | exporting 177 images...
</span><span class="koboSpan" id="kobo.570.2">copy | will export registry.tanzu.vmware.com/tanzu-application-platform/tap-packages@sha256:001224ba2c37663a9a412994f1086ddbbe40aaf959b30c465ad06c2a563f2b9f
…many, many more lines
copy | exported 177 images
copy | importing 177 images...
 </span><span class="koboSpan" id="kobo.570.3">6.77 GiB / 6.77 GiB [============================================================================================================] 100.00% 194.00 MiB/s 35s
copy | done uploading images
Succeeded</span></pre>
<p><span class="koboSpan" id="kobo.571.1">At this </span><a id="_idIndexMarker632"/><span class="koboSpan" id="kobo.572.1">point, all the container images needed to install and run Tanzu Application Platform are available at </span><strong class="source-inline"><span class="koboSpan" id="kobo.573.1">gcr.io/my-gcr-project/tap-packages</span></strong><span class="koboSpan" id="kobo.574.1">. </span><span class="koboSpan" id="kobo.574.2">Specific instructions for logging in to and relocating images into Dockerub, Harbor, and Azure are available in the Tanzu Application </span><a id="_idIndexMarker633"/><span class="koboSpan" id="kobo.575.1">Platform install documentation </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">here: </span></span><a href="https://docs.vmware.com/en/VMware-Tanzu-Application-Platform/1.3/tap/GUID-install.html#relocate-images-to-a-registry-0"><span class="No-Break"><span class="koboSpan" id="kobo.577.1">https://docs.vmware.com/en/VMware-Tanzu-Application-Platform/1.3/tap/GUID-install.html#relocate-images-to-a-registry-0</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.578.1">.</span></span></p>
<h2 id="_idParaDest-158"><a id="_idTextAnchor158"/><span class="koboSpan" id="kobo.579.1">Installing the Tanzu CLI and Tanzu Application Platform plugins</span></h2>
<p><span class="koboSpan" id="kobo.580.1">If you </span><a id="_idIndexMarker634"/><span class="koboSpan" id="kobo.581.1">don’t already have the Tanzu CLI installed from other chapters, you can do that now. </span><span class="koboSpan" id="kobo.581.2">Furthermore, even if you have the Tanzu CLI, we’ll </span><a id="_idIndexMarker635"/><span class="koboSpan" id="kobo.582.1">install some plugins to help us work more efficiently with Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.583.1">Application Platform.</span></span></p>
<p><span class="koboSpan" id="kobo.584.1">First, we’ll visit the Tanzu Application Platform page on Tanzu Network and download the CLI. </span><span class="koboSpan" id="kobo.584.2">The link is </span><span class="No-Break"><span class="koboSpan" id="kobo.585.1">here: </span></span><a href="https://network.tanzu.vmware.com/products/tanzu-application-platform/#/releases/1222090/file_groups/10484"><span class="No-Break"><span class="koboSpan" id="kobo.586.1">https://network.tanzu.vmware.com/products/tanzu-application-platform/#/releases/1222090/file_groups/10484</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.587.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.588.1">Once you’ve downloaded the </span><strong class="source-inline"><span class="koboSpan" id="kobo.589.1">tanzu-framework-bundle</span></strong><span class="koboSpan" id="kobo.590.1"> tarfile for your platform, copy it to your home directory. </span><span class="koboSpan" id="kobo.590.2">Then, on Mac and Linux, you can follow these steps. </span><span class="koboSpan" id="kobo.590.3">On Windows, you may have to adapt them a bit, or, as I would recommend, use </span><em class="italic"><span class="koboSpan" id="kobo.591.1">VirtualBox</span></em><span class="koboSpan" id="kobo.592.1"> to stand up a Linux VM and follow the </span><span class="No-Break"><span class="koboSpan" id="kobo.593.1">Linux instructions.</span></span></p>
<p><span class="koboSpan" id="kobo.594.1">Here’s the whole process. </span><span class="koboSpan" id="kobo.594.2">I’ll add some comments inline to describe what’s </span><span class="No-Break"><span class="koboSpan" id="kobo.595.1">going on:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.596.1">
ubuntu@ip-172-31-33-59:~/downloads$ mkdir -p $HOME/tanzu
ubuntu@ip-172-31-33-59:~/downloads$ tar -xvf tanzu-framework-linux-amd64.tar -C $HOME/tanzu # extract the tar file into the working directory.
</span><span class="koboSpan" id="kobo.596.2">cli/
cli/core/
cli/core/v0.11.6/
cli/core/v0.11.6/tanzu-core-linux_amd64
cli/core/plugin.yaml
cli/distribution/
cli/distribution/linux/
cli/distribution/linux/amd64/
cli/distribution/linux/amd64/cli/
cli/distribution/linux/amd64/cli/accelerator/
cli/distribution/linux/amd64/cli/accelerator/v1.2.0/
cli/distribution/linux/amd64/cli/accelerator/v1.2.0/tanzu-accelerator-linux_amd64
cli/distribution/linux/amd64/cli/package/
cli/distribution/linux/amd64/cli/package/v0.11.6/
cli/distribution/linux/amd64/cli/package/v0.11.6/tanzu-package-linux_amd64
cli/distribution/linux/amd64/cli/apps/
cli/distribution/linux/amd64/cli/apps/v0.7.0/
cli/distribution/linux/amd64/cli/apps/v0.7.0/tanzu-apps-linux_amd64
cli/distribution/linux/amd64/cli/secret/
cli/distribution/linux/amd64/cli/secret/v0.11.6/
cli/distribution/linux/amd64/cli/secret/v0.11.6/tanzu-secret-linux_amd64
cli/distribution/linux/amd64/cli/insight/
cli/distribution/linux/amd64/cli/insight/v1.2.2/
cli/distribution/linux/amd64/cli/insight/v1.2.2/tanzu-insight-linux_amd64
cli/distribution/linux/amd64/cli/services/
cli/distribution/linux/amd64/cli/services/v0.3.0/
cli/distribution/linux/amd64/cli/services/v0.3.0/tanzu-services-linux_amd64
cli/discovery/
cli/discovery/standalone/
cli/discovery/standalone/apps.yaml
cli/discovery/standalone/services.yaml
cli/discovery/standalone/secret.yaml
cli/discovery/standalone/insight.yaml
cli/discovery/standalone/package.yaml
cli/discovery/standalone/accelerator.yaml
ubuntu@ip-172-31-33-59:~/downloads$ cd $HOME/tanzu
ubuntu@ip-172-31-33-59:~/tanzu$ export VERSION=v0.11.6
ubuntu@ip-172-31-33-59:~/tanzu$ sudo install cli/core/$VERSION/tanzu-core-linux_amd64 /usr/local/bin/tanzu  # move the executable into a well-known directory and make it executable.
</span><span class="koboSpan" id="kobo.596.3">ubuntu@ip-172-31-33-59:~/tanzu$ tanzu version
version: v0.11.6
ubuntu@ip-172-31-33-59:~/tanzu$ export TANZU_CLI_NO_INIT=true # instruct the CLI not to look in external repositories for plugins
ubuntu@ip-172-31-33-59:~/tanzu$ tanzu plugin install --local cli all  # install the plugins from the distributable tar file we just unpacked
Installing plugin 'accelerator:v1.2.0'
Installing plugin 'apps:v0.7.0'
Installing plugin 'insight:v1.2.2'
Installing plugin 'package:v0.11.6'
Installing plugin 'secret:v0.11.6'
Installing plugin 'services:v0.3.0'
  successfully installed 'all' plugin
ubuntu@ip-172-31-33-59:~/tanzu$ tanzu plugin list
  NAME                DESCRIPTION                                       SCOPE       DISCOVERY  VERSION  STATUS
  login               Login to the platform                                                Standalone  default    v0.11.6  update available
  management-cluster  Kubernetes management-cluster operations                                                 Standalone  default    v0.11.6  update available
  package             Tanzu package management                                                     Standalone  default    v0.11.6  installed
  pinniped-auth       Pinniped authentication operations (usually not directly invoked)                                  Standalone  default    v0.11.6  update available
  secret              Tanzu secret management                                               Standalone  default    v0.11.6  installed
  services            Explore Service Instance Classes, discover claimable Service Instances and manage Resource Claims  Standalone             v0.3.0   installed
  apps                Applications on Kubernetes                                           Standalone             v0.7.0   installed
  insight             post &amp; query image, package, source, and vulnerability data                                        Standalone             v1.2.2   installed
  accelerator         Manage accelerators in a Kubernetes cluster                                           Standalone             v1.2.0   installed</span></pre>
<p><span class="koboSpan" id="kobo.597.1">Congratulations! </span><span class="koboSpan" id="kobo.597.2">If you </span><a id="_idIndexMarker636"/><span class="koboSpan" id="kobo.598.1">made it this far, you have </span><a id="_idIndexMarker637"/><span class="koboSpan" id="kobo.599.1">a working Tanzu CLI with all the plugins you’ll need to install and run Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.600.1">Application Platform.</span></span></p>
<h2 id="_idParaDest-159"><a id="_idTextAnchor159"/><span class="koboSpan" id="kobo.601.1">Installing Cluster Essentials</span></h2>
<p><span class="koboSpan" id="kobo.602.1">The Cluster </span><a id="_idIndexMarker638"/><span class="koboSpan" id="kobo.603.1">Essentials toolset is how we land Tanzu packages on our Kubernetes cluster. </span><span class="koboSpan" id="kobo.603.2">Perhaps you’re familiar </span><a id="_idIndexMarker639"/><span class="koboSpan" id="kobo.604.1">with tools such as Helm. </span><span class="koboSpan" id="kobo.604.2">The Cluster Essentials tools do something similar, but in addition to what Helm does, they do </span><span class="No-Break"><span class="koboSpan" id="kobo.605.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.606.1">Store a desired application state in etcd as a CR so the application can be </span><span class="No-Break"><span class="koboSpan" id="kobo.607.1">continuously reconciled</span></span></li>
<li><span class="koboSpan" id="kobo.608.1">Manage a complex hierarchy </span><span class="No-Break"><span class="koboSpan" id="kobo.609.1">of dependencies</span></span></li>
<li><span class="koboSpan" id="kobo.610.1">Store and maintain templatized app configuration in such a way as to avoid </span><span class="No-Break"><span class="koboSpan" id="kobo.611.1">configuration drift</span></span></li>
<li><span class="koboSpan" id="kobo.612.1">Allow selective sharing of secrets </span><span class="No-Break"><span class="koboSpan" id="kobo.613.1">across namespaces</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.614.1">I won’t sugarcoat the fact that Tanzu Application Platform is a complex piece of software, and it needs a fully realized enterprise-ready toolset to install it onto Kubernetes and keep it running smoothly. </span><span class="koboSpan" id="kobo.614.2">Cluster Essentials is </span><span class="No-Break"><span class="koboSpan" id="kobo.615.1">that toolset.</span></span></p>
<p><span class="koboSpan" id="kobo.616.1">To install Cluster Essentials, we follow a similar script to what we did for the CLI. </span><span class="koboSpan" id="kobo.616.2">In this case, we need to make sure that </span><strong class="source-inline"><span class="koboSpan" id="kobo.617.1">kubectl</span></strong><span class="koboSpan" id="kobo.618.1"> is pointing to the Kubernetes cluster we plan on </span><a id="_idIndexMarker640"/><span class="koboSpan" id="kobo.619.1">deploying to as the install </span><a id="_idIndexMarker641"/><span class="koboSpan" id="kobo.620.1">script will initiate the deployment. </span><span class="koboSpan" id="kobo.620.2">Once again, I’ll narrate the process </span><span class="No-Break"><span class="koboSpan" id="kobo.621.1">with comments:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.622.1">
ubuntu@ip-172-31-33-59:~/downloads$ mkdir -p $HOME/tanzu-cluster-essentials  # create working directory
ubuntu@ip-172-31-33-59:~/downloads$ ls # check our downloaded file
tanzu-cluster-essentials-linux-amd64-1.2.0.tgz
ubuntu@ip-172-31-33-59:~/downloads$ tar xvf ./tanzu-cluster-essentials-linux-amd64-1.2.0.tgz -C $HOME/tanzu-cluster-essentials    # unzip the downloaded file into the working directory
install.sh
uninstall.sh
imgpkg
kbld
kapp
ytt
ubuntu@ip-172-31-33-59:~/downloads$ cd $HOME/tanzu-cluster-essentials
ubuntu@ip-172-31-33-59:~/tanzu-cluster-essentials$ kubectl config get-contexts  # check our Kubernetes cluster
*         user@tap-install.us-west-2.eksctl.io             tap-install.us-west-2.eksctl.io                          user@tap-install.us-west-2.eksctl.io
ubuntu@ip-172-31-33-59:~/tanzu-cluster-essentials$ export INSTALL_BUNDLE=registry.tanzu.vmware.com/tanzu-cluster-essentials/cluster-essentials-bundle@sha256:e00f33b92d418f49b1af79f42cb13d6765f1c8c731f4528dfff8343af042dc3e   # Set some env vars for the install script to use
ubuntu@ip-172-31-33-59:~/tanzu-cluster-essentials$ export INSTALL_REGISTRY_HOSTNAME=registry.tanzu.vmware.com
ubuntu@ip-172-31-33-59:~/tanzu-cluster-essentials$ export INSTALL_REGISTRY_USERNAME=myuser@myemail.com
ubuntu@ip-172-31-33-59:~/tanzu-cluster-essentials$ export INSTALL_REGISTRY_PASSWORD=&lt;my_super_secret_password&gt;
ubuntu@ip-172-31-33-59:~/tanzu-cluster-essentials$ ./install.sh  # this will install the kapp and secretgen controllers onto our Kubernetes cluster
## Creating namespace tanzu-cluster-essentials
namespace/tanzu-cluster-essentials created
… much more output
Succeeded
ubuntu@ip-172-31-33-59:~/tanzu-cluster-essentials$</span></pre>
<p><span class="koboSpan" id="kobo.623.1">As the </span><em class="italic"><span class="koboSpan" id="kobo.624.1">kapp</span></em><span class="koboSpan" id="kobo.625.1"> CLI waits for the install to complete successfully, you’ll see quite a lot of output to </span><a id="_idIndexMarker642"/><span class="koboSpan" id="kobo.626.1">the console describing the </span><a id="_idIndexMarker643"/><span class="koboSpan" id="kobo.627.1">progress of the install. </span><span class="koboSpan" id="kobo.627.2">If you get the </span><strong class="source-inline"><span class="koboSpan" id="kobo.628.1">Succeeded</span></strong><span class="koboSpan" id="kobo.629.1"> message at the end, you know that the installation did in fact succeed. </span><span class="koboSpan" id="kobo.629.2">Now that you have Cluster Essentials installed and the installation packages relocated, we’re almost ready to install Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.630.1">Application Platform.</span></span></p>
<h2 id="_idParaDest-160"><a id="_idTextAnchor160"/><span class="koboSpan" id="kobo.631.1">Setting up a developer namespace</span></h2>
<p><span class="koboSpan" id="kobo.632.1">The Tanzu Application Platform official documentation puts this step after the install, but I find </span><a id="_idIndexMarker644"/><span class="koboSpan" id="kobo.633.1">that the install goes more smoothly if we do it first. </span><span class="koboSpan" id="kobo.633.2">This step involves creating a secret in a namespace where developers will deploy a workload as well as some Kubernetes RBAC artifacts so that the namespace’s default service account can interact with the CRs that make up Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.634.1">Application Platform.</span></span></p>
<p><span class="koboSpan" id="kobo.635.1">First, let’s create the namespace and add a secret to it that will allow us to read from and write to our container registry. </span><span class="koboSpan" id="kobo.635.2">This example works for </span><strong class="source-inline"><span class="koboSpan" id="kobo.636.1">gcr.io</span></strong><span class="koboSpan" id="kobo.637.1">, as we need to pass the password as a file. </span><span class="koboSpan" id="kobo.637.2">To create a secret for Azure, Docker Hub, or Harbor, you would use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.638.1">--username</span></strong><span class="koboSpan" id="kobo.639.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.640.1">--password</span></strong><span class="koboSpan" id="kobo.641.1"> flags. </span><span class="koboSpan" id="kobo.641.2">My namespace-naming preference is </span><strong class="source-inline"><span class="koboSpan" id="kobo.642.1">workload1</span></strong><span class="koboSpan" id="kobo.643.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.644.1">workload2</span></strong><span class="koboSpan" id="kobo.645.1">, and so on. </span><span class="koboSpan" id="kobo.645.2">This makes it clear to anyone perusing the cluster where the workloads </span><span class="No-Break"><span class="koboSpan" id="kobo.646.1">are running:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.647.1">
ubuntu@ip-172-31-33-59 ~/t/packt&gt; kubectl create ns workload1
namespace/workload1 created
ubuntu@ip-172-31-33-59 ~/t/packt&gt; tanzu secret registry add registry-credentials --server gcr.io --username _json_key --password-file ./gcr-json-key.json -n workload1
| Adding registry secret 'registry-credentials'...
 </span><span class="koboSpan" id="kobo.647.2">Added registry secret 'registry-credentials' into namespace 'workload1'
ubuntu@ip-172-31-33-59 ~/t/packt&gt;</span></pre>
<p><span class="koboSpan" id="kobo.648.1">Next, we need to give the default service account in our namespace some roles and secrets </span><a id="_idIndexMarker645"/><span class="koboSpan" id="kobo.649.1">that will enable Tanzu Application Platform workloads to run in this namespace with the default </span><span class="No-Break"><span class="koboSpan" id="kobo.650.1">service account:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.651.1">
ubuntu@ip-172-31-33-59:~/tap/packt$ cat &lt;&lt;EOF | kubectl -n workload1 apply -f –
apiVersion: v1
kind: Secret
metadata:
  name: tap-registry
  annotations:
    secretgen.carvel.dev/image-pull-secret: ""
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: e30K
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: default
secrets:
  - name: registry-credentials
imagePullSecrets:
  - name: registry-credentials
  - name: tap-registry
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: default-permit-deliverable
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: deliverable
subjects:
  - kind: ServiceAccount
    name: default
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: default-permit-workload
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: workload
subjects:
  - kind: ServiceAccount
    name: default
EOF
secret/tap-registry created
serviceaccount/default configured
rolebinding.rbac.authorization.k8s.io/default-permit-deliverable created
rolebinding.rbac.authorization.k8s.io/default-permit-workload created
ubuntu@ip-172-31-33-59:~/tap/packt$</span></pre>
<p><span class="koboSpan" id="kobo.652.1">Next, we’ll </span><a id="_idIndexMarker646"/><span class="koboSpan" id="kobo.653.1">proceed to install some tools that run on our Kubernetes cluster that will manage the installation </span><span class="No-Break"><span class="koboSpan" id="kobo.654.1">for us.</span></span></p>
<h2 id="_idParaDest-161"><a id="_idTextAnchor161"/><span class="koboSpan" id="kobo.655.1">Installing a package repository</span></h2>
<p><span class="koboSpan" id="kobo.656.1">Now we </span><a id="_idIndexMarker647"/><span class="koboSpan" id="kobo.657.1">have all the client- and server-side tools ready to go, we can finally kick off our install. </span><span class="koboSpan" id="kobo.657.2">First, we need to set up a package repository. </span><span class="koboSpan" id="kobo.657.3">This is like a Docker or Apt repository. </span><span class="koboSpan" id="kobo.657.4">It’s simply a service on the network that stores and serves software packages. </span><span class="koboSpan" id="kobo.657.5">In this case, we’re installing a </span><em class="italic"><span class="koboSpan" id="kobo.658.1">Kapp</span></em><span class="koboSpan" id="kobo.659.1"> package repository on our Kubernetes cluster from which the Kapp controller can install packages. </span><span class="koboSpan" id="kobo.659.2">Previously, we relocated packages from the Tanzu registry to our own container registry. </span><span class="koboSpan" id="kobo.659.3">One of those packages is called </span><strong class="source-inline"><span class="koboSpan" id="kobo.660.1">tap</span></strong><span class="koboSpan" id="kobo.661.1">. </span><span class="koboSpan" id="kobo.661.2">That </span><strong class="source-inline"><span class="koboSpan" id="kobo.662.1">tap</span></strong><span class="koboSpan" id="kobo.663.1"> package functions as our repository. </span><span class="koboSpan" id="kobo.663.2">It knows about all the other packages in the container registry. </span><span class="koboSpan" id="kobo.663.3">This will make more sense shortly. </span><span class="koboSpan" id="kobo.663.4">This repository and all its packages will live in their own namespace on our Kubernetes cluster. </span><span class="koboSpan" id="kobo.663.5">We’ll assume that you still have your </span><a id="_idIndexMarker648"/><span class="koboSpan" id="kobo.664.1">environment variables set from when we relocated the images. </span><span class="koboSpan" id="kobo.664.2">If they’re not set, you’ll need to go back and set </span><span class="No-Break"><span class="koboSpan" id="kobo.665.1">them again:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.666.1">
ubuntu@ip-172-31-33-59:~/tap/packt$ kubectl create ns tap-install
namespace/tap-install created
ubuntu@ip-172-31-33-59:~/tap/packt$ tanzu package repository add tanzu-tap-repository --url ${INSTALL_REGISTRY_HOSTNAME}/${INSTALL_REGISTRY_PROJECT_NAME}/tap-packages:${TAP_VERSION} -n tap-install
 Adding package repository 'tanzu-tap-repository'
 Validating provided settings for the package repository
 Creating package repository resource
 Waiting for 'PackageRepository' reconciliation for 'tanzu-tap-repository'
 'PackageRepository' resource install status: Reconciling
 'PackageRepository' resource install status: ReconcileSucceeded
Added package repository 'tanzu-tap-repository' in namespace 'tap-install'
ubuntu@ip-172-31-33-59:~/tap/packt$ tanzu package repository get tanzu-tap-repository --namespace tap-install
NAME:          tanzu-tap-repository
VERSION:       789358
REPOSITORY:    gcr.io/fe-rhardt/tap-packages
TAG:           1.2.1
STATUS:        Reconcile succeeded
REASON:
ubuntu@ip-172-31-33-59:~/tap/packt$ tanzu package available list --namespace tap-install
  NAME                                                 DISPLAY-NAME                                              SHORT-DESCRIPTION                                                                LATEST-VERSION
  accelerator.apps.tanzu.vmware.com                    Application Accelerator for VMware Tanzu                                  Used to create new projects and configurations.                                               1.2.2
  api-portal.tanzu.vmware.com                          API portal                                                     A unified user interface to enable search, discovery and try-out of API endpoints at ease.
</span><span class="koboSpan" id="kobo.666.2"># … many more …</span></pre>
<p><span class="koboSpan" id="kobo.667.1">Now, we’ll install these packages to stand up a running instance of Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.668.1">Application Platform.</span></span></p>
<h2 id="_idParaDest-162"><a id="_idTextAnchor162"/><span class="koboSpan" id="kobo.669.1">Pulling down and formatting tap-values.yaml</span></h2>
<p><span class="koboSpan" id="kobo.670.1">Next, we need </span><a id="_idIndexMarker649"/><span class="koboSpan" id="kobo.671.1">a config file to install Tanzu Application Platform. </span><span class="koboSpan" id="kobo.671.2">You can pull down this file as a starting </span><span class="No-Break"><span class="koboSpan" id="kobo.672.1">point: </span></span><a href="https://github.com/PacktPublishing/DevSecOps-in-Practice-with-VMware-Tanzu/blob/main/chapter-09/tap-values.yaml"><span class="No-Break"><span class="koboSpan" id="kobo.673.1">https://github.com/PacktPublishing/DevSecOps-in-Practice-with-VMware-Tanzu/blob/main/chapter-09/tap-values.yaml</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.674.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.675.1">Once you have that file locally, follow the inline instructions to plug in registry credentials and domain information. </span><span class="koboSpan" id="kobo.675.2">Once that file is filled out, we can install the </span><strong class="source-inline"><span class="koboSpan" id="kobo.676.1">tap</span></strong><span class="koboSpan" id="kobo.677.1"> package from our package repository, referencing </span><span class="No-Break"><span class="koboSpan" id="kobo.678.1">that file:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.679.1">
ubuntu@ip-172-31-33-59:~/tap/packt$ tanzu package install tap -p tap.tanzu.vmware.com -v $TAP_VERSION --values-file tap-values.yaml -n tap-install
 Installing package 'tap.tanzu.vmware.com'
 Getting package metadata for 'tap.tanzu.vmware.com'
 Creating service account 'tap-tap-install-sa'
 Creating cluster admin role 'tap-tap-install-cluster-role'
 Creating cluster role binding 'tap-tap-install-cluster-rolebinding'
 Creating secret 'tap-tap-install-values'
 Creating package resource
 Waiting for 'PackageInstall' reconciliation for 'tap'
\ 'PackageInstall' resource install status: Reconciling</span></pre>
<p><span class="koboSpan" id="kobo.680.1">This installation can take several minutes. </span><span class="koboSpan" id="kobo.680.2">Furthermore, it will sometimes tell you that it failed </span><a id="_idIndexMarker650"/><span class="koboSpan" id="kobo.681.1">when in truth, a component was taking a little too long. </span><span class="koboSpan" id="kobo.681.2">One thing you can do to get a little more feedback on the install is to monitor the </span><strong class="bold"><span class="koboSpan" id="kobo.682.1">PackageInstall</span></strong><span class="koboSpan" id="kobo.683.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.684.1">pkgi</span></strong><span class="koboSpan" id="kobo.685.1">) objects </span><span class="No-Break"><span class="koboSpan" id="kobo.686.1">in Kubernetes:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.687.1">
ubuntu@ip-172-31-33-59 ~&gt; kubectl get pkgi -n tap-install -w
NAME                       PACKAGE NAME                                         PACKAGE VERSION   DESCRIPTION           AGE
api-portal                 api-portal.tanzu.vmware.com                          1.0.24            Reconcile succeeded   72s
appliveview-connector      connector.appliveview.tanzu.vmware.com               1.2.1             Reconcile succeeded   72s
appsso                     sso.apps.tanzu.vmware.com                            1.0.0             Reconcile succeeded   38s
buildservice               buildservice.tanzu.vmware.com                        1.6.1             Reconciling           72s
cartographer               cartographer.tanzu.vmware.com                        0.4.3             Reconcile succeeded   38s</span></pre>
<p><span class="koboSpan" id="kobo.688.1">Congratulations! </span><span class="koboSpan" id="kobo.688.2">You have a running instance of Tanzu Application Platform. </span><span class="koboSpan" id="kobo.688.3">Now let’s configure the remaining components necessary for you to interact </span><span class="No-Break"><span class="koboSpan" id="kobo.689.1">with it.</span></span></p>
<h2 id="_idParaDest-163"><a id="_idTextAnchor163"/><span class="koboSpan" id="kobo.690.1">Creating DNS records</span></h2>
<p><span class="koboSpan" id="kobo.691.1">Once </span><a id="_idIndexMarker651"/><span class="koboSpan" id="kobo.692.1">you’ve installed Tanzu Application </span><a id="_idIndexMarker652"/><span class="koboSpan" id="kobo.693.1">Platform, you’ll want to be able to reach the tools and deployed applications from a web browser. </span><span class="koboSpan" id="kobo.693.2">This is where you go to your domain’s DNS service and point it at your Tanzu Application Platform installation. </span><span class="koboSpan" id="kobo.693.3">First, let’s find out the endpoint of our load balancer service and point a wildcard DNS entry </span><span class="No-Break"><span class="koboSpan" id="kobo.694.1">at it:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.695.1">
ubuntu@ip-172-31-33-59 ~&gt; kubectl get svc -n tanzu-system-ingress envoy
NAME    TYPE           CLUSTER-IP       EXTERNAL-IP                         PORT(S)                      AGE
envoy   LoadBalancer   10.100.247.164   accd60a8feb5740b1ac24853ea17e546-817853481.us-west-2.elb.amazonaws.com   80:30409/TCP,443:30100/TCP   10m
ubuntu@ip-172-31-33-59 ~&gt;</span></pre>
<p><span class="koboSpan" id="kobo.696.1">In this case, the envoy service in </span><strong class="source-inline"><span class="koboSpan" id="kobo.697.1">tanzu-system-ingress</span></strong><span class="koboSpan" id="kobo.698.1"> has a hostname as it’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.699.1">EXTERNAL-IP</span></strong><span class="koboSpan" id="kobo.700.1">. </span><span class="koboSpan" id="kobo.700.2">If I controlled </span><strong class="source-inline"><span class="koboSpan" id="kobo.701.1">mydomain.com</span></strong><span class="koboSpan" id="kobo.702.1">, I would go into the DNS configuration settings for my domain and create a CNAME record, </span><strong class="source-inline"><span class="koboSpan" id="kobo.703.1">*.mydomain.com</span></strong><span class="koboSpan" id="kobo.704.1">, and point it to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.705.1">LoadBalancer</span></strong><span class="koboSpan" id="kobo.706.1"> host from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.707.1">kubectl</span></strong><span class="koboSpan" id="kobo.708.1"> command. </span><span class="koboSpan" id="kobo.708.2">In you’re using Azure or GCP, you might get an IPv4 address rather than a hostname. </span><span class="koboSpan" id="kobo.708.3">In that case, you’ll need to create an </span><strong class="source-inline"><span class="koboSpan" id="kobo.709.1">A</span></strong><span class="koboSpan" id="kobo.710.1"> record rather than </span><span class="No-Break"><span class="koboSpan" id="kobo.711.1">a CNAME.</span></span></p>
<p><span class="koboSpan" id="kobo.712.1">Here’s a </span><a id="_idIndexMarker653"/><span class="koboSpan" id="kobo.713.1">real-world example. </span><span class="koboSpan" id="kobo.713.2">I did my </span><a id="_idIndexMarker654"/><span class="koboSpan" id="kobo.714.1">Tanzu Application Platform install with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.715.1">*.packtinstall.k10s.io</span></strong><span class="koboSpan" id="kobo.716.1"> domain. </span><span class="koboSpan" id="kobo.716.2">After configuring my DNS records properly, I can use the dig command to verify that any subdomain of </span><strong class="source-inline"><span class="koboSpan" id="kobo.717.1">packtinstall.k10s.io</span></strong><span class="koboSpan" id="kobo.718.1"> will return a CNAME pointing to the AWS load balancer associated with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.719.1">tanzu-system-ingress/envoy</span></strong><span class="koboSpan" id="kobo.720.1"> Kubernetes </span><span class="No-Break"><span class="koboSpan" id="kobo.721.1">LoadBalancer service:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.722.1">
ubuntu@ip-172-31-33-59 ~&gt; dig testing123.packtinstall.k10s.io
; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; testing123.packtinstall.k10s.io
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 17729
;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1
;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;testing123.packtinstall.k10s.io. </span><span class="koboSpan" id="kobo.722.2">IN A
;; ANSWER SECTION:
testing123.packtinstall.k10s.io. </span><span class="koboSpan" id="kobo.722.3">300 IN    CNAME    accd60a8feb5740b1ac24853ea17e546-817853481.us-west-2.elb.amazonaws.com.
</span><span class="koboSpan" id="kobo.722.4">accd60a8feb5740b1ac24853ea17e546-817853481.us-west-2.elb.amazonaws.com.  59 IN A    52.10.176.193
accd60a8feb5740b1ac24853ea17e546-817853481.us-west-2.elb.amazonaws.com.  59 IN A    35.155.17.135
accd60a8feb5740b1ac24853ea17e546-817853481.us-west-2.elb.amazonaws.com.  59 IN A    54.213.143.29</span></pre>
<p><span class="koboSpan" id="kobo.723.1">Now, if everything </span><a id="_idIndexMarker655"/><span class="koboSpan" id="kobo.724.1">worked perfectly </span><a id="_idIndexMarker656"/><span class="koboSpan" id="kobo.725.1">the first time, you should be able to access the Tanzu Application Platform GUI with a browser pointed to </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.726.1">tap-gui.&lt;your-domain&gt;.com</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.727.1">. </span><span class="koboSpan" id="kobo.727.2">Success!</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer155">
<span class="koboSpan" id="kobo.728.1"><img alt="Figure ﻿8.5 – Tanzu Application Platform GUI" src="image/B18145_08_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.729.1">Figure 8.5 – Tanzu Application Platform GUI</span></p>
<p><span class="koboSpan" id="kobo.730.1">I’d encourage </span><a id="_idIndexMarker657"/><span class="koboSpan" id="kobo.731.1">you to explore the </span><em class="italic"><span class="koboSpan" id="kobo.732.1">TAP GUI</span></em><span class="koboSpan" id="kobo.733.1">. </span><em class="italic"><span class="koboSpan" id="kobo.734.1">Chapters 2</span></em><span class="koboSpan" id="kobo.735.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.736.1">5</span></em><span class="koboSpan" id="kobo.737.1"> of this book cover the Application Accelerator and API Portal </span><a id="_idIndexMarker658"/><span class="koboSpan" id="kobo.738.1">components in detail. </span><span class="koboSpan" id="kobo.738.2">Next, let’s install some local developer tools to enhance our experience interacting with Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.739.1">Application Platform.</span></span></p>
<h2 id="_idParaDest-164"><a id="_idTextAnchor164"/><span class="koboSpan" id="kobo.740.1">Installing the VS Code developer tools</span></h2>
<p><span class="koboSpan" id="kobo.741.1">To really see Tanzu Application Platform in action, it’s helpful to set up a true-to-life developer </span><a id="_idIndexMarker659"/><span class="koboSpan" id="kobo.742.1">toolchain. </span><span class="koboSpan" id="kobo.742.2">At this point, you have a Kubernetes cluster running Tanzu Application Platform </span><a id="_idIndexMarker660"/><span class="koboSpan" id="kobo.743.1">and you have </span><strong class="source-inline"><span class="koboSpan" id="kobo.744.1">kubectl</span></strong><span class="koboSpan" id="kobo.745.1"> and the Tanzu CLI with the necessary plugins. </span><span class="koboSpan" id="kobo.745.2">With just a few more additions, we’ll have </span><span class="No-Break"><span class="koboSpan" id="kobo.746.1">that toolchain.</span></span></p>
<p><span class="koboSpan" id="kobo.747.1">First, if you don’t already have it, download and install VS Code from here: </span><a href="https://code.visualstudio.com/download"><span class="koboSpan" id="kobo.748.1">https://code.visualstudio.com/download</span></a><span class="koboSpan" id="kobo.749.1">. </span><span class="koboSpan" id="kobo.749.2">Then, download and install Tilt from here: </span><a href="https://docs.tilt.dev/install.html"><span class="koboSpan" id="kobo.750.1">https://docs.tilt.dev/install.html</span></a><span class="koboSpan" id="kobo.751.1">. </span><span class="koboSpan" id="kobo.751.2">Finally, download the developer tools for VS Code from Tanzu Network here: </span><a href="https://network.tanzu.vmware.com/products/tanzu-application-platform"><span class="koboSpan" id="kobo.752.1">https://network.tanzu.vmware.com/products/tanzu-application-platform</span></a><span class="koboSpan" id="kobo.753.1">. </span><span class="koboSpan" id="kobo.753.2">You install the developer tools from the VS Code Command Palette. </span><span class="koboSpan" id="kobo.753.3">You can open the Command Palette from the </span><strong class="bold"><span class="koboSpan" id="kobo.754.1">View</span></strong><span class="koboSpan" id="kobo.755.1"> menu. </span><span class="koboSpan" id="kobo.755.2">Then, start typing </span><strong class="source-inline"><span class="koboSpan" id="kobo.756.1">Extensions: Install from VSIX</span></strong><span class="koboSpan" id="kobo.757.1">. </span><span class="koboSpan" id="kobo.757.2">Once the auto-complete comes up, select that option, and navigate to the VSIX file you just downloaded to </span><span class="No-Break"><span class="koboSpan" id="kobo.758.1">install it.</span></span></p>
<p><span class="koboSpan" id="kobo.759.1">Congratulations! </span><span class="koboSpan" id="kobo.759.2">You’ve completed the installation and configuration of a very complex piece </span><a id="_idIndexMarker661"/><span class="koboSpan" id="kobo.760.1">of software. </span><span class="koboSpan" id="kobo.760.2">Our day-1 tasks </span><a id="_idIndexMarker662"/><span class="koboSpan" id="kobo.761.1">are complete. </span><span class="koboSpan" id="kobo.761.2">Now, let’s move on to day 2 and put our powerful new toolkit </span><span class="No-Break"><span class="koboSpan" id="kobo.762.1">to use!</span></span></p>
<h1 id="_idParaDest-165"><a id="_idTextAnchor165"/><span class="koboSpan" id="kobo.763.1">Day 2 – deploying applications to Tanzu Application Platform</span></h1>
<p><span class="koboSpan" id="kobo.764.1">In </span><a href="B18145_02.xhtml#_idTextAnchor033"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.765.1">Chapter 2</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.766.1">, Developing Cloud-Native Applications</span></em><span class="koboSpan" id="kobo.767.1">, we went in depth into Application Accelerator. </span><span class="koboSpan" id="kobo.767.2">To deploy an application to Tanzu Application Platform, we’ll revisit that product. </span><span class="koboSpan" id="kobo.767.3">Navigate to the </span><em class="italic"><span class="koboSpan" id="kobo.768.1">TAP GUI</span></em><span class="koboSpan" id="kobo.769.1"> that you just </span><a id="_idIndexMarker663"/><span class="koboSpan" id="kobo.770.1">finished installing. </span><span class="koboSpan" id="kobo.770.2">It should be at </span><strong class="source-inline"><span class="koboSpan" id="kobo.771.1">tap-gui.&lt;your-domain&gt;</span></strong><span class="koboSpan" id="kobo.772.1">. </span><span class="koboSpan" id="kobo.772.2">Then, in the menu down the left-hand side, click on </span><strong class="bold"><span class="koboSpan" id="kobo.773.1">Create</span></strong><span class="koboSpan" id="kobo.774.1">. </span><span class="koboSpan" id="kobo.774.2">Finally, select the accelerator called </span><strong class="bold"><span class="koboSpan" id="kobo.775.1">Tanzu Java Web App</span></strong><span class="koboSpan" id="kobo.776.1">. </span><span class="koboSpan" id="kobo.776.2">When you select it, you’ll be prompted for a name, which you can leave as is, and a container registry prefix. </span><span class="koboSpan" id="kobo.776.3">If you’re using </span><strong class="source-inline"><span class="koboSpan" id="kobo.777.1">gcr.io</span></strong><span class="koboSpan" id="kobo.778.1">, it might be something such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.779.1">gcr.io/&lt;your-project-id&gt;/tanzu-java-web-app</span></strong><span class="koboSpan" id="kobo.780.1">. </span><span class="koboSpan" id="kobo.780.2">The value you provide will be used in the Tiltfile to tell the Tilt tool where to push your app’s source code so it can be picked up by a Tanzu Application Platform supply chain. </span><span class="koboSpan" id="kobo.780.3">This will make more sense shortly. </span><span class="koboSpan" id="kobo.780.4">Here’s a reminder of what the accelerator screen should </span><span class="No-Break"><span class="koboSpan" id="kobo.781.1">look like:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer156">
<span class="koboSpan" id="kobo.782.1"><img alt="Figure ﻿8.6 – Filling out the Accelerator form" src="image/B18145_08_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.783.1">Figure 8.6 – Filling out the Accelerator form</span></p>
<p><span class="koboSpan" id="kobo.784.1">Once you click </span><strong class="bold"><span class="koboSpan" id="kobo.785.1">NEXT</span></strong><span class="koboSpan" id="kobo.786.1">, you’ll shortly be presented with a button to download the ZIP file. </span><span class="koboSpan" id="kobo.786.2">Download </span><a id="_idIndexMarker664"/><span class="koboSpan" id="kobo.787.1">the ZIP, unzip it, and open VS Code to the application directory you just unzipped. </span><span class="koboSpan" id="kobo.787.2">Then, we’ll need to update a couple of settings in VS Code. </span><span class="koboSpan" id="kobo.787.3">Go into the VS Code Settings window and navigate to </span><strong class="bold"><span class="koboSpan" id="kobo.788.1">Extensions</span></strong><span class="koboSpan" id="kobo.789.1"> | </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.790.1">Tanzu</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.791.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.792.1">Set </span><strong class="bold"><span class="koboSpan" id="kobo.793.1">Local Path</span></strong><span class="koboSpan" id="kobo.794.1"> to the path of the unzipped application; or, if your VS Code file window is set to the root directory of the application, you can just leave this field blank. </span><span class="koboSpan" id="kobo.794.2">Set </span><strong class="bold"><span class="koboSpan" id="kobo.795.1">Namespace</span></strong><span class="koboSpan" id="kobo.796.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.797.1">workload1</span></strong><span class="koboSpan" id="kobo.798.1"> or whichever namespace you set up for developer use in the previous steps. </span><span class="koboSpan" id="kobo.798.2">Finally, double-check that </span><strong class="bold"><span class="koboSpan" id="kobo.799.1">Source Image</span></strong><span class="koboSpan" id="kobo.800.1"> is set to your preferred container registry. </span><span class="koboSpan" id="kobo.800.2">If you’re using </span><strong class="source-inline"><span class="koboSpan" id="kobo.801.1">gcr.io</span></strong><span class="koboSpan" id="kobo.802.1">, it might be </span><strong class="source-inline"><span class="koboSpan" id="kobo.803.1">gcr.io/&lt;your-project-id&gt;/tanzu-java-web-app-remote-src</span></strong><span class="koboSpan" id="kobo.804.1">, depending on what you supplied to the Application Accelerator UI in the previous steps. </span><span class="koboSpan" id="kobo.804.2">Here’s what my settings </span><span class="No-Break"><span class="koboSpan" id="kobo.805.1">look like:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer157">
<span class="koboSpan" id="kobo.806.1"><img alt="Figure ﻿8.7 – VS Code developer settings" src="image/B18145_08_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.807.1">Figure 8.7 – VS Code developer settings</span></p>
<p><span class="koboSpan" id="kobo.808.1">Now, you </span><a id="_idIndexMarker665"/><span class="koboSpan" id="kobo.809.1">can close the </span><strong class="bold"><span class="koboSpan" id="kobo.810.1">Settings</span></strong><span class="koboSpan" id="kobo.811.1"> tab. </span><span class="koboSpan" id="kobo.811.2">In the </span><strong class="bold"><span class="koboSpan" id="kobo.812.1">file</span></strong><span class="koboSpan" id="kobo.813.1"> pane, look for a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.814.1">Tiltfile</span></strong><span class="koboSpan" id="kobo.815.1">. </span><span class="koboSpan" id="kobo.815.2">When you right-click on the Tiltfile, you should see the </span><strong class="bold"><span class="koboSpan" id="kobo.816.1">Tanzu: Live Update Start</span></strong><span class="koboSpan" id="kobo.817.1"> option. </span><span class="koboSpan" id="kobo.817.2">The following screenshot gives you a good idea of what to </span><span class="No-Break"><span class="koboSpan" id="kobo.818.1">look for:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer158">
<span class="koboSpan" id="kobo.819.1"><img alt="Figure ﻿8.8 – Tanzu Java web app in VS Code" src="image/B18145_08_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.820.1">Figure 8.8 – Tanzu Java web app in VS Code</span></p>
<p><span class="koboSpan" id="kobo.821.1">Let’s try to start the live update by clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.822.1">Tanzu: Live Update Start</span></strong><span class="koboSpan" id="kobo.823.1"> context menu item. </span><span class="koboSpan" id="kobo.823.2">It’s likely that you’ll be met with a message </span><span class="No-Break"><span class="koboSpan" id="kobo.824.1">like this:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.825.1">
*  Executing task: tilt: up - /Users/roberthardt/Downloads/tanzu-java-web-app 2/Tiltfile
Tilt started on http://localhost:10350/
v0.26.3, built 2022-03-24
Initial Build
Loading Tiltfile at: /Users/roberthardt/Downloads/tanzu-java-web-app 2/Tiltfile
ERROR: Stop! </span><span class="koboSpan" id="kobo.825.2">user@tap-install.us-west-2.eksctl.io might be production.
</span><span class="koboSpan" id="kobo.825.3">If you're sure you want to deploy there, add:
        allow_k8s_contexts('user@tap-install.us-west-2.eksctl.io')
to your Tiltfile. </span><span class="koboSpan" id="kobo.825.4">Otherwise, switch k8s contexts and restart Tilt.</span></pre>
<p><span class="koboSpan" id="kobo.826.1">No worries. </span><span class="koboSpan" id="kobo.826.2">The Tilt tool is being extra cautious that you don’t accidentally start a live update </span><a id="_idIndexMarker666"/><span class="koboSpan" id="kobo.827.1">session in a production environment. </span><span class="koboSpan" id="kobo.827.2">Follow the instructions and add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.828.1">allow_k8s_contexts('&lt;your-k8s-context&gt;')</span></strong><span class="koboSpan" id="kobo.829.1"> command to the bottom of the Tiltfile, then </span><span class="No-Break"><span class="koboSpan" id="kobo.830.1">try again.</span></span></p>
<p><span class="koboSpan" id="kobo.831.1">The first deployment may take a while, but eventually, you can open a terminal and look at all the pods in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.832.1">workload1</span></strong><span class="koboSpan" id="kobo.833.1"> namespace (</span><strong class="source-inline"><span class="koboSpan" id="kobo.834.1">kubectl get pods -n workload1</span></strong><span class="koboSpan" id="kobo.835.1">), and see something </span><span class="No-Break"><span class="koboSpan" id="kobo.836.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer159">
<span class="koboSpan" id="kobo.837.1"><img alt="Figure ﻿8.9 – Pod listing of ﻿the running app" src="image/B18145_08_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.838.1">Figure 8.9 – Pod listing of the running app</span></p>
<p><span class="koboSpan" id="kobo.839.1">The pods containing the word </span><strong class="source-inline"><span class="koboSpan" id="kobo.840.1">build</span></strong><span class="koboSpan" id="kobo.841.1"> are those that take your source code and turn it into a container image. </span><span class="koboSpan" id="kobo.841.2">The pods containing </span><strong class="source-inline"><span class="koboSpan" id="kobo.842.1">config-writer</span></strong><span class="koboSpan" id="kobo.843.1"> are those that take the source </span><a id="_idIndexMarker667"/><span class="koboSpan" id="kobo.844.1">for a deployable Kubernetes artifact and write it to Git or a container registry where it can be picked up and deployed. </span><span class="koboSpan" id="kobo.844.2">Finally, the pod containing </span><strong class="source-inline"><span class="koboSpan" id="kobo.845.1">deployment</span></strong><span class="koboSpan" id="kobo.846.1"> is your application’s </span><span class="No-Break"><span class="koboSpan" id="kobo.847.1">running pod.</span></span></p>
<p><span class="koboSpan" id="kobo.848.1">Next, let’s view our app in a browser. </span><span class="koboSpan" id="kobo.848.2">Execute this command to get the URL of the running Knative Service that belongs to </span><span class="No-Break"><span class="koboSpan" id="kobo.849.1">your app:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.850.1">
~/D/tanzu-java-web-app&gt; kubectl get kservice -n workload1
NAME                 URL                         LATESTCREATED              LATESTREADY                READY   REASON
tanzu-java-web-app   http://tanzu-java-web-app.workload1.packtinstall.k10s.io   tanzu-java-web-app-00002   tanzu-java-web-app-00002   True</span></pre>
<p><span class="koboSpan" id="kobo.851.1">Now, plug the URL into your browser. </span><span class="koboSpan" id="kobo.851.2">This is what you </span><span class="No-Break"><span class="koboSpan" id="kobo.852.1">should see:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer160">
<span class="koboSpan" id="kobo.853.1"><img alt="Figure ﻿8.10 – Running the Tanzu application" src="image/B18145_08_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.854.1">Figure 8.10 – Running the Tanzu application</span></p>
<p><span class="koboSpan" id="kobo.855.1">Congratulations! </span><span class="koboSpan" id="kobo.855.2">You have a Spring Boot application up and running on Tanzu Application Platform. </span><span class="koboSpan" id="kobo.855.3">Furthermore, there was no need to install a local Java runtime or any tools beyond the Tanzu toolchain. </span><span class="koboSpan" id="kobo.855.4">The plugin transported your raw source code onto the platform where it was built and deployed. </span><span class="koboSpan" id="kobo.855.5">Next, let’s put the </span><em class="italic"><span class="koboSpan" id="kobo.856.1">Live Update</span></em><span class="koboSpan" id="kobo.857.1"> function to </span><span class="No-Break"><span class="koboSpan" id="kobo.858.1">the test.</span></span></p>
<p><span class="koboSpan" id="kobo.859.1">In VS Code, navigate to </span><strong class="source-inline"><span class="koboSpan" id="kobo.860.1">/src/main/java/com/example/springboot/HelloController.java</span></strong><span class="koboSpan" id="kobo.861.1">, then change the greeting. </span><span class="koboSpan" id="kobo.861.2">Perhaps add </span><strong class="source-inline"><span class="koboSpan" id="kobo.862.1">and Packt!!!</span></strong><span class="koboSpan" id="kobo.863.1"> to </span><span class="No-Break"><span class="koboSpan" id="kobo.864.1">the end.</span></span></p>
<p><span class="koboSpan" id="kobo.865.1">Notice that </span><a id="_idIndexMarker668"/><span class="koboSpan" id="kobo.866.1">when you save your change, the VS Code plugin automatically detects the change and deploys it. </span><span class="koboSpan" id="kobo.866.2">Here’s a timeline of what happens when you make a change to a file in </span><span class="No-Break"><span class="koboSpan" id="kobo.867.1">VS Code:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.868.1">The Tilt plugin notices that a file </span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">has changed.</span></span></li>
<li><span class="koboSpan" id="kobo.870.1">The plugin bundles up your source code and stores it in your </span><span class="No-Break"><span class="koboSpan" id="kobo.871.1">container registry.</span></span></li>
<li><span class="koboSpan" id="kobo.872.1">The plugin updates the workload object on your Kubernetes cluster such that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.873.1">.spec.source.image</span></strong><span class="koboSpan" id="kobo.874.1"> field points to the updated source code image in the </span><span class="No-Break"><span class="koboSpan" id="kobo.875.1">container registry.</span></span></li>
<li><span class="koboSpan" id="kobo.876.1">The cartographer controller on Kubernetes notices the change in the workload and triggers a new iteration of the </span><span class="No-Break"><span class="koboSpan" id="kobo.877.1">supply chain.</span></span></li>
<li><span class="koboSpan" id="kobo.878.1">The supply chain pulls the source code, builds it, pushes the container image of the built artifact, and runs that artifact, applying multiple conventions in </span><span class="No-Break"><span class="koboSpan" id="kobo.879.1">the process.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.880.1">After a minute or two, you can refresh your browser and see your local changes reflected live in the app running </span><span class="No-Break"><span class="koboSpan" id="kobo.881.1">in Kubernetes.</span></span></p>
<h2 id="_idParaDest-166"><a id="_idTextAnchor166"/><span class="koboSpan" id="kobo.882.1">Deploying workloads directly</span></h2>
<p><span class="koboSpan" id="kobo.883.1">We’ve now seen the developer workflow where local source code is packaged up and stored in </span><a id="_idIndexMarker669"/><span class="koboSpan" id="kobo.884.1">a container repository and workloads are created from that source. </span><span class="koboSpan" id="kobo.884.2">In a real-world scenario, though, local source code doesn’t go straight from the IDE onto a platform. </span><span class="koboSpan" id="kobo.884.3">Rather, that code goes into source control, which then drives some sort of continuous integration onto the platform. </span><span class="koboSpan" id="kobo.884.4">Let’s briefly explore that use </span><span class="No-Break"><span class="koboSpan" id="kobo.885.1">case now.</span></span></p>
<p><span class="koboSpan" id="kobo.886.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.887.1">/config</span></strong><span class="koboSpan" id="kobo.888.1"> directory of the app that we downloaded and unzipped, you should see a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.889.1">workload.yaml</span></strong><span class="koboSpan" id="kobo.890.1">. </span><span class="koboSpan" id="kobo.890.2">This instructs the platform to pull the source code from this URL: </span><a href="https://github.com/sample-accelerators/tanzu-java-web-app"><span class="koboSpan" id="kobo.891.1">https://github.com/sample-accelerators/tanzu-java-web-app</span></a><span class="koboSpan" id="kobo.892.1">. </span><span class="koboSpan" id="kobo.892.2">Tanzu Application Platform will watch that Git repository and whenever it detects a change, it will pull the latest source code and update the running workload. </span><span class="koboSpan" id="kobo.892.3">Let’s try this </span><span class="No-Break"><span class="koboSpan" id="kobo.893.1">out now.</span></span></p>
<p><span class="koboSpan" id="kobo.894.1">First, to avoid namespace collisions, let’s delete the existing workload. </span><span class="koboSpan" id="kobo.894.2">Let’s stop Tilt by right-clicking on the Tiltfile and selecting </span><strong class="bold"><span class="koboSpan" id="kobo.895.1">Tanzu Live Update Stop</span></strong><span class="koboSpan" id="kobo.896.1">. </span><span class="koboSpan" id="kobo.896.2">Then, let’s delete our workload with </span><span class="No-Break"><span class="koboSpan" id="kobo.897.1">this command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.898.1">
~/D/tanzu-java-web-app&gt; kubectl delete workload -n workload1  --all</span></pre>
<p><span class="koboSpan" id="kobo.899.1">Next, there’s </span><a id="_idIndexMarker670"/><span class="koboSpan" id="kobo.900.1">a small bug in some versions of Tanzu Application Platform that we need to work around. </span><span class="koboSpan" id="kobo.900.2">Although the Git repo we’re referencing is public, the platform still wants a secret to exist for authN. </span><span class="koboSpan" id="kobo.900.3">Let’s create an empty secret as </span><span class="No-Break"><span class="koboSpan" id="kobo.901.1">a workaround:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.902.1">
~/D/tanzu-java-web-app&gt; kubectl create secret generic -n workload1 git-ssh</span></pre>
<p><span class="koboSpan" id="kobo.903.1">Now, let’s deploy the workload directly, taking special care to specify the </span><span class="No-Break"><span class="koboSpan" id="kobo.904.1">correct namespace:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.905.1">
~/D/tanzu-java-web-app&gt; kubectl apply -f ./config/workload.yaml -n workload1</span></pre>
<p><span class="koboSpan" id="kobo.906.1">Then, we can watch the pods progress as the </span><span class="No-Break"><span class="koboSpan" id="kobo.907.1">workload deploys:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.908.1">
~/D/tanzu-java-web-app&gt; kubectl get pods -n workload1
NAME                                                   READY   STATUS      RESTARTS   AGE
tanzu-java-web-app-00001-deployment-557f89455b-pg2td   2/2     Running     0          61s
tanzu-java-web-app-build-1-build-pod                   0/1     Completed   0          2m21s
tanzu-java-web-app-config-writer-7kl4k-pod             0/1     Completed   0          74s</span></pre>
<p><span class="koboSpan" id="kobo.909.1">Finally, you can verify that your workload is visible in the browser </span><span class="No-Break"><span class="koboSpan" id="kobo.910.1">at </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.911.1">tanzu-java-web-app.workload1.yourdomain.com</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.912.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.913.1">Now that we’re practically experts at using the platform, let’s have a look at what we might want to do next as </span><span class="No-Break"><span class="koboSpan" id="kobo.914.1">platform operators.</span></span></p>
<h1 id="_idParaDest-167"><a id="_idTextAnchor167"/><span class="koboSpan" id="kobo.915.1">Day 3 – common operational activities on Tanzu Application Platform</span></h1>
<p><span class="koboSpan" id="kobo.916.1">Thus far, we’ve installed a fully functional application platform, but in some ways, it still may </span><a id="_idIndexMarker671"/><span class="koboSpan" id="kobo.917.1">feel like a toy. </span><span class="koboSpan" id="kobo.917.2">For instance, no enterprise is going to allow workloads to be deployed without TLS. </span><span class="koboSpan" id="kobo.917.3">Also, the platform is a bit of a black box that takes our source code and turns it into a running application. </span><span class="koboSpan" id="kobo.917.4">How can we know that what’s running on the platform is the exact code we checked in? </span><span class="koboSpan" id="kobo.917.5">Going in depth into these topics is a bit beyond the scope of this book, but what I will do is describe some additional operational tasks and the problems they solve, and point you to some useful in-depth resources for </span><span class="No-Break"><span class="koboSpan" id="kobo.918.1">more information.</span></span></p>
<h2 id="_idParaDest-168"><a id="_idTextAnchor168"/><span class="koboSpan" id="kobo.919.1">Securing running workloads with TAP GUI with TLS</span></h2>
<p><span class="koboSpan" id="kobo.920.1">For </span><a id="_idIndexMarker672"/><span class="koboSpan" id="kobo.921.1">an application platform in the enterprise, securing all web endpoints with </span><a id="_idIndexMarker673"/><span class="koboSpan" id="kobo.922.1">TLS is non-negotiable. </span><span class="koboSpan" id="kobo.922.2">There are a few options that I’ll list here. </span><span class="koboSpan" id="kobo.922.3">Some involve procuring the certificate outside of Kubernetes and supplying it directly, and others involve </span><a id="_idIndexMarker674"/><span class="koboSpan" id="kobo.923.1">using an open source project called </span><em class="italic"><span class="koboSpan" id="kobo.924.1">cert-manager</span></em><span class="koboSpan" id="kobo.925.1"> (</span><a href="https://www.jetstack.io/open-source/cert-manager/"><span class="koboSpan" id="kobo.926.1">https://www.jetstack.io/open-source/cert-manager/</span></a><span class="koboSpan" id="kobo.927.1">), which gets installed automatically with Tanzu Application Platform. </span><span class="koboSpan" id="kobo.927.2">Here are some ways you might procure and deploy a TLS certificate into Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.928.1">Application Platform:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.929.1">Directly supplied with a third-party certificate (</span><em class="italic"><span class="koboSpan" id="kobo.930.1">DigiCert</span></em><span class="koboSpan" id="kobo.931.1">, </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.932.1">Verisign</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.933.1">, etc.)</span></span></li>
<li><span class="koboSpan" id="kobo.934.1">Directly supplied with a self-managed </span><span class="No-Break"><span class="koboSpan" id="kobo.935.1">CA (OpenSSL)</span></span></li>
<li><span class="koboSpan" id="kobo.936.1">Directly supplied with a corporate CA-signed certificate (e.g., </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.937.1">Nokia NetGuard</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.938.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.939.1">Directly supplied with </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.940.1">Let’s Encrypt</span></em></span></li>
<li><span class="koboSpan" id="kobo.941.1">Via </span><em class="italic"><span class="koboSpan" id="kobo.942.1">cert-manager</span></em><span class="koboSpan" id="kobo.943.1"> with a </span><span class="No-Break"><span class="koboSpan" id="kobo.944.1">self-managed CA</span></span></li>
<li><span class="koboSpan" id="kobo.945.1">Via </span><em class="italic"><span class="koboSpan" id="kobo.946.1">cert-manager</span></em><span class="koboSpan" id="kobo.947.1"> with </span><em class="italic"><span class="koboSpan" id="kobo.948.1">Let’s Encrypt</span></em><span class="koboSpan" id="kobo.949.1"> (</span><span class="No-Break"><span class="koboSpan" id="kobo.950.1">my preference)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.951.1">As </span><a id="_idIndexMarker675"/><span class="koboSpan" id="kobo.952.1">you can see, there are many options, which could easily double the length </span><a id="_idIndexMarker676"/><span class="koboSpan" id="kobo.953.1">of this chapter. </span><span class="koboSpan" id="kobo.953.2">If you don’t have a strong preference, I’d recommend </span><em class="italic"><span class="koboSpan" id="kobo.954.1">Let’s Encrypt</span></em><span class="koboSpan" id="kobo.955.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.956.1">cert-manager</span></em><span class="koboSpan" id="kobo.957.1">. </span><span class="koboSpan" id="kobo.957.2">If you’re managing your domain’s DNS via a major cloud provider such as AWS Route 53, the process can be simple </span><span class="No-Break"><span class="koboSpan" id="kobo.958.1">and painless.</span></span></p>
<p><span class="koboSpan" id="kobo.959.1">Once you’ve </span><a id="_idIndexMarker677"/><span class="koboSpan" id="kobo.960.1">decided how you’ll obtain a certificate, you’ll need to decide what </span><strong class="bold"><span class="koboSpan" id="kobo.961.1">Subject Alternate Names</span></strong><span class="koboSpan" id="kobo.962.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.963.1">SANs</span></strong><span class="koboSpan" id="kobo.964.1">) you’ll need to request. </span><span class="koboSpan" id="kobo.964.2">These are the URLs that your certificate will validate via TLS. </span><span class="koboSpan" id="kobo.964.3">If you use the conventions that ship with Tanzu Application Platform, I’d recommend these SANs. </span><span class="koboSpan" id="kobo.964.4">Let’s say that the domain that we’re using during the setup process is </span><strong class="source-inline"><span class="koboSpan" id="kobo.965.1">mydomain.com</span></strong><span class="koboSpan" id="kobo.966.1">; then, the SANs you’d configure would be </span><span class="No-Break"><span class="koboSpan" id="kobo.967.1">as follows:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.968.1">*.</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.969.1">mydomain.com</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.970.1">*.</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.971.1">workload1.mydomain.com</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.972.1">*.</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.973.1">workload2.mydomain.com</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.974.1">*.</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.975.1">workload3.mydomain.com</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.976.1">This will give you TLS that will work for workloads deployed to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.977.1">workload1</span></strong><span class="koboSpan" id="kobo.978.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.979.1">workload2</span></strong><span class="koboSpan" id="kobo.980.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.981.1">workload3</span></strong><span class="koboSpan" id="kobo.982.1"> namespaces. </span><span class="koboSpan" id="kobo.982.2">There are ways to work around the limitation so you can deploy to any arbitrary namespace, but I’ll refer you to the documentation for how to do that </span><span class="No-Break"><span class="koboSpan" id="kobo.983.1">as well.</span></span></p>
<p><span class="koboSpan" id="kobo.984.1">Now that we’ve decided on how we’ll obtain a certificate and identified our SANs, I’ll send you </span><a id="_idIndexMarker678"/><span class="koboSpan" id="kobo.985.1">to this excellent blog post, which goes into detail on how to install Tanzu Application Platform with TLS </span><span class="No-Break"><span class="koboSpan" id="kobo.986.1">support: </span></span><a href="https://tanzu.vmware.com/content/blog/tanzu-application-platform-install-with-tls-and-azure-ad"><span class="No-Break"><span class="koboSpan" id="kobo.987.1">https://tanzu.vmware.com/content/blog/tanzu-application-platform-install-with-tls-and-azure-ad</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.988.1">.</span></span></p>
<h2 id="_idParaDest-169"><a id="_idTextAnchor169"/><span class="koboSpan" id="kobo.989.1">Enabling testing and scanning</span></h2>
<p><span class="koboSpan" id="kobo.990.1">Another </span><a id="_idIndexMarker679"/><span class="koboSpan" id="kobo.991.1">non-negotiable for running enterprise software on a platform is that it needs to deploy with a guarantee that it has passed all its unit tests and that it has been scanned for known vulnerabilities. </span><span class="koboSpan" id="kobo.991.2">Tanzu Application Platform can provide both these guarantees with a bit of </span><span class="No-Break"><span class="koboSpan" id="kobo.992.1">extra configuration.</span></span></p>
<p><span class="koboSpan" id="kobo.993.1">First, regarding testing, there’s no way that any platform could account for every testing framework across every programming language, so rather than moving forward with a half-baked attempt, the architects of Tanzu Application Platform decided to put automated testing in the hands of the app’s developer via </span><span class="No-Break"><span class="koboSpan" id="kobo.994.1">Tekton Pipelines.</span></span></p>
<p><span class="koboSpan" id="kobo.995.1">Tekton (</span><a href="https://cloud.google.com/tekton/"><span class="koboSpan" id="kobo.996.1">https://cloud.google.com/tekton/</span></a><span class="koboSpan" id="kobo.997.1">) provides Kubernetes-native continuous integration </span><a id="_idIndexMarker680"/><span class="koboSpan" id="kobo.998.1">and delivery. </span><span class="koboSpan" id="kobo.998.2">Tanzu Application Platform, then, will look for a Tekton pipeline that knows how to run an application’s tests and run it. </span><span class="koboSpan" id="kobo.998.3">The documentation also gives some sample pipelines for languages such as Java </span><span class="No-Break"><span class="koboSpan" id="kobo.999.1">and Maven.</span></span></p>
<p><span class="koboSpan" id="kobo.1000.1">Scanning </span><a id="_idIndexMarker681"/><span class="koboSpan" id="kobo.1001.1">for vulnerabilities is a bit simpler. </span><span class="koboSpan" id="kobo.1001.2">Tanzu Application Platform will scan an app’s source code and generated container images using two well-known scanning tools: </span><em class="italic"><span class="koboSpan" id="kobo.1002.1">Grype</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.1003.1">or </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1004.1">Snyk</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1005.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1006.1">You </span><a id="_idIndexMarker682"/><span class="koboSpan" id="kobo.1007.1">can learn how to enable testing and scanning for your application supply chains </span><span class="No-Break"><span class="koboSpan" id="kobo.1008.1">here: </span></span><a href="https://docs.vmware.com/en/VMware-Tanzu-Application-Platform/1.2/tap/GUID-getting-started-add-test-and-security.html"><span class="No-Break"><span class="koboSpan" id="kobo.1009.1">https://docs.vmware.com/en/VMware-Tanzu-Application-Platform/1.2/tap/GUID-getting-started-add-test-and-security.html</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1010.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1011.1">Once you’ve tackled these topics, you should have a thorough knowledge of Tanzu Application Platform and have a good intuition for what </span><em class="italic"><span class="koboSpan" id="kobo.1012.1">good</span></em><span class="koboSpan" id="kobo.1013.1"> looks like in the enterprise. </span><span class="koboSpan" id="kobo.1013.2">What comes next? </span><span class="koboSpan" id="kobo.1013.3">Let’s brainstorm some next steps in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1014.1">next section.</span></span></p>
<h1 id="_idParaDest-170"><a id="_idTextAnchor170"/><span class="koboSpan" id="kobo.1015.1">Next steps</span></h1>
<p><span class="koboSpan" id="kobo.1016.1">Now that you’re a veritable Tanzu Application Platform expert, where can you go next? </span><span class="koboSpan" id="kobo.1016.2">Here are </span><span class="No-Break"><span class="koboSpan" id="kobo.1017.1">some thoughts:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.1018.1">Deploy Tanzu Application Platform across multiple Kubernetes clusters with dedicated clusters for viewing, building, and </span><span class="No-Break"><span class="koboSpan" id="kobo.1019.1">running workloads</span></span></li>
<li><span class="koboSpan" id="kobo.1020.1">Enable managed services (databases, message queues, etc.) that can automatically bind their credentials </span><span class="No-Break"><span class="koboSpan" id="kobo.1021.1">to workloads</span></span></li>
<li><span class="koboSpan" id="kobo.1022.1">Enable custom GitOps workflows that require an approved pull request before deploying </span><span class="No-Break"><span class="koboSpan" id="kobo.1023.1">to production</span></span></li>
<li><span class="koboSpan" id="kobo.1024.1">Build your own custom supply chains using the Cartographer </span><span class="No-Break"><span class="koboSpan" id="kobo.1025.1">tools (</span></span><a href="https://cartographer.sh/"><span class="No-Break"><span class="koboSpan" id="kobo.1026.1">https://cartographer.sh/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1027.1">)</span></span></li>
</ul>
<h1 id="_idParaDest-171"><a id="_idTextAnchor171"/><span class="koboSpan" id="kobo.1028.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1029.1">Tanzu Application Platform is likely the most complex piece of software we cover in this book and could benefit from a dedicated book of its own. </span><span class="koboSpan" id="kobo.1029.2">Mastering this technology will make you indispensable to any enterprise looking to run software in the cloud at scale. </span><span class="koboSpan" id="kobo.1029.3">With Tanzu Application Platform done, we’re going to wrap up the second part of the book where we covered </span><em class="italic"><span class="koboSpan" id="kobo.1030.1">running</span></em><span class="koboSpan" id="kobo.1031.1"> applications on Tanzu, and transition to the next section, where we talk about </span><em class="italic"><span class="koboSpan" id="kobo.1032.1">managing</span></em><span class="koboSpan" id="kobo.1033.1"> them with tools such as Tanzu Mission Control, VMware Aria operations for Applications, and Tanzu Service Mesh. </span><span class="koboSpan" id="kobo.1033.2">This wraps up our treatment of running applications on Tanzu. </span><span class="koboSpan" id="kobo.1033.3">I encourage you to continue on to the next section where we cover managing those applications. </span><span class="koboSpan" id="kobo.1033.4">We’ll start with </span><strong class="bold"><span class="koboSpan" id="kobo.1034.1">Tanzu Mission Control</span></strong><span class="koboSpan" id="kobo.1035.1">, a single point of control for all of your enterprise Kubernetes assets across </span><span class="No-Break"><span class="koboSpan" id="kobo.1036.1">multiple clouds.</span></span></p>
</div>


<div class="Content" id="_idContainer162">
<h1 id="_idParaDest-172"><a id="_idTextAnchor172"/><span class="koboSpan" id="kobo.1.1">Part 3 – Managing Modern Applications on the Tanzu Platform</span></h1>
<p><span class="koboSpan" id="kobo.2.1">This part will cover some important Tanzu tools that help to manage, secure, and proactively observe the container applications and the underlying Kubernetes platform for important day-2 activities of </span><span class="No-Break"><span class="koboSpan" id="kobo.3.1">multi-cloud-based deployments.</span></span></p>
<p><span class="koboSpan" id="kobo.4.1">This part of the book comprises the </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">following chapters:</span></span></p>
<ul>
<li><a href=""><em class="italic"><span class="koboSpan" id="kobo.6.1">Chapter 9</span></em></a><span class="koboSpan" id="kobo.7.1">, </span><em class="italic"><span class="koboSpan" id="kobo.8.1">Managing and Controlling Kubernetes Clusters with Tanzu Mission Control</span></em></li>
<li><a href="B18145_10.xhtml#_idTextAnchor193"><em class="italic"><span class="koboSpan" id="kobo.9.1">Chapter 10</span></em></a><span class="koboSpan" id="kobo.10.1">, </span><em class="italic"><span class="koboSpan" id="kobo.11.1">Realizing Full-Stack Visibility with VMware Aria Operations for Applications</span></em></li>
<li><a href="B18145_11.xhtml#_idTextAnchor220"><em class="italic"><span class="koboSpan" id="kobo.12.1">Chapter 11</span></em></a><span class="koboSpan" id="kobo.13.1">, </span><em class="italic"><span class="koboSpan" id="kobo.14.1">Enabling Secure Inter-Service Communication with Tanzu Service Mesh</span></em></li>
<li><a href="B18145_12.xhtml#_idTextAnchor239"><em class="italic"><span class="koboSpan" id="kobo.15.1">Chapter 12</span></em></a><span class="koboSpan" id="kobo.16.1">, </span><em class="italic"><span class="koboSpan" id="kobo.17.1">Bringing It All Together</span></em></li>
<li><a href="B18145_13.xhtml#_idTextAnchor259"><em class="italic"><span class="koboSpan" id="kobo.18.1">Chapter 13</span></em></a><span class="koboSpan" id="kobo.19.1">, </span><em class="italic"><span class="koboSpan" id="kobo.20.1">Appendix</span></em></li>
</ul>
</div>
<div>
<div id="_idContainer163">
</div>
</div>
</body></html>
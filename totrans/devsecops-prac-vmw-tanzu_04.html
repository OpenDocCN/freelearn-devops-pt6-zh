<html><head></head><body>
<div id="_idContainer063">
<h1 class="chapter-number" id="_idParaDest-74"><a id="_idTextAnchor074"/><span class="koboSpan" id="kobo.1.1">4</span></h1>
<h1 id="_idParaDest-75"><a id="_idTextAnchor075"/><span class="koboSpan" id="kobo.2.1">Provisioning Backing Services for Applications</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In the previous chapter, we saw how to build application container images with ample security and without much operational overhead using </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Tanzu Build Service</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.6.1">TBS</span></strong><span class="koboSpan" id="kobo.7.1">). </span><span class="koboSpan" id="kobo.7.2">These container images are the essential building blocks to run our cloud-native applications on container orchestration platforms such as </span><strong class="bold"><span class="koboSpan" id="kobo.8.1">Kubernetes</span></strong><span class="koboSpan" id="kobo.9.1">. </span><span class="koboSpan" id="kobo.9.2">We can deploy those container images on a Kubernetes cluster and run our applications. </span><span class="koboSpan" id="kobo.9.3">However, in real life, things are not that straightforward. </span><span class="koboSpan" id="kobo.9.4">In the majority of cases, business applications depend on backing services such as databases, queues, caches, and others. </span><span class="koboSpan" id="kobo.9.5">Additionally, there is an increasing trend to also deploy such off-the-shelf backing services as containers on Kubernetes-like platforms for various </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">good reasons.</span></span></p>
<p><span class="koboSpan" id="kobo.11.1">In this chapter, we will take a deep dive into </span><strong class="bold"><span class="koboSpan" id="kobo.12.1">VMware Application Catalog</span></strong><span class="koboSpan" id="kobo.13.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.14.1">VAC</span></strong><span class="koboSpan" id="kobo.15.1">), which provides a secure, fast, and reliable way to use such open source backing services in a containerized environment. </span><span class="koboSpan" id="kobo.15.2">We will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.17.1">Why VMware </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">Application Catalog?</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">What VMware Application </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">Catalog is</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">Getting started with VMware </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">Application Catalog</span></span></li>
<li><span class="koboSpan" id="kobo.23.1">Common day-two activities with VMware </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">Application Catalog</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.25.1">We have a lot of ground to cover. </span><span class="koboSpan" id="kobo.25.2">So, let’s get started exploring what business and technical challenges are addressed </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">by VAC.</span></span></p>
<h1 id="_idParaDest-76"><a id="_idTextAnchor076"/><span class="koboSpan" id="kobo.27.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.28.1">There are some technical requirements that need to be fulfilled before we start using VAC. </span><span class="koboSpan" id="kobo.28.2">These requirements are covered later in this chapter, at the beginning of the </span><em class="italic"><span class="koboSpan" id="kobo.29.1">Getting started with VMware Application Catalog</span></em><span class="koboSpan" id="kobo.30.1"> section. </span><span class="koboSpan" id="kobo.30.2">However, you may not need them to understand the application and the details of </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">this tool.</span></span></p>
<h1 id="_idParaDest-77"><a id="_idTextAnchor077"/><span class="koboSpan" id="kobo.32.1">Why VMware Application Catalog?</span></h1>
<p><span class="koboSpan" id="kobo.33.1">The following are the key areas where VAC addresses detailed challenges with its capabilities for delivering better developer productivity, security, and operational practices when it comes to providing a way to consume popular </span><strong class="bold"><span class="koboSpan" id="kobo.34.1">open source software</span></strong><span class="koboSpan" id="kobo.35.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.36.1">OSS</span></strong><span class="koboSpan" id="kobo.37.1">) and deploy it as </span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">running containers.</span></span></p>
<h2 id="_idParaDest-78"><a id="_idTextAnchor078"/><span class="koboSpan" id="kobo.39.1">Using the right tool for the right purpose with the flexibility of choice</span></h2>
<p><span class="koboSpan" id="kobo.40.1">As we discussed previously, most business applications depend on one or more backing services, and depending on the nature of the application, the need for such backing services can be different. </span><span class="koboSpan" id="kobo.40.2">We have seen that using a relational database as a backend data store has been the most common backing service for the past several years. </span><span class="koboSpan" id="kobo.40.3">But some modern cloud-native applications could perform better with other data stores such as NoSQL. </span><span class="koboSpan" id="kobo.40.4">Similarly, if an application needs a queue as a backing service, we can use either Kafka or RabbitMQ. </span><span class="koboSpan" id="kobo.40.5">But both Kafka and RabbitMQ have their own niche use cases where one might be a better option than the other depending on the application’s needs. </span><span class="koboSpan" id="kobo.40.6">Similarly, such options exist for tools such as caches, logging, </span><strong class="bold"><span class="koboSpan" id="kobo.41.1">continuous integration/continuous deployment</span></strong><span class="koboSpan" id="kobo.42.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.43.1">CI/CD</span></strong><span class="koboSpan" id="kobo.44.1">) automation, and many other aspects of running cloud-native applications. </span><span class="koboSpan" id="kobo.44.2">For these use cases, there are strong and mature open source software solutions available today that are very popular and widely adopted. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.45.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.46.1">.1</span></em><span class="koboSpan" id="kobo.47.1"> shows how OSS tools have become more popular than proprietary tools in the </span><span class="No-Break"><span class="koboSpan" id="kobo.48.1">recent past:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer031">
<span class="koboSpan" id="kobo.49.1"><img alt="Figure 4.1 – The increasing trend of open source data store popularity" src="image/B18145_04_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.50.1">Figure 4.1 – The increasing trend of open source data store popularity</span></p>
<p><span class="koboSpan" id="kobo.51.1">Despite the vast choice and proven track record, providing the required freedom to adopt such OSS tools internally to application teams is often challenging. </span><span class="koboSpan" id="kobo.51.2">There are two possible reasons for this. </span><span class="koboSpan" id="kobo.51.3">Firstly, it takes a lot of operational overhead to get such tools approved for usage and create a secure supply chain of container images for these tools. </span><span class="koboSpan" id="kobo.51.4">And secondly, the fact that their respective container images are available on public container repositories means that they are not always trustworthy. </span><span class="koboSpan" id="kobo.51.5">Because of that, development teams suffer either because of a lack of choice or the loss of productivity results in </span><span class="No-Break"><span class="koboSpan" id="kobo.52.1">wait times.</span></span></p>
<p><span class="koboSpan" id="kobo.53.1">VAC addresses this challenge by providing a huge catalog of OSS tools that enterprises can select from. </span><span class="koboSpan" id="kobo.53.2">Once a custom catalog of OSS tools is prepared, the VAC service creates an automated supply chain to stream container images and Helm charts of those selected tools and delivers them to a targeted container registry that is deployed either internally or externally, such as </span><strong class="bold"><span class="koboSpan" id="kobo.54.1">Google Container Registry</span></strong><span class="koboSpan" id="kobo.55.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.56.1">GCR</span></strong><span class="koboSpan" id="kobo.57.1">). </span><span class="koboSpan" id="kobo.57.2">Later, we would keep getting the newer versions of those OSS tools in the form of their newer container images and Helm charts. </span><span class="koboSpan" id="kobo.57.3">These can all be configured with minimal operational overhead and provide a lot of choices for application teams. </span><span class="koboSpan" id="kobo.57.4">Once we start getting the artifacts, container images, and Helm charts for our catalog items, we can expose that catalog for internal consumption. </span><span class="koboSpan" id="kobo.57.5">Then, the authorized internal members may use the catalog to provision those OSS tools on Kubernetes within minutes. </span><span class="koboSpan" id="kobo.57.6">Such flexibility of choice without the operational overhead to developers should encourage the usage of the right backing services for the right use case without affecting the productivity of </span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">their users.</span></span></p>
<h2 id="_idParaDest-79"><a id="_idTextAnchor079"/><span class="koboSpan" id="kobo.59.1">Enhanced security and transparency</span></h2>
<p><span class="koboSpan" id="kobo.60.1">Using OSS deployment on container platforms is very quick, easy, and becoming popular. </span><span class="koboSpan" id="kobo.60.2">All major public container repositories such as Docker Hub and GCR have the container images for all major OSS. </span><span class="koboSpan" id="kobo.60.3">We can simply provide the name of the container image and download it in seconds. </span><span class="koboSpan" id="kobo.60.4">However, despite several benefits of pulling container images from such public container repositories, almost all enterprises, with some level of mature security practices, would not allow this. </span><span class="koboSpan" id="kobo.60.5">The following are a few reasons </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">for this:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.62.1">It is difficult to determine which container images on public repositories are hosted by legitimate sources. </span><span class="koboSpan" id="kobo.62.2">You may find several different container images for the same software hosted by different organizations or common users. </span><span class="koboSpan" id="kobo.62.3">In this case, it would be very difficult to create a whitelist of authenticated sources to pull the images hosted </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">by them.</span></span></li>
<li><span class="koboSpan" id="kobo.64.1">Even if there is a way to find the authenticated sources whose container images can be used, it is very difficult to create a governance model around it to restrict the usage of the container images hosted by </span><span class="No-Break"><span class="koboSpan" id="kobo.65.1">unknown sources.</span></span></li>
<li><span class="koboSpan" id="kobo.66.1">It is also very difficult to get a </span><strong class="bold"><span class="koboSpan" id="kobo.67.1">bill of material</span></strong><span class="koboSpan" id="kobo.68.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.69.1">BOM</span></strong><span class="koboSpan" id="kobo.70.1">) to know what such externally provided container images contain. </span><span class="koboSpan" id="kobo.70.2">Such third-party images often act as black boxes for enterprises to obtain the required confidence to allow using them in any environment. </span><span class="koboSpan" id="kobo.70.3">Auditing the environments running such black-box container images would be </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">very difficult.</span></span></li>
<li><span class="koboSpan" id="kobo.72.1">Any reasonably mature organization has a standard set of </span><strong class="bold"><span class="koboSpan" id="kobo.73.1">operating systems</span></strong><span class="koboSpan" id="kobo.74.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.75.1">OSes</span></strong><span class="koboSpan" id="kobo.76.1">) that they allow in their infrastructure. </span><span class="koboSpan" id="kobo.76.2">These OS requirements are often applicable to container images too. </span><span class="koboSpan" id="kobo.76.3">However, there are no controls and enough choices for selecting the OS when it comes to the container images provided by third parties. </span><span class="koboSpan" id="kobo.76.4">This could be a single significant reason that corporates disapprove of the use of the container images of OSS tools hosted on public </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">container registries.</span></span></li>
<li><span class="koboSpan" id="kobo.78.1">There are several audit and compliance requirements when it comes to information security standards for a security-first mindset organization. </span><span class="koboSpan" id="kobo.78.2">To achieve the required confidence to run an OSS container in the production environment of a corporate entity, there should be several details available, including </span><strong class="bold"><span class="koboSpan" id="kobo.79.1">Common Vulnerabilities and Exposures</span></strong><span class="koboSpan" id="kobo.80.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.81.1">CVE</span></strong><span class="koboSpan" id="kobo.82.1">) scan reports, test results, anti-virus scans, and other details for all the </span><span class="No-Break"><span class="koboSpan" id="kobo.83.1">workloads deployed.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.84.1">To meet these requirements, companies usually take control of curating their own OSS container image-building process. </span><span class="koboSpan" id="kobo.84.2">And when they add more OSS into their catalog of the in-house image curation process, they often later realize that such efforts are not very scalable, fast enough to fulfill the demand, efficient, or secure. </span><span class="koboSpan" id="kobo.84.3">Here are a few reasons for this: when there are new OSS tools required to be added to the internally managed catalog, it requires building a new automation pipeline, test cases, infrastructure capacity, </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">and more:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.86.1">Such in-house and bespoke automation efforts are often understood and maintained by very few engineers. </span><span class="koboSpan" id="kobo.86.2">Out rotation of such key people in the team creates a vacuum that is difficult to fill at times, and that creates a </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">knowledge gap.</span></span></li>
<li><span class="koboSpan" id="kobo.88.1">As the catalog becomes bigger, the maintenance effort increases exponentially. </span><span class="koboSpan" id="kobo.88.2">Because every newer version of each catalog item requires building a new corresponding container image for internal consumption. </span><span class="koboSpan" id="kobo.88.3">Because of such added overhead, the platform operations team may fall behind in keeping up with the latest patched versions of the OSS tools. </span><span class="koboSpan" id="kobo.88.4">Such delays in producing the latest patched container image of the tool increase security risks by allowing unpatched CVEs to be available for enterprise-wide consumption until the newer container image </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">is ready.</span></span></li>
<li><span class="koboSpan" id="kobo.90.1">Because of the amount of effort required to provision a new catalog item for internal consumption, there could be a potential pushback to adding new items. </span><span class="koboSpan" id="kobo.90.2">Such pushbacks could either reduce developer productivity as they spend time waiting or affect the business application’s quality by not using the right tool for the right </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">use case.</span></span></li>
<li><span class="koboSpan" id="kobo.92.1">Even though the platform team agrees to add a new item to the catalog, it would take a long time before the actual consumers would get a production-certified container image that they can use. </span><span class="koboSpan" id="kobo.92.2">Such delays again waste the valuable productive time of an important workforce. </span><span class="koboSpan" id="kobo.92.3">Or the workforce finds workarounds by using externally available but insecure sources for such </span><span class="No-Break"><span class="koboSpan" id="kobo.93.1">container images.</span></span></li>
<li><span class="koboSpan" id="kobo.94.1">The time of the people working on such internal automation efforts and the infrastructure capacity utilized for this reason could be better used for a more business </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">outcome-driven endeavor.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.96.1">To address these challenges, VAC comes into the picture and helps with the following benefits to provide a secure solution to increase developer productivity and </span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">operational efficiency:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.98.1">VAC allows enterprises to use their own golden OS image layer for all their selected OSS container images. </span><span class="koboSpan" id="kobo.98.2">This is a significant benefit as the client organization can use their hardened OS layer with desired security configurations on their selection of </span><span class="No-Break"><span class="koboSpan" id="kobo.99.1">OS flavor.</span></span></li>
<li><span class="koboSpan" id="kobo.100.1">VAC creates an automation pipeline for the creation and distribution of every catalog item’s container image and Helm chart (if applicable). </span><span class="koboSpan" id="kobo.100.2">Because of such automation, VAC can quickly supply newer patched versions of the catalog items to subscribers soon after the newer upstream version becomes available. </span><span class="koboSpan" id="kobo.100.3">Such a quick supply of the patched versions provides a good preventative security posture against </span><span class="No-Break"><span class="koboSpan" id="kobo.101.1">hacking attacks.</span></span></li>
<li><span class="koboSpan" id="kobo.102.1">VAC supplies the following artifacts with all container images delivered to enhance consumers’ confidence and increase the transparency of the </span><span class="No-Break"><span class="koboSpan" id="kobo.103.1">container images:</span></span><ul><li><span class="koboSpan" id="kobo.104.1">Asset specification detailing information about the content of the </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">container image</span></span></li><li><span class="koboSpan" id="kobo.106.1">Automation test case results for a test run executed </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">before delivery</span></span></li><li><span class="koboSpan" id="kobo.108.1">CVE </span><span class="No-Break"><span class="koboSpan" id="kobo.109.1">scan report</span></span></li><li><span class="koboSpan" id="kobo.110.1">CVE scan report in </span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">CVRF format</span></span></li><li><span class="koboSpan" id="kobo.112.1">Antivirus </span><span class="No-Break"><span class="koboSpan" id="kobo.113.1">scan report</span></span></li><li><span class="koboSpan" id="kobo.114.1">User </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">documentation references</span></span></li></ul></li>
<li><span class="koboSpan" id="kobo.116.1">VAC pushes all the artifacts to a private container registry as provided by the clients, which creates a trustable source of all container images and Helm charts for </span><span class="No-Break"><span class="koboSpan" id="kobo.117.1">internal consumption.</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.118.1">What is the CVRF?</span></p>
<p class="callout"><span class="koboSpan" id="kobo.119.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.120.1">Common Vulnerability Reporting Framework</span></strong><span class="koboSpan" id="kobo.121.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.122.1">CVRF</span></strong><span class="koboSpan" id="kobo.123.1">) Version 1.1 was released in May 2012. </span><span class="koboSpan" id="kobo.123.2">CVRF is an XML-based language that enables different stakeholders across different organizations to share critical security-related information in a single format, speeding up information exchange and digestion. </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">Reference: </span></span><a href="https://www.icasi.org/the-common-vulnerability-reporting-framework-cvrf-v1-1/"><span class="No-Break"><span class="koboSpan" id="kobo.125.1">https://www.icasi.org/the-common-vulnerability-reporting-framework-cvrf-v1-1/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.126.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.127.1">In the previous points, we discussed most of the important benefits of VAC. </span><span class="koboSpan" id="kobo.127.2">Presently, VAC is only applicable to OSS tools. </span><span class="koboSpan" id="kobo.127.3">However, many large organizations do not use OSS tools without enterprise-grade support, especially in a production environment. </span><span class="koboSpan" id="kobo.127.4">It is important to understand that VAC, as a solution, only supports the secure supply chain of OSS container images and Helm charts using client-selected OS layers. </span><span class="koboSpan" id="kobo.127.5">But VAC does not support the underlying OSS tools as a part of the subscription. </span><span class="koboSpan" id="kobo.127.6">For example, if an organization requires PostgreSQL DB container images via VAC, then VAC will support the packaging and the timely distribution of the container images of PostgreSQL DB upstream versions. </span><span class="koboSpan" id="kobo.127.7">But VAC would not support the underlying PostgreSQL DB itself. </span><span class="koboSpan" id="kobo.127.8">Hence, for the support of PostgreSQL, the enterprise may need to either use a vendor-supported offering such as VMware’s </span><strong class="bold"><span class="koboSpan" id="kobo.128.1">Tanzu</span></strong><span class="koboSpan" id="kobo.129.1"> data management service subscription, which supports open source PostgreSQL and MySQL DB. </span><span class="koboSpan" id="kobo.129.2">Alternatively, they could use a vendor-specific flavor of the open source solution such as the one provided by Crunchy Data for PostgreSQL, for example. </span><span class="koboSpan" id="kobo.129.3">In this case, organizations may get container images from respective third-party vendors such as Crunchy Data. </span><span class="koboSpan" id="kobo.129.4">For such cases, VAC would not be useful. </span><span class="koboSpan" id="kobo.129.5">But if the enterprises wanted to use the vanilla upstream version of PostgreSQL, which is supported by a vendor such as VMware or </span><strong class="bold"><span class="koboSpan" id="kobo.130.1">EnterpriseDB</span></strong><span class="koboSpan" id="kobo.131.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.132.1">EDB</span></strong><span class="koboSpan" id="kobo.133.1">), then they may use VAC to benefit from all the </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">listed benefits.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.135.1">Upstream versus a vendor-specific flavored OSS</span></p>
<p class="callout"><span class="koboSpan" id="kobo.136.1">Using upstream OSS distributions directly without adding a vendor-specific flavor helps avoid potential vendor lock-ins, which is the first and foremost reason to use OSS technology. </span><span class="koboSpan" id="kobo.136.2">VAC makes the adoption of such OSS tools easier for enterprises. </span><span class="koboSpan" id="kobo.136.3">Despite that, many organizations still use vendor-specific flavors of OSS because of the additional features and functionalities not available in the upstream OSS distributions. </span><span class="koboSpan" id="kobo.136.4">Hence, there are pros and cons to </span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">both approaches.</span></span></p>
<p><span class="koboSpan" id="kobo.138.1">After understanding how and where VAC is beneficial and where it is not applicable, let’s now take a deeper look into what VAC is and what </span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">it contains.</span></span></p>
<h1 id="_idParaDest-80"><a id="_idTextAnchor080"/><span class="koboSpan" id="kobo.140.1">What VMware Application Catalog is</span></h1>
<p><span class="koboSpan" id="kobo.141.1">After delivering comprehensive detail on what business, security, and technological challenges VAC can address and where it will not be a good use case, let’s now understand this tool in a bit more detail to see what it contains. </span><span class="koboSpan" id="kobo.141.2">But before that, let’s look into the background of VAC to learn more </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">about it.</span></span></p>
<h2 id="_idParaDest-81"><a id="_idTextAnchor081"/><span class="koboSpan" id="kobo.143.1">The history of VMware Application Catalog</span></h2>
<p><span class="koboSpan" id="kobo.144.1">In late 2019, with a vision of curating a comprehensive portfolio of modern application development and management tools, VMware decided to acquire a popular OSS packaging and distribution company named </span><strong class="bold"><span class="koboSpan" id="kobo.145.1">Bitnami</span></strong><span class="koboSpan" id="kobo.146.1">. </span><span class="koboSpan" id="kobo.146.2">Bitnami had several years of experience working in this space, initially providing well-curated and consumable OSS tools in the form of binaries, virtual machine images, and container images. </span><span class="koboSpan" id="kobo.146.3">After the acquisition, VMware rebranded Bitnami as </span><strong class="bold"><span class="koboSpan" id="kobo.147.1">Tanzu Application Catalog</span></strong><span class="koboSpan" id="kobo.148.1"> to define an enterprise-grade OSS container image distribution offering that can customize the image specification as per the enterprise client’s needs. </span><span class="koboSpan" id="kobo.148.2">In 2021, VMware decided to also include the </span><strong class="bold"><span class="koboSpan" id="kobo.149.1">Open Virtual Appliance</span></strong><span class="koboSpan" id="kobo.150.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.151.1">OVA</span></strong><span class="koboSpan" id="kobo.152.1">) image catalog to build virtual machines in addition to just the container images and Helm charts, which was the original idea behind Tanzu Application Catalog. </span><span class="koboSpan" id="kobo.152.2">As we see in this book, VMware’s Tanzu product portfolio contains all the tools and technologies around containers and Kubernetes. </span><span class="koboSpan" id="kobo.152.3">This was the reason why this offering was also initially given a </span><em class="italic"><span class="koboSpan" id="kobo.153.1">Tanzu</span></em><span class="koboSpan" id="kobo.154.1"> name. </span><span class="koboSpan" id="kobo.154.2">But with the recent announcement by VMware to also expand this offering to cover OVA images along with container images and Helm charts, this offering was renamed </span><strong class="bold"><span class="koboSpan" id="kobo.155.1">VMware Application Catalog</span></strong><span class="koboSpan" id="kobo.156.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.157.1">VAC</span></strong><span class="koboSpan" id="kobo.158.1">), as it is not just about the container </span><span class="No-Break"><span class="koboSpan" id="kobo.159.1">ecosystem anymore.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.160.1">Important Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.161.1">The main focus of this book is Tanzu and its surrounding ecosystem. </span><span class="koboSpan" id="kobo.161.2">Additionally, at the time of writing this book, the offerings around virtual machine images are still evolving to get to the level of container images with respect to VAC. </span><span class="koboSpan" id="kobo.161.3">Hence, we will only cover details around container image catalog management and consumption in this chapter and not for virtual </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">machine images.</span></span></p>
<p><span class="koboSpan" id="kobo.163.1">After tapping into the history of VAC and knowing why it has </span><em class="italic"><span class="koboSpan" id="kobo.164.1">VMware</span></em><span class="koboSpan" id="kobo.165.1"> and not </span><em class="italic"><span class="koboSpan" id="kobo.166.1">Tanzu</span></em><span class="koboSpan" id="kobo.167.1"> in the name, let’s now understand what the key parts of this product </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">offering are.</span></span></p>
<h2 id="_idParaDest-82"><a id="_idTextAnchor082"/><span class="koboSpan" id="kobo.169.1">Components of VMware Application Catalog</span></h2>
<p><span class="koboSpan" id="kobo.170.1">The following tools are the components of VAC. </span><span class="koboSpan" id="kobo.170.2">Let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">review them.</span></span></p>
<h3><span class="koboSpan" id="kobo.172.1">VMware Application Catalog portal</span></h3>
<p><span class="koboSpan" id="kobo.173.1">The main component of this offering is the VAC portal, where we can curate and manage the application catalog. </span><span class="koboSpan" id="kobo.173.2">It’s a </span><strong class="bold"><span class="koboSpan" id="kobo.174.1">Software as a Service</span></strong><span class="koboSpan" id="kobo.175.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.176.1">SaaS</span></strong><span class="koboSpan" id="kobo.177.1">) component that is hosted and managed by VMware. </span><span class="koboSpan" id="kobo.177.2">VAC clients can use this portal using their VMware Cloud (</span><a href="https://console.cloud.vmware.com/"><span class="koboSpan" id="kobo.178.1">https://console.cloud.vmware.com/</span></a><span class="koboSpan" id="kobo.179.1">) account to access the VAC service. </span><span class="koboSpan" id="kobo.179.2">A catalog administrator may create new catalogs, add new OSS offerings in the catalog, and download supporting elements related to the catalog items, including test result logs, CVE reports, anti-virus scan reports, and other such items. </span><span class="koboSpan" id="kobo.179.3">In summary, the VAC portal provides a web-based user interface for securely curating a catalog of OSS tools that can be freely used by the internal users of the enterprise. </span><span class="koboSpan" id="kobo.179.4">We will cover more details about this portal later in </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">the chapter.</span></span></p>
<h3><span class="koboSpan" id="kobo.181.1">Kubeapps</span></h3>
<p><span class="koboSpan" id="kobo.182.1">Once a catalog administrator defines a catalog of supported OSS tools with Helm charts on the VAC portal, developers or operators may use Kubeapps (</span><a href="https://kubeapps.com/"><span class="koboSpan" id="kobo.183.1">https://kubeapps.com/</span></a><span class="koboSpan" id="kobo.184.1">) to consume the published catalog items for internal use. </span><span class="koboSpan" id="kobo.184.2">Kubeapps is an OSS tool under the </span><strong class="bold"><span class="koboSpan" id="kobo.185.1">Cloud Native Computing Foundation</span></strong><span class="koboSpan" id="kobo.186.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.187.1">CNCF</span></strong><span class="koboSpan" id="kobo.188.1">) umbrella. </span><span class="koboSpan" id="kobo.188.2">This project was started by Bitnami to provide a </span><strong class="bold"><span class="koboSpan" id="kobo.189.1">graphical user interface</span></strong><span class="koboSpan" id="kobo.190.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.191.1">GUI</span></strong><span class="koboSpan" id="kobo.192.1">) to deploy software using Helm charts on top of Kubernetes clusters. </span><span class="koboSpan" id="kobo.192.2">Since the acquisition of Bitnami, VMware actively maintains it. </span><span class="koboSpan" id="kobo.192.3">It is a very lightweight application that can be deployed on a Kubernetes cluster running in the organization’s environment. </span><span class="koboSpan" id="kobo.192.4">The users of Kubeapps can select software to be deployed from the accessible catalog, change required deployment configurations (for example, user credentials, storage size, security configuration, and things of that nature), and finally deploy it as running containers on the targeted namespace of the selected Kubernetes cluster. </span><span class="koboSpan" id="kobo.192.5">Once a new version of the software is available in the catalog, the user can quickly upgrade it or remove the deployment if no longer required. </span><span class="koboSpan" id="kobo.192.6">To sum up, if the VAC portal provides the required controls for securely exposing a catalog of OSS tools, the Kubeapps provides the desired flexibility and productivity to developers or other users of the catalogs to life cycle various OSS tools as and when required using a </span><span class="No-Break"><span class="koboSpan" id="kobo.193.1">published catalog.</span></span></p>
<p><span class="koboSpan" id="kobo.194.1">Let’s understand how these components work together to provide the required functionalities. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.195.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.196.1">.2</span></em><span class="koboSpan" id="kobo.197.1"> describes the overall process to define the OSS catalog on the VAC portal and consume those catalog artifacts either using Kubeapps or </span><strong class="bold"><span class="koboSpan" id="kobo.198.1">continuous deployment</span></strong><span class="koboSpan" id="kobo.199.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.200.1">CD</span></strong><span class="koboSpan" id="kobo.201.1">) automation in </span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">its place.</span></span></p>
<h2 id="_idParaDest-83"><a id="_idTextAnchor083"/><span class="koboSpan" id="kobo.203.1">The VAC management and consumption process</span></h2>
<p><span class="koboSpan" id="kobo.204.1">After reviewing the key components of this offering in the previous section, let’s now understand how everything works together to provide end-to-end functionality of catalog curation and consumption using VAC. </span><span class="koboSpan" id="kobo.204.2">The following points correspond to each number given in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.205.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.206.1">.2</span></em><span class="koboSpan" id="kobo.207.1"> and describe what happens during that step of the process. </span><span class="koboSpan" id="kobo.207.2">The cloud in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.208.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.209.1">.2</span></em><span class="koboSpan" id="kobo.210.1"> depicts the SaaS infrastructure of VAC, and the rectangle defines the infrastructure boundary of the client organization. </span><span class="koboSpan" id="kobo.210.2">This client infrastructure may be either a private data center, a public cloud, or a combination </span><span class="No-Break"><span class="koboSpan" id="kobo.211.1">of both:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.212.1">A catalog administrator within the client organization with access to the VMware Cloud account defines a new catalog of selected OSS tools. </span><span class="koboSpan" id="kobo.212.2">In this step, the catalog admin also selects the base container OS to be used, whether to include or exclude Helm charts for the selected items and provides a container repository reference to where the catalog artifacts will be pushed for </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">secure consumption.</span></span></li>
<li><span class="koboSpan" id="kobo.214.1">Once the catalog administrator submits a catalog configuration, VAC automation processes take it forward to deploy the required automation pipelines to create a stream of container images and Helm charts that can be generated as per the specifications provided by the catalog administrator in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.215.1">step 1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.217.1">The VAC automation process pulls required OSS binaries from authorized third-party sources based on each selected OSS tool. </span><span class="koboSpan" id="kobo.217.2">After getting the required binaries, VAC automation performs certain operations, including automation testing of the OSS tool’s version, packaging the tool using the client-specified OS image layer, preparing a container specification report, and performing anti-virus and CVE scans. </span><span class="koboSpan" id="kobo.217.3">This step gets repeated for each newer version of each OSS tool covered </span><span class="No-Break"><span class="koboSpan" id="kobo.218.1">by VAC.</span></span></li>
<li><span class="koboSpan" id="kobo.219.1">Once a catalog item is ready for consumption, it is pushed to a target container registry as specified by the catalog administrator in </span><em class="italic"><span class="koboSpan" id="kobo.220.1">step 1</span></em><span class="koboSpan" id="kobo.221.1">. </span><span class="koboSpan" id="kobo.221.2">This step is also repeated for each OSS tool’s version that is prepared in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.222.1">step 3</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.223.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.224.1">Once a catalog item is pushed in the target container registry, a catalog administrator may pull the required reports that were prepared in </span><em class="italic"><span class="koboSpan" id="kobo.225.1">step 3</span></em><span class="koboSpan" id="kobo.226.1"> for the published artifacts such as CVE scan reports and others. </span><span class="koboSpan" id="kobo.226.2">The VAC portal also specifies required CLI commands to use the container images and Helm charts for the </span><span class="No-Break"><span class="koboSpan" id="kobo.227.1">published artifacts.</span></span></li>
<li><span class="koboSpan" id="kobo.228.1">In this step, the catalog administrator configures the published catalog on Kubeapps for </span><span class="No-Break"><span class="koboSpan" id="kobo.229.1">internal consumption.</span></span></li>
<li><span class="koboSpan" id="kobo.230.1">In this step, Kubeapps pulls the required details of the catalog to publish on the GUI </span><span class="No-Break"><span class="koboSpan" id="kobo.231.1">for consumption.</span></span></li>
<li><span class="koboSpan" id="kobo.232.1">Once the catalog is configured on Kubeapps, a catalog consumer may access Kubeapps GUI to deploy the required OSS tool as a </span><span class="No-Break"><span class="koboSpan" id="kobo.233.1">Kubernetes deployment:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer032">
<span class="koboSpan" id="kobo.234.1"><img alt="Figure 4.2 – The VAC management and consumption process" src="image/B18145_04_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.235.1">Figure 4.2 – The VAC management and consumption process</span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.236.1">Upon receiving the request from a catalog consumer to deploy a tool using its Helm chart on the Kubeapps GUI, Kubeapps pulls the required Helm chart and container images for the deployment of the tool from the container registry where the artifacts were pushed in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.237.1">step 4</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.238.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.239.1">The Helm installer triggered by Kubeapps deploys the OSS tool on the targeted Kubernetes cluster using the configuration supplied by the catalog consumer in </span><em class="italic"><span class="koboSpan" id="kobo.240.1">step 8</span></em><span class="koboSpan" id="kobo.241.1">. </span><span class="koboSpan" id="kobo.241.2">At the end of this step, we have a running instance of the OSS tool in the targeted Kubernetes cluster. </span><span class="koboSpan" id="kobo.241.3">In most cases, this step gets completed within a </span><span class="No-Break"><span class="koboSpan" id="kobo.242.1">few minutes.</span></span></li>
<li><span class="koboSpan" id="kobo.243.1">This step describes an alternative way of consuming the VAC-supplied artifacts using a CD automation process. </span><span class="koboSpan" id="kobo.243.2">This step can be configured to be triggered every time there is a newer version of the artifact available in the container registry to initiate an automated </span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">deployment process.</span></span></li>
<li><span class="koboSpan" id="kobo.245.1">In this step, the CD process deploys the downloaded OSS tool in the targeted </span><span class="No-Break"><span class="koboSpan" id="kobo.246.1">Kubernetes cluster.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.247.1">The following figure shows all these steps as a summary highlighting what VAC is and how it </span><span class="No-Break"><span class="koboSpan" id="kobo.248.1">is used:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer033">
<span class="koboSpan" id="kobo.249.1"><img alt="Figure 4.3 – VAC at a high level (https://docs.vmware.com/)" src="image/B18145_04_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.250.1">Figure 4.3 – VAC at a high level (https://docs.vmware.com/)</span></p>
<p><span class="koboSpan" id="kobo.251.1">With this, we covered the details required to understand the history of VAC, how VAC got its current name, the key components of VAC, and the end-to-end process involving catalog creation to consumption. </span><span class="koboSpan" id="kobo.251.2">Now let’s get started using VAC to better understand how to </span><span class="No-Break"><span class="koboSpan" id="kobo.252.1">consume it.</span></span></p>
<h1 id="_idParaDest-84"><a id="_idTextAnchor084"/><span class="koboSpan" id="kobo.253.1">Getting started with VMware Application Catalog</span></h1>
<p><span class="koboSpan" id="kobo.254.1">In this part of the chapter, we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">following details:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.256.1">How to configure an </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">application catalog</span></span></li>
<li><span class="koboSpan" id="kobo.258.1">How to install Kubeapps on a </span><span class="No-Break"><span class="koboSpan" id="kobo.259.1">Kubernetes cluster</span></span></li>
<li><span class="koboSpan" id="kobo.260.1">How to configure Kubeapps to use </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">a catalog</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.262.1">So, let’s get started with hands-on work. </span><span class="koboSpan" id="kobo.262.2">But before that, we need the following </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">prerequisites fulfilled.</span></span></p>
<h2 id="_idParaDest-85"><a id="_idTextAnchor085"/><span class="koboSpan" id="kobo.264.1">Prerequisites</span></h2>
<p><span class="koboSpan" id="kobo.265.1">The following points list prerequisites to </span><span class="No-Break"><span class="koboSpan" id="kobo.266.1">operationalize VAC:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.267.1">A VMware Cloud Services (</span><a href="https://console.cloud.vmware.com/"><span class="koboSpan" id="kobo.268.1">https://console.cloud.vmware.com/</span></a><span class="koboSpan" id="kobo.269.1">) account with </span><span class="No-Break"><span class="koboSpan" id="kobo.270.1">VAC access</span></span></li>
<li><span class="koboSpan" id="kobo.271.1">One of the following container repositories that can be accessed by VAC to push </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">catalog items:</span></span><ul><li><span class="No-Break"><span class="koboSpan" id="kobo.273.1">GCR</span></span></li><li><span class="koboSpan" id="kobo.274.1">Azure </span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">Container Registry</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.276.1">Harbor</span></span></li></ul></li>
<li><span class="koboSpan" id="kobo.277.1">A Kubernetes cluster with the </span><span class="No-Break"><span class="koboSpan" id="kobo.278.1">following attributes:</span></span><ul><li><span class="koboSpan" id="kobo.279.1">Version 1.19 </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">or later</span></span></li><li><span class="koboSpan" id="kobo.281.1">Outbound </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">internet access</span></span></li><li><span class="koboSpan" id="kobo.283.1">Container registry access that is used </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">by VAC</span></span></li><li><span class="koboSpan" id="kobo.285.1">Automated </span><strong class="bold"><span class="koboSpan" id="kobo.286.1">Persistent Volume</span></strong><span class="koboSpan" id="kobo.287.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.288.1">PV</span></strong><span class="koboSpan" id="kobo.289.1">) creation based on </span><strong class="bold"><span class="koboSpan" id="kobo.290.1">Persistent Volume </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.291.1">Claims</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.292.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.293.1">PVC</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">)</span></span></li></ul></li>
<li><span class="koboSpan" id="kobo.295.1">A workstation with either Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.296.1">or macOS</span></span></li>
<li><span class="koboSpan" id="kobo.297.1">Helm v3.x installed on the </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">workstation machine</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.299.1">Helm installation</span></p>
<p class="callout"><span class="koboSpan" id="kobo.300.1">Use this documentation if you need help with the Helm </span><span class="No-Break"><span class="koboSpan" id="kobo.301.1">installation: </span></span><a href="https://docs.bitnami.com/kubernetes/get-started-kubernetes/#step-4-install-and-configure-helm"><span class="No-Break"><span class="koboSpan" id="kobo.302.1">https://docs.bitnami.com/kubernetes/get-started-kubernetes/#step-4-install-and-configure-helm</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.303.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.304.1">Let’s start by defining a catalog of backend services that can be accessed by various applications. </span><span class="koboSpan" id="kobo.304.2">We will select MySQL, a relational database, as an example of an OSS catalog item to describe various details later in the chapter. </span><span class="koboSpan" id="kobo.304.3">In real life, we may add many other OSS tools to the catalog and use them in a similar way. </span><span class="koboSpan" id="kobo.304.4">You can find a broader list of available OSS tools on the VAC portal for </span><span class="No-Break"><span class="koboSpan" id="kobo.305.1">catalog creation.</span></span></p>
<h2 id="_idParaDest-86"><a id="_idTextAnchor086"/><span class="koboSpan" id="kobo.306.1">Creating a catalog on the VAC portal</span></h2>
<p><span class="koboSpan" id="kobo.307.1">To create a catalog on the VAC portal, take the </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">following steps:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.309.1">Log in to your VMware Cloud Services account and select </span><strong class="bold"><span class="koboSpan" id="kobo.310.1">VMware Application Catalog</span></strong><span class="koboSpan" id="kobo.311.1"> from the available services. </span><span class="koboSpan" id="kobo.311.2">If you do not see that service listed, then you may need to reach out to your VMware account team member to </span><span class="No-Break"><span class="koboSpan" id="kobo.312.1">get access:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer034">
<span class="koboSpan" id="kobo.313.1"><img alt="Figure 4.4 – Select VAC from the list of services" src="image/B18145_04_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.314.1">Figure 4.4 – Select VAC from the list of services</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.315.1">You will see an empty catalog page, as shown in the following figure as there will be no catalog items previously added. </span><span class="koboSpan" id="kobo.315.2">Click on the </span><strong class="bold"><span class="koboSpan" id="kobo.316.1">ADD NEW APPLICATIONS</span></strong><span class="koboSpan" id="kobo.317.1"> button shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.318.1">following figure:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer035">
<span class="koboSpan" id="kobo.319.1"><img alt="Figure 4.5 – The ADD NEW APPLICATIONS button in an empty catalog" src="image/B18145_04_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.320.1">Figure 4.5 – The ADD NEW APPLICATIONS button in an empty catalog</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.321.1">Select the base OS layer for the catalog artifacts. </span><span class="koboSpan" id="kobo.321.2">As mentioned before in this chapter, we will focus on the Kubernetes-based application catalog and not on virtual machines. </span><span class="koboSpan" id="kobo.321.3">As a simple example, </span><strong class="bold"><span class="koboSpan" id="kobo.322.1">Ubuntu 18.04</span></strong><span class="koboSpan" id="kobo.323.1"> is selected as the base OS layer, but you may also select the </span><strong class="bold"><span class="koboSpan" id="kobo.324.1">Custom Base Image</span></strong><span class="koboSpan" id="kobo.325.1"> option. </span><span class="koboSpan" id="kobo.325.2">For more details on that visit the product documentation for VAC </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">at </span></span><a href="https://docs.vmware.com/en/VMware-Application-Catalog/services/main/GUID-get-started-get-started-vmware-application-catalog.html#step-3-create-custom-catalogs-5"><span class="No-Break"><span class="koboSpan" id="kobo.327.1">https://docs.vmware.com/en/VMware-Application-Catalog/services/main/GUID-get-started-get-started-vmware-application-catalog.html#step-3-create-custom-catalogs-5</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.328.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer036">
<span class="koboSpan" id="kobo.329.1"><img alt="Figure 4.6 – Base OS selection for catalog items" src="image/B18145_04_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.330.1">Figure 4.6 – Base OS selection for catalog items</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.331.1">Select the required OSS items from the available options to include in the catalog. </span><span class="koboSpan" id="kobo.331.2">You may also search for them </span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">if required:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer037">
<span class="koboSpan" id="kobo.333.1"><img alt="Figure 4.7 – Select catalog items" src="image/B18145_04_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.334.1">Figure 4.7 – Select catalog items</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.335.1">Add the destination container registry by clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.336.1">ADD REGISTRY</span></strong><span class="koboSpan" id="kobo.337.1"> button to get the required catalog </span><span class="No-Break"><span class="koboSpan" id="kobo.338.1">artifacts delivered:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer038">
<span class="koboSpan" id="kobo.339.1"><img alt="Figure 4.8 – Add the container registry" src="image/B18145_04_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.340.1">Figure 4.8 – Add the container registry</span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.341.1">Provide the required details for the container registry to allow VAC to push catalog artifacts </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">to it:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer039">
<span class="koboSpan" id="kobo.343.1"><img alt="Figure 4.9 – Add registry details" src="image/B18145_04_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.344.1">Figure 4.9 – Add registry details</span></p>
<p><span class="koboSpan" id="kobo.345.1">Though </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.346.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.347.1">.9</span></em><span class="koboSpan" id="kobo.348.1"> shows the details for GCR, it also supports other registries, including Azure Container Registry and Harbor. </span><span class="koboSpan" id="kobo.348.2">You can get more information regarding other registries </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">at: </span></span><a href="https://docs.vmware.com/en/VMware-Application-Catalog/services/main/GUID-get-started-get-started-vmware-application-catalog.html#step-3-create-custom-catalogs-5"><span class="No-Break"><span class="koboSpan" id="kobo.350.1">https://docs.vmware.com/en/VMware-Application-Catalog/services/main/GUID-get-started-get-started-vmware-application-catalog.html#step-3-create-custom-catalogs-5</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.351.1">.</span></span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.352.1">Give a name and description to </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">this catalog:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer040">
<span class="koboSpan" id="kobo.354.1"><img alt="Figure 4.10 – Add name and description for the catalog" src="image/B18145_04_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.355.1">Figure 4.10 – Add name and description for the catalog</span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.356.1">Verify the input summary and submit the </span><span class="No-Break"><span class="koboSpan" id="kobo.357.1">catalog request:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer041">
<span class="koboSpan" id="kobo.358.1"><img alt="Figure 4.11 – Submit the catalog request" src="image/B18145_04_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.359.1">Figure 4.11 – Submit the catalog request</span></p>
<p><span class="koboSpan" id="kobo.360.1">After this, we will see a message confirming our catalog request submission. </span><span class="koboSpan" id="kobo.360.2">It may take about a couple of weeks to review and process this request before we start getting our catalog items delivered to our selected container </span><span class="No-Break"><span class="koboSpan" id="kobo.361.1">registry destination.</span></span></p>
<p><span class="koboSpan" id="kobo.362.1">That’s it. </span><span class="koboSpan" id="kobo.362.2">We have our catalog of OSS tools defined so that we can publish to internal consumers for easy and quick access. </span><span class="koboSpan" id="kobo.362.3">But how can they access this catalog? </span><span class="koboSpan" id="kobo.362.4">Let’s check that out in the </span><span class="No-Break"><span class="koboSpan" id="kobo.363.1">next section.</span></span></p>
<h2 id="_idParaDest-87"><a id="_idTextAnchor087"/><span class="koboSpan" id="kobo.364.1">Consuming VAC using Kubeapps</span></h2>
<p><span class="koboSpan" id="kobo.365.1">In the previous section, we learned how to request an application catalog on the VAC portal. </span><span class="koboSpan" id="kobo.365.2">Once we start getting our Helm charts and container images delivered in our container registry, we can access those tools using Kubeapps, a GUI to manage Kubernetes-based software deployments. </span><span class="koboSpan" id="kobo.365.3">We discussed Kubeapps in detail in the </span><em class="italic"><span class="koboSpan" id="kobo.366.1">Components of VAC</span></em><span class="koboSpan" id="kobo.367.1"> section covered previously in this chapter. </span><span class="koboSpan" id="kobo.367.2">Let’s see how to install and configure </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">it now.</span></span></p>
<h3><span class="koboSpan" id="kobo.369.1">Kubeapps installation</span></h3>
<p><span class="koboSpan" id="kobo.370.1">Kubeapps is itself a Kubernetes-based deployment to manage other Kubernetes deployments that can be deployed using Helm charts and operators. </span><span class="koboSpan" id="kobo.370.2">Since we are planning to use Kubeapps to consume our VAC-supplied distributions that include Helm charts and container images, we will not cover the usage of operators in this section. </span><span class="koboSpan" id="kobo.370.3">As a deployment topology, we can install Kubeapps on any Kubernetes cluster to deploy catalog items on the same or any other Kubernetes clusters and their Kubernetes namespaces that are linked with Kubeapps. </span><span class="koboSpan" id="kobo.370.4">In this chapter, we will use a single Kubernetes cluster to minimize </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">configuration complexity.</span></span></p>
<p><span class="koboSpan" id="kobo.372.1">We will need to fulfill some requirements to move forward, as they are covered previously in the </span><em class="italic"><span class="koboSpan" id="kobo.373.1">Prerequisites</span></em><span class="koboSpan" id="kobo.374.1"> section of this chapter. </span><span class="koboSpan" id="kobo.374.2">The following steps describe the installation and configuration of Kubeapps on a Kubernetes cluster with </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">sufficient resources:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.376.1">Add a Bitnami Helm chart repository to your local </span><span class="No-Break"><span class="koboSpan" id="kobo.377.1">Helm library:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.378.1">
$ helm repo add bitnami https://charts.bitnami.com/bitnami</span></pre></li>
<li><span class="koboSpan" id="kobo.379.1">Create a Kubernetes namespace </span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">for Kubeapps:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.381.1">
$ kubectl create namespace kubeapps</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.382.1">
namespace/kubeapps created</span></pre></li>
<li><span class="koboSpan" id="kobo.383.1">Install Kubeapps in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.384.1">kubeapps</span></strong><span class="koboSpan" id="kobo.385.1"> namespace using a </span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">Helm chart:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.387.1">
$ helm install kubeapps --namespace kubeapps bitnami/kubeapps</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.388.1">
NAME: kubeapps</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.389.1">
LAST DEPLOYED: Wed Jan 19 19:45:20 2022</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.390.1">
NAMESPACE: kubeapps</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.391.1">
STATUS: deployed</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.392.1">
REVISION: 1</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.393.1">
TEST SUITE: None</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.394.1">
NOTES:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.395.1">
CHART NAME: kubeapps</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.396.1">
CHART VERSION: 7.7.0</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.397.1">
...</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.398.1">
...</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.399.1">The preceding output is truncated for conciseness. </span><span class="koboSpan" id="kobo.399.2">With this, we have Kubeapps running in our cluster. </span><span class="koboSpan" id="kobo.399.3">Let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.400.1">verify it.</span></span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.401.1">Verify the Kubeapps deployment to see if everything is </span><span class="No-Break"><span class="koboSpan" id="kobo.402.1">running fine:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.403.1">
$ kubectl get all -n kubeapps</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.404.1">The preceding command should list </span><strong class="source-inline"><span class="koboSpan" id="kobo.405.1">pods</span></strong><span class="koboSpan" id="kobo.406.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">services</span></strong><span class="koboSpan" id="kobo.408.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.409.1">deployments</span></strong><span class="koboSpan" id="kobo.410.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.411.1">replicasets</span></strong><span class="koboSpan" id="kobo.412.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.413.1">statefulsets</span></strong><span class="koboSpan" id="kobo.414.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.415.1">jobs</span></strong><span class="koboSpan" id="kobo.416.1"> that are not listed here </span><span class="No-Break"><span class="koboSpan" id="kobo.417.1">for brevity.</span></span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.418.1">Create a temporary service account to access the </span><span class="No-Break"><span class="koboSpan" id="kobo.419.1">Kubeapps GUI:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.420.1">
$ kubectl create --namespace default serviceaccount kubeapps-operator</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.421.1">
serviceaccount/kubeapps-operator created</span></pre></li>
<li><span class="koboSpan" id="kobo.422.1">Link the service account with a Kubernetes role to allow </span><span class="No-Break"><span class="koboSpan" id="kobo.423.1">required access:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.424.1">
$ kubectl create clusterrolebinding kubeapps-operator --clusterrole=cluster-admin --serviceaccount=default:kubeapps-operator</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.425.1">
clusterrolebinding.rbac.authorization.k8s.io/kubeapps-operator created</span></pre></li>
<li><span class="koboSpan" id="kobo.426.1">Retrieve the access token for the account to log in to the </span><span class="No-Break"><span class="koboSpan" id="kobo.427.1">Kubeapps GUI:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.428.1">
$ kubectl get --namespace default secret $(kubectl get --namespace default serviceaccount kubeapps-operator -o jsonpath='{range .secrets[*]}{.name}{"\n"}{end}' | grep kubeapps-operator-token) -o jsonpath='{.data.token}' -o go-template='{{.data.token | base64decode}}' &amp;&amp; echo</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.429.1">This long command will print a long string of characters, which is the token that we will use to log in to the Kubeapps GUI. </span><span class="koboSpan" id="kobo.429.2">Save this token for </span><span class="No-Break"><span class="koboSpan" id="kobo.430.1">future reference.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.431.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.432.1">The previous three commands to create access permissions for Kubeapps use a very primitive approach for simplicity and as an easy learning reference. </span><span class="koboSpan" id="kobo.432.2">In a production-grade implementation, we may need to use a more sophisticated approach to configure real enterprise users who can access Kubeapps in the Kubernetes namespace. </span><span class="koboSpan" id="kobo.432.3">Such user permissions are generally managed using an external integration with either an OIDC or LDAP identity provider. </span><span class="koboSpan" id="kobo.432.4">Additionally, using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.433.1">cluster-admin</span></strong><span class="koboSpan" id="kobo.434.1"> role is not a secure approach and should not be used other than for such </span><span class="No-Break"><span class="koboSpan" id="kobo.435.1">learning purposes.</span></span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.436.1">Expose the Kubeapps GUI to access it locally in a browser. </span><span class="koboSpan" id="kobo.436.2">For a production-grade deployment, the GUI should be assigned a proper domain name and exposed outside the Kubernetes cluster using a load balancer. </span><span class="koboSpan" id="kobo.436.3">In this step, we will use Kubernetes port forwarding for quick and simple access to </span><span class="No-Break"><span class="koboSpan" id="kobo.437.1">the deployment:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.438.1">
$ kubectl port-forward -n kubeapps svc/kubeapps 8080:80</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.439.1">
Forwarding from 127.0.0.1:8080 -&gt; 8080</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.440.1">
Forwarding from [::1]:8080 -&gt; 8080</span></pre></li>
<li><span class="koboSpan" id="kobo.441.1">Access Kubeapps in your local browser using </span><strong class="source-inline"><span class="koboSpan" id="kobo.442.1">http://localhost:8080/</span></strong><span class="koboSpan" id="kobo.443.1">. </span><span class="koboSpan" id="kobo.443.2">This should open the following screen </span><span class="No-Break"><span class="koboSpan" id="kobo.444.1">of Kubeapps:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer042">
<span class="koboSpan" id="kobo.445.1"><img alt="Figure 4.12 – Kubeapps GUI – authentication page" src="image/B18145_04_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.446.1">Figure 4.12 – Kubeapps GUI – authentication page</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.447.1">Access Kubeapps using the token retrieved in </span><em class="italic"><span class="koboSpan" id="kobo.448.1">step 7</span></em><span class="koboSpan" id="kobo.449.1">. </span><span class="koboSpan" id="kobo.449.2">Paste the token value on the login page and submit. </span><span class="koboSpan" id="kobo.449.3">This should open Kubeapps GUI as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.450.1">Figure 4</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.451.1">.13</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.452.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer043">
<span class="koboSpan" id="kobo.453.1"><img alt="Figure 4.13 – Kubeapps GUI – initial landing page" src="image/B18145_04_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.454.1">Figure 4.13 – Kubeapps GUI – initial landing page</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.455.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.456.1">The screenshots and steps described in this chapter are based on the presently available versions of VAC and Kubeapps. </span><span class="koboSpan" id="kobo.456.2">Depending on when this book is read, the content and experience could be different based on the future changes incorporated into </span><span class="No-Break"><span class="koboSpan" id="kobo.457.1">these products.</span></span></p>
<p><span class="koboSpan" id="kobo.458.1">As you will see, Kubeapps comes with a configuration to access the publicly available generic Bitnami catalog. </span><span class="koboSpan" id="kobo.458.2">Once our customer catalog defined on the VAC portal is ready, and we start getting its artifacts, we may configure Kubeapps to use the same. </span><span class="koboSpan" id="kobo.458.3">We will cover the linking of our custom application catalog on Kubeapps later in </span><span class="No-Break"><span class="koboSpan" id="kobo.459.1">day-two activities.</span></span></p>
<p><span class="koboSpan" id="kobo.460.1">With this, we conclude this section of the chapter on getting started with VAC and Kubeapps. </span><span class="koboSpan" id="kobo.460.2">We have seen how to create a catalog on the VAC portal and install Kubeapps in a Kubernetes cluster. </span><span class="koboSpan" id="kobo.460.3">In the next section, we will see the following items, covering common day-two activities </span><span class="No-Break"><span class="koboSpan" id="kobo.461.1">around VAC:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.462.1">How to inspect delivered catalog artifacts and obtain </span><span class="No-Break"><span class="koboSpan" id="kobo.463.1">required reports</span></span></li>
<li><span class="koboSpan" id="kobo.464.1">How to link VAC with Kubeapps to publish it </span><span class="No-Break"><span class="koboSpan" id="kobo.465.1">for consumption</span></span></li>
<li><span class="koboSpan" id="kobo.466.1">How to consume catalog items via automation pipeline </span><span class="No-Break"><span class="koboSpan" id="kobo.467.1">using Kubeapps</span></span></li>
<li><span class="koboSpan" id="kobo.468.1">How to deploy MySQL as a backend service running on the Kubernetes cluster </span><span class="No-Break"><span class="koboSpan" id="kobo.469.1">using Kubeapps</span></span></li>
<li><span class="koboSpan" id="kobo.470.1">How to manage </span><span class="No-Break"><span class="koboSpan" id="kobo.471.1">catalog items</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.472.1">Let’s now learn how to </span><span class="No-Break"><span class="koboSpan" id="kobo.473.1">use VAC.</span></span></p>
<h1 id="_idParaDest-88"><a id="_idTextAnchor088"/><span class="koboSpan" id="kobo.474.1">Common day-two activities with VAC</span></h1>
<p><span class="koboSpan" id="kobo.475.1">With the details covered in the previous section of the chapter, we now have an OSS tool catalog request placed on the VAC portal and a Kubeapps instance running in the Kubernetes cluster. </span><span class="koboSpan" id="kobo.475.2">Let’s now review some of the key day-two activities that can be performed by the catalog administrator to ensure security and compliance of the OSS tool usage, and by the catalog consumers to unleash productivity and flexibility to quickly deploy and use these OSS tools in different ways that are part of the </span><span class="No-Break"><span class="koboSpan" id="kobo.476.1">VAC catalog.</span></span></p>
<h2 id="_idParaDest-89"><a id="_idTextAnchor089"/><span class="koboSpan" id="kobo.477.1">Inspecting catalog deliverables</span></h2>
<p><span class="koboSpan" id="kobo.478.1">Once our catalog request is submitted to Vmware using the VAC portal, as we covered in the previous section, we can check the status of our catalog deliverables using the VAC portal as shown in the following figure under the </span><strong class="bold"><span class="koboSpan" id="kobo.479.1">My </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.480.1">Requests</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.481.1"> tab:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer044">
<span class="koboSpan" id="kobo.482.1"><img alt="Figure 4.14 – Checking VAC request status" src="image/B18145_04_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.483.1">Figure 4.14 – Checking VAC request status</span></p>
<p><span class="koboSpan" id="kobo.484.1">When we have our catalog request completed, we start seeing our delivered artifacts under the </span><strong class="bold"><span class="koboSpan" id="kobo.485.1">My Applications</span></strong><span class="koboSpan" id="kobo.486.1"> page, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.487.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer045">
<span class="koboSpan" id="kobo.488.1"><img alt="Figure 4.15 – Listing catalog applications on the VAC portal" src="image/B18145_04_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.489.1">Figure 4.15 – Listing catalog applications on the VAC portal</span></p>
<p><span class="koboSpan" id="kobo.490.1">Depending on our selection during the catalog creation request, we may see Helm charts and their container images, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.491.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.492.1">.15</span></em><span class="koboSpan" id="kobo.493.1">. </span><span class="koboSpan" id="kobo.493.2">Let’s now check the details of the MySQL container image by clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.494.1">DETAILS</span></strong><span class="koboSpan" id="kobo.495.1"> link given for the item on the right. </span><span class="koboSpan" id="kobo.495.2">The following screenshot shows the details for the MySQL </span><span class="No-Break"><span class="koboSpan" id="kobo.496.1">container image:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer046">
<span class="koboSpan" id="kobo.497.1"><img alt="Figure 4.16 – Details of a catalog item on the VAC portal" src="image/B18145_04_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.498.1">Figure 4.16 – Details of a catalog item on the VAC portal</span></p>
<p><span class="koboSpan" id="kobo.499.1">We can get the following details from different sections of a catalog item’s details page, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.500.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.501.1">.16</span></em><span class="koboSpan" id="kobo.502.1">. </span><span class="koboSpan" id="kobo.502.2">The numbers in the following list correspond to the numbers given in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.503.1">Figure 4</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.504.1">.16</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">:</span></span></p>
<ol>
<li value="1"><strong class="bold"><span class="koboSpan" id="kobo.506.1">Digest</span></strong><span class="koboSpan" id="kobo.507.1">: This is the name and the location of the artifact that is placed in our destination container registry that we supplied during </span><span class="No-Break"><span class="koboSpan" id="kobo.508.1">catalog creation.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.509.1">Consume your Container Image</span></strong><span class="koboSpan" id="kobo.510.1">: This is the Docker command to pull this container image into a Docker </span><span class="No-Break"><span class="koboSpan" id="kobo.511.1">runtime environment.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.512.1">Container Tags</span></strong><span class="koboSpan" id="kobo.513.1">: These are different tag alias for this container image that we can use in a Kubernetes deployment manifest file to pull this container image for running this application </span><span class="No-Break"><span class="koboSpan" id="kobo.514.1">on Kubernetes.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.515.1">Validation Reports</span></strong><span class="koboSpan" id="kobo.516.1">: This allows us to download the automation test result log file that was generated to test this version of MySQL before creating this </span><span class="No-Break"><span class="koboSpan" id="kobo.517.1">container image.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.518.1">Build Time Reports</span></strong><span class="koboSpan" id="kobo.519.1">: This section contains various container build reports, including anti-virus and CVE scan reports and an asset specification (bill of material) report containing the list of software with their versions used in the </span><span class="No-Break"><span class="koboSpan" id="kobo.520.1">container image.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.521.1">Release Relationship</span></strong><span class="koboSpan" id="kobo.522.1">: This section shows the dependent Helm charts that use </span><span class="No-Break"><span class="koboSpan" id="kobo.523.1">this image.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.524.1">Like the details of a container image, the details of the corresponding Helm chart include required </span><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">helm</span></strong><span class="koboSpan" id="kobo.526.1"> CLI commands to deploy the chart, test results for the chart, asset specification, and container </span><span class="No-Break"><span class="koboSpan" id="kobo.527.1">image dependencies.</span></span></p>
<h2 id="_idParaDest-90"><a id="_idTextAnchor090"/><span class="koboSpan" id="kobo.528.1">Using the application catalog</span></h2>
<p><span class="koboSpan" id="kobo.529.1">After inspecting the required details for the artifacts supplied for our catalog items on the VAC portal, it’s time to use them to deploy those tools in our environment. </span><span class="koboSpan" id="kobo.529.2">There are various ways we can use those container images provided by VAC. </span><span class="koboSpan" id="kobo.529.3">Depending on the requirement of the tool, we can simply run some tools in our workstation’s container runtime environment, such as Docker. </span><span class="koboSpan" id="kobo.529.4">However, for an enterprise-grade deployment, we need several supporting components to run a tool. </span><span class="koboSpan" id="kobo.529.5">For example, we saw that all Kubernetes resources were created to deploy and run our Kubeapps instance that we deployed previously in this chapter. </span><span class="koboSpan" id="kobo.529.6">One possible way to deploy such tools is to use deployment automation using custom scripts and CI/CD tools such as Jenkins and/or </span><strong class="bold"><span class="koboSpan" id="kobo.530.1">ArgoCD</span></strong><span class="koboSpan" id="kobo.531.1"> using a </span><strong class="bold"><span class="koboSpan" id="kobo.532.1">GitOps</span></strong><span class="koboSpan" id="kobo.533.1">-based deployment model. </span><span class="koboSpan" id="kobo.533.2">Another possible option is to use a Kubernetes packaging tool such as Helm charts. </span><span class="koboSpan" id="kobo.533.3">A Helm chart bundles all required dependencies to deploy and run corresponding objects for a tool on a Kubernetes cluster. </span><span class="koboSpan" id="kobo.533.4">Using a tool such as Helm charts makes it very easy to configure and quickly deploy the tool with all its required components with minimal effort and within a few minutes. </span><span class="koboSpan" id="kobo.533.5">As we have seen previously, VAC allows us to select containers as well as Helm charts for our catalog items wherever applicable. </span><span class="koboSpan" id="kobo.533.6">As a part of application packaging, Helm charts also allow exposing certain configuration properties that we may need to change for different deployments. </span><span class="koboSpan" id="kobo.533.7">We can use these Helm charts provided by VAC to deploy those tools with our custom configuration requirements. </span><span class="koboSpan" id="kobo.533.8">For example, for a MySQL database deployment, we can change attributes such as its name, login credentials, storage volume size, and </span><span class="No-Break"><span class="koboSpan" id="kobo.534.1">many more.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.535.1">What is GitOps?</span></p>
<p class="callout"><span class="koboSpan" id="kobo.536.1">GitOps upholds the principle that Git is the one and only source of truth. </span><span class="koboSpan" id="kobo.536.2">GitOps requires the desired state of the system to be stored in version control so that anyone can view the history of changes. </span><span class="koboSpan" id="kobo.536.3">All changes to the desired state are performed through Git </span><em class="italic"><span class="koboSpan" id="kobo.537.1">commits</span></em><span class="koboSpan" id="kobo.538.1">. </span><span class="No-Break"><span class="koboSpan" id="kobo.539.1">Source: </span></span><a href="https://blogs.vmware.com/management/2020/08/ops-powered-by-git-gitops-in-vrealize-automation.html"><span class="No-Break"><span class="koboSpan" id="kobo.540.1">https://blogs.vmware.com/management/2020/08/ops-powered-by-git-gitops-in-vrealize-automation.html</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.541.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.542.1">As we discussed previously, Kubeapps is a tool to deploy and manage our catalog of Helm charts that we have configured on VAC. </span><span class="koboSpan" id="kobo.542.2">So, let’s check out how we can link those Helm charts provided by VAC with our Kubeapps instance that we deployed previously in </span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">this chapter.</span></span></p>
<h3><span class="koboSpan" id="kobo.544.1">Adding the application catalog to Kubeapps</span></h3>
<p><span class="koboSpan" id="kobo.545.1">The following steps describe how to configure a new catalog on our Kubeapps instance for the Helm charts provided </span><span class="No-Break"><span class="koboSpan" id="kobo.546.1">by VAC:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.547.1">Obtain the chart repository location where the Helm charts are located. </span><span class="koboSpan" id="kobo.547.2">You can find the same on the details page of a Helm chart item in your catalog on the VAC portal, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.548.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer047">
<span class="koboSpan" id="kobo.549.1"><img alt="Figure 4.17 – Getting the Helm chart repository location" src="image/B18145_04_17.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.550.1">Figure 4.17 – Getting the Helm chart repository location</span></p>
<p><span class="koboSpan" id="kobo.551.1">The highlighted URL portion is the location of all the Helm charts for our catalog that we defined on the VAC portal. </span><span class="koboSpan" id="kobo.551.2">Make a note of this URL as we will use it in one of the </span><span class="No-Break"><span class="koboSpan" id="kobo.552.1">following steps:</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.553.1">Generate an API token for the VAC account on the VAC portal, which we will use to authenticate our Kubeapps instance to pull the Helm charts for selected catalog items. </span><span class="koboSpan" id="kobo.553.2">The following sub-steps describe how to generate an API token on the </span><span class="No-Break"><span class="koboSpan" id="kobo.554.1">VAC portal:</span></span><ol><li><span class="koboSpan" id="kobo.555.1">Go to the </span><strong class="bold"><span class="koboSpan" id="kobo.556.1">My Account</span></strong><span class="koboSpan" id="kobo.557.1"> page on the VAC portal using the drop-down menu in the top-right corner, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.558.1">following screenshot:</span></span></li></ol></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer048">
<span class="koboSpan" id="kobo.559.1"><img alt="Figure 4.18 – Go to the VAC My Account settings" src="image/B18145_04_18.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.560.1">Figure 4.18 – Go to the VAC My Account settings</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.561.1">Click on the </span><strong class="bold"><span class="koboSpan" id="kobo.562.1">API </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.563.1">Tokens</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.564.1"> tab:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer049">
<span class="koboSpan" id="kobo.565.1"><img alt="Figure 4.19 – Go to the API Tokens list page" src="image/B18145_04_19.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.566.1">Figure 4.19 – Go to the API Tokens list page</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.567.1">If there is already a token listed on this page that has access to the VAC service, then you can skip the following steps to generate a new API token and jump directly to </span><em class="italic"><span class="koboSpan" id="kobo.568.1">step 3</span></em><span class="koboSpan" id="kobo.569.1"> to add a repository in Kubeapps. </span><span class="koboSpan" id="kobo.569.2">Otherwise, click on the </span><strong class="bold"><span class="koboSpan" id="kobo.570.1">GENERATE A NEW API TOKEN</span></strong><span class="koboSpan" id="kobo.571.1"> link as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.572.1">following screenshot:</span></span></li>
</ol>
<p class="IMG---Figure"><span class="koboSpan" id="kobo.573.1">- </span></p>
<div>
<div class="IMG---Figure" id="_idContainer050">
<span class="koboSpan" id="kobo.574.1"><img alt="Figure 4.20 – Go to the API Tokens configuration page" src="image/B18145_04_20.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.575.1">Figure 4.20 – Go to the API Tokens configuration page</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.576.1">Enter the token configuration, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.577.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer051">
<span class="koboSpan" id="kobo.578.1"><img alt="Figure 4.21 – Generate a New API Token for VAC" src="image/B18145_04_21.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.579.1">Figure 4.21 – Generate a New API Token for VAC</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.580.1">You can change the name and duration of the token to your requirements. </span><span class="koboSpan" id="kobo.580.2">However, the scope is important to allow access to VAC from Kubeapps. </span><span class="koboSpan" id="kobo.580.3">It may not be a read-only or support role. </span><span class="koboSpan" id="kobo.580.4">You can also generate a generic token that can be used for all VMware Cloud Service offerings. </span><span class="koboSpan" id="kobo.580.5">However, it will be very broad in nature allowing all types of access to all services. </span><span class="koboSpan" id="kobo.580.6">Hence, it is </span><span class="No-Break"><span class="koboSpan" id="kobo.581.1">not recommended.</span></span></li>
<li><span class="koboSpan" id="kobo.582.1">Save the generated token for </span><span class="No-Break"><span class="koboSpan" id="kobo.583.1">future usage:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer052">
<span class="koboSpan" id="kobo.584.1"><img alt="Figure 4.22 – Save the generated token" src="image/B18145_04_22.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.585.1">Figure 4.22 – Save the generated token</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.586.1">Log in to the Kubeapps instance that we deployed and open its configuration menu using the top-right corner icon followed by the </span><strong class="bold"><span class="koboSpan" id="kobo.587.1">App Repositories</span></strong><span class="koboSpan" id="kobo.588.1"> option as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.589.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer053">
<span class="koboSpan" id="kobo.590.1"><img alt="Figure 4.23 – Add the Helm chart repository to Kubeapps" src="image/B18145_04_23.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.591.1">Figure 4.23 – Add the Helm chart repository to Kubeapps</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.592.1">Click on the </span><strong class="bold"><span class="koboSpan" id="kobo.593.1">ADD APP REPOSITORY</span></strong><span class="koboSpan" id="kobo.594.1"> button to configure the details of a </span><span class="No-Break"><span class="koboSpan" id="kobo.595.1">new repository:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer054">
<span class="koboSpan" id="kobo.596.1"><img alt="Figure 4.24 – Go to a new repository configuration page" src="image/B18145_04_24.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.597.1">Figure 4.24 – Go to a new repository configuration page</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.598.1">Give it a name, add the Helm chart repository URL captured in </span><em class="italic"><span class="koboSpan" id="kobo.599.1">step 1</span></em><span class="koboSpan" id="kobo.600.1">, paste the API token generated in </span><em class="italic"><span class="koboSpan" id="kobo.601.1">step 2</span></em><span class="koboSpan" id="kobo.602.1">, select the </span><strong class="bold"><span class="koboSpan" id="kobo.603.1">Skip TLS Verification</span></strong><span class="koboSpan" id="kobo.604.1"> option, and click the </span><strong class="bold"><span class="koboSpan" id="kobo.605.1">INSTALL </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.606.1">REPO</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.607.1"> button:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer055">
<span class="koboSpan" id="kobo.608.1"><img alt="Figure 4.25 – Install the VAC Helm repo in Kubeapps" src="image/B18145_04_25.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.609.1">Figure 4.25 – Install the VAC Helm repo in Kubeapps</span></p>
<p><span class="koboSpan" id="kobo.610.1">We had to select the </span><strong class="bold"><span class="koboSpan" id="kobo.611.1">Skip TLS Verification</span></strong><span class="koboSpan" id="kobo.612.1"> option, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.613.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.614.1">.25</span></em><span class="koboSpan" id="kobo.615.1">, as our Kubeapps deployment is not assigned an external facing domain name and a TLS certificate. </span><span class="koboSpan" id="kobo.615.2">In an enterprise-grade environment, this is not a </span><span class="No-Break"><span class="koboSpan" id="kobo.616.1">recommended approach.</span></span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.617.1">If you get a success message, then the catalog should be integrated with Kubeapps. </span><span class="koboSpan" id="kobo.617.2">To check that, click on the </span><strong class="bold"><span class="koboSpan" id="kobo.618.1">Catalog</span></strong><span class="koboSpan" id="kobo.619.1"> tab on Kubeapps and select the </span><strong class="bold"><span class="koboSpan" id="kobo.620.1">demo-catalog</span></strong><span class="koboSpan" id="kobo.621.1"> option, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.622.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer056">
<span class="koboSpan" id="kobo.623.1"><img alt="Figure 4.26 – A newly configured catalog on Kubeapps" src="image/B18145_04_26.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.624.1">Figure 4.26 – A newly configured catalog on Kubeapps</span></p>
<p><span class="koboSpan" id="kobo.625.1">With this, our Kubeapps deployment is fully integrated with our custom application catalog that we created on VAC. </span><span class="koboSpan" id="kobo.625.2">Let’s now learn to deploy a MySQL service instance from our custom catalog </span><span class="No-Break"><span class="koboSpan" id="kobo.626.1">using Kubeapps.</span></span></p>
<h3><span class="koboSpan" id="kobo.627.1">Deploying a service using Kubeapps</span></h3>
<p><span class="koboSpan" id="kobo.628.1">In this part, we will deploy a MySQL database instance on our Kubernetes cluster using Kubeapps. </span><span class="koboSpan" id="kobo.628.2">The following steps describes how to </span><span class="No-Break"><span class="koboSpan" id="kobo.629.1">do it:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.630.1">Click on the </span><strong class="bold"><span class="koboSpan" id="kobo.631.1">MySQL</span></strong><span class="koboSpan" id="kobo.632.1"> tile that is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.633.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.634.1">.26</span></em><span class="koboSpan" id="kobo.635.1"> to get started with the installation on your Kubernetes cluster. </span><span class="koboSpan" id="kobo.635.2">We will see the following screen after </span><span class="No-Break"><span class="koboSpan" id="kobo.636.1">clicking there:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer057">
<span class="koboSpan" id="kobo.637.1"><img alt="Figure 4.27 – Deployment instruction page for MySQL on Kubeapps" src="image/B18145_04_27.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.638.1">Figure 4.27 – Deployment instruction page for MySQL on Kubeapps</span></p>
<p><span class="koboSpan" id="kobo.639.1">This page shows detailed instructions on how to use a MySQL Helm chart. </span><span class="koboSpan" id="kobo.639.2">We can use these instructions to manually deploy it using the Helm chart command-line tool. </span><span class="koboSpan" id="kobo.639.3">However, we will see how we can use the Kubeapps GUI for such configuration and installation. </span><span class="koboSpan" id="kobo.639.4">You can scroll down the page to see the details of all the configuration parameters that this Helm chart allows us to change to customize our MySQL database instance. </span><span class="koboSpan" id="kobo.639.5">By clicking the highlighted </span><strong class="bold"><span class="koboSpan" id="kobo.640.1">DEPLOY </span></strong><span class="koboSpan" id="kobo.641.1">button in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.642.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.643.1">.27</span></em><span class="koboSpan" id="kobo.644.1">, we get a screen to update these attributes for our custom needs and to trigger </span><span class="No-Break"><span class="koboSpan" id="kobo.645.1">the installation.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.646.1">Depending on the type of Helm chart, we may get a form like a GUI to modify some of the most common attributes for the deployment. </span><span class="koboSpan" id="kobo.646.2">For example, the following form in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.647.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.648.1">.28</span></em><span class="koboSpan" id="kobo.649.1"> for MySQL DB instance configuration shows that we can select deployment architecture and the size of the primary and secondary database storage volumes. </span><span class="koboSpan" id="kobo.649.2">But we will use a detailed YAML-based configuration approach to demonstrate that as well. </span><span class="koboSpan" id="kobo.649.3">So, click on the highlighted </span><strong class="bold"><span class="koboSpan" id="kobo.650.1">YAML</span></strong><span class="koboSpan" id="kobo.651.1"> tab in the following screenshot to </span><span class="No-Break"><span class="koboSpan" id="kobo.652.1">move forward:</span></span></li>
</ol>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer058">
<span class="koboSpan" id="kobo.653.1"><img alt="Figure 4.28 – Helm configuration form for MySQL DB on Kubeapps" src="image/B18145_04_28.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.654.1">Figure 4.28 – Helm configuration form for MySQL DB on Kubeapps</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.655.1">Select the destination Kubernetes namespace, update the </span><strong class="bold"><span class="koboSpan" id="kobo.656.1">YAML</span></strong><span class="koboSpan" id="kobo.657.1"> configuration, and deploy </span><span class="No-Break"><span class="koboSpan" id="kobo.658.1">the service:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer059">
<span class="koboSpan" id="kobo.659.1"><img alt="Figure 4.29 – Detailed Helm chart configuration for MySQL DB deployment using Kubeapps" src="image/B18145_04_29.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.660.1">Figure 4.29 – Detailed Helm chart configuration for MySQL DB deployment using Kubeapps</span></p>
<ul>
<li><span class="koboSpan" id="kobo.661.1">Section 1 in </span><em class="italic"><span class="koboSpan" id="kobo.662.1">Figure 4.29</span></em><span class="koboSpan" id="kobo.663.1"> shows where we can select the destination for this installation. </span><span class="koboSpan" id="kobo.663.2">As discussed before, we may use Kubeapps to deploy Helm charts in many other connected Kubernetes clusters and their namespaces depending on the Kubeapps configurations and the privileges of the Kubeapps user on those clusters and namespaces. </span><span class="koboSpan" id="kobo.663.3">In this case, we have only one option – </span><strong class="bold"><span class="koboSpan" id="kobo.664.1">default</span></strong><span class="koboSpan" id="kobo.665.1"> – that corresponds to the Kubernetes cluster where Kubeapps is deployed. </span><span class="koboSpan" id="kobo.665.2">Similarly, we may also select or create a namespace for this deployment </span><span class="No-Break"><span class="koboSpan" id="kobo.666.1">if required.</span></span></li>
<li><span class="koboSpan" id="kobo.667.1">Section 2 in </span><em class="italic"><span class="koboSpan" id="kobo.668.1">Figure 4.29</span></em><span class="koboSpan" id="kobo.669.1"> shows the YAML configuration for the Helm chart, where we may customize our deployment configuration. </span><span class="koboSpan" id="kobo.669.2">The deployment used in this book has only changed for user credentials, keeping all other attributes to their default values to keep it simple. </span><span class="koboSpan" id="kobo.669.3">Once the required configuration changes are done, we can verify them using the </span><strong class="bold"><span class="koboSpan" id="kobo.670.1">Changes </span></strong><span class="koboSpan" id="kobo.671.1">tab to ensure there are only intended changes in the </span><span class="No-Break"><span class="koboSpan" id="kobo.672.1">deployment configuration.</span></span></li>
<li><span class="koboSpan" id="kobo.673.1">Once the required changes are made, section 3 in </span><em class="italic"><span class="koboSpan" id="kobo.674.1">Figure 4.29</span></em><span class="koboSpan" id="kobo.675.1"> shows the button to trigger the deployment on our </span><span class="No-Break"><span class="koboSpan" id="kobo.676.1">Kubernetes cluster.</span></span></li>
</ul>
<ol>
<li value="4"><span class="koboSpan" id="kobo.677.1">We will get the following page after triggering the Helm chart deployment to update the status of </span><span class="No-Break"><span class="koboSpan" id="kobo.678.1">the installation:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer060">
<span class="koboSpan" id="kobo.679.1"><img alt="Figure 4.30 – MySQL DB deployment status on Kubeapps" src="image/B18145_04_30.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.680.1">Figure 4.30 – MySQL DB deployment status on Kubeapps</span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.681.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.682.1">.30</span></em><span class="koboSpan" id="kobo.683.1"> contains the </span><span class="No-Break"><span class="koboSpan" id="kobo.684.1">following details:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.685.1">Section 1 shows the different buttons to perform the life cycle operations for the deployment, including upgrading it to a newer version of MySQL, rolling back to a previous version, or deleting the deployment if not required. </span><span class="koboSpan" id="kobo.685.2">The button triggers their corresponding Kubernetes Deployment life cycle operations behind </span><span class="No-Break"><span class="koboSpan" id="kobo.686.1">the scenes.</span></span></li>
<li><span class="koboSpan" id="kobo.687.1">Section 2 shows the number of healthy running pods for </span><span class="No-Break"><span class="koboSpan" id="kobo.688.1">our deployment.</span></span></li>
<li><span class="koboSpan" id="kobo.689.1">Section 3 shows the authentication credentials that were provided during the installation configuration step covered previously, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.690.1">Figure 4.29</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.691.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.692.1">Section 4 shows different useful tips and details for using the deployed tool. </span><span class="koboSpan" id="kobo.692.2">For example, in our case, it shows how to connect to the MySQL DB instance </span><span class="No-Break"><span class="koboSpan" id="kobo.693.1">deployed here.</span></span></li>
<li><span class="koboSpan" id="kobo.694.1">Section 5 shows the different Kubernetes resources that were deployed as part of this installation. </span><span class="koboSpan" id="kobo.694.2">We can view details of the resources by clicking on their </span><span class="No-Break"><span class="koboSpan" id="kobo.695.1">corresponding tabs.</span></span></li>
<li><span class="koboSpan" id="kobo.696.1">Section 6 shows the final installation configuration that was used to deploy this instance of MySQL DB. </span><span class="koboSpan" id="kobo.696.2">We can save the YAML configuration in a file for future usage to deploy the same type of MySQL </span><span class="No-Break"><span class="koboSpan" id="kobo.697.1">instance again.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.698.1">With this, we have covered the required details to see how we can use Kubeapps to consume a custom application catalog created using VAC to quickly deploy several OSS tools in minutes and in a self-service way. </span><span class="koboSpan" id="kobo.698.2">Such a setup given to developers to deploy required application backend services can boost their productivity, reduce overall application development time, and as a result, improve an enterprise’s innovation speed. </span><span class="koboSpan" id="kobo.698.3">And using Kubeapps and VAC is not just for developers but also for DevOps, platform, and infrastructure engineers to deploy and use many popular OSS tools using container images and Helm charts delivered from a </span><span class="No-Break"><span class="koboSpan" id="kobo.699.1">trusted source.</span></span></p>
<p><span class="koboSpan" id="kobo.700.1">Let’s now visit one more day-two activity around VAC that the catalog administrators will need to perform – updating the catalog on the </span><span class="No-Break"><span class="koboSpan" id="kobo.701.1">VAC portal.</span></span></p>
<h2 id="_idParaDest-91"><a id="_idTextAnchor091"/><span class="koboSpan" id="kobo.702.1">Updating the application catalog</span></h2>
<p><span class="koboSpan" id="kobo.703.1">Earlier in the chapter, we saw, as a part of day-two activities, how to obtain different reports and logs for the supplied artifacts from the VAC portal. </span><span class="koboSpan" id="kobo.703.2">Then we covered how to consume a catalog of OSS tools that were supplied by VAC using either an automation pipeline or Kubeapps. </span><span class="koboSpan" id="kobo.703.3">Now let’s visit the last major day-two activity around VAC, which is to update the </span><span class="No-Break"><span class="koboSpan" id="kobo.704.1">catalog items.</span></span></p>
<h3><span class="koboSpan" id="kobo.705.1">Adding new catalog items</span></h3>
<p><span class="koboSpan" id="kobo.706.1">To add new OSS applications to the corporate catalog, catalog administrators can go to their corporate VAC account using VMware Cloud Services credentials. </span><span class="koboSpan" id="kobo.706.2">Once on the VAC portal, the catalog administrators can select the </span><strong class="bold"><span class="koboSpan" id="kobo.707.1">ADD NEW APPLICATIONS</span></strong><span class="koboSpan" id="kobo.708.1"> button under the </span><strong class="bold"><span class="koboSpan" id="kobo.709.1">Applications</span></strong><span class="koboSpan" id="kobo.710.1"> section, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.711.1">Figure 4</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.712.1">.31</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.713.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer061">
<span class="koboSpan" id="kobo.714.1"><img alt="Figure 4.31 – Add a new item in the catalog on the VAC portal" src="image/B18145_04_31.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.715.1">Figure 4.31 – Add a new item in the catalog on the VAC portal</span></p>
<p><span class="koboSpan" id="kobo.716.1">The steps to add new catalog items after clicking the highlighted button in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.717.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.718.1">.31</span></em><span class="koboSpan" id="kobo.719.1"> are the same as we covered during the creation of the new catalog earlier in </span><span class="No-Break"><span class="koboSpan" id="kobo.720.1">this chapter:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer062">
<span class="koboSpan" id="kobo.721.1"><img alt="Figure 4.32 – Request status tracking on the VAC portal" src="image/B18145_04_32.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.722.1">Figure 4.32 – Request status tracking on the VAC portal</span></p>
<p><span class="koboSpan" id="kobo.723.1">Newly added items will appear under </span><strong class="bold"><span class="koboSpan" id="kobo.724.1">My Requests</span></strong><span class="koboSpan" id="kobo.725.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.726.1">Figure 4</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.727.1">.32</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.728.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.729.1">Making additional catalog changes</span></h3>
<p><span class="koboSpan" id="kobo.730.1">Other than adding new items in the catalog, we may also need to remove unwanted tools from it, update the base OS layer, update destination repository details, and include/exclude Helm charts from the listed items. </span><span class="koboSpan" id="kobo.730.2">At the time of writing this book, all these operations can only be performed by contacting VAC support as the VAC portal does not currently provide an interface to do it in a </span><span class="No-Break"><span class="koboSpan" id="kobo.731.1">self-service manner.</span></span></p>
<p><span class="koboSpan" id="kobo.732.1">With this, we have covered most of the day-two activities around VAC. </span><span class="koboSpan" id="kobo.732.2">Let’s recap to summarize our learning from </span><span class="No-Break"><span class="koboSpan" id="kobo.733.1">this chapter.</span></span></p>
<h1 id="_idParaDest-92"><a id="_idTextAnchor092"/><span class="koboSpan" id="kobo.734.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.735.1">In this chapter, we saw that the popularity of using OSS tools has dramatically increased in recent years. </span><span class="koboSpan" id="kobo.735.2">There are several mature OSS tools available today that many organizations confidently use in their production environments. </span><span class="koboSpan" id="kobo.735.3">Also, running software such as containers on Kubernetes alongside containerized client applications is a quick way to equip the applications with appropriate backend technologies. </span><span class="koboSpan" id="kobo.735.4">But using container images available on public container registries such as Docker Hub is not a secure way of deploying such OSS tools. </span><span class="koboSpan" id="kobo.735.5">And hence, most organizations do not encourage such practices and try to employ some internal mechanisms to generate internally curated container images for such OSS consumption. </span><span class="koboSpan" id="kobo.735.6">Having such efforts undertaken internally not only wastes a lot of resources but also discourages developer teams from experimenting with various tools or wasting their productivity in waiting for getting them ready for consumption. </span><span class="koboSpan" id="kobo.735.7">And that is where VAC comes into the picture. </span><span class="koboSpan" id="kobo.735.8">We saw how VAC can handle such challenges by providing a way to curate a custom catalog of required OSS tools that can be consumed internally with </span><span class="No-Break"><span class="koboSpan" id="kobo.736.1">full confidence.</span></span></p>
<p><span class="koboSpan" id="kobo.737.1">We also learned how VAC works and what its key components are. </span><span class="koboSpan" id="kobo.737.2">Following this, we learned how we can get started with VAC to define a catalog and set up Kubeapps to consume the Helm charts and container images delivered under that custom catalog. </span><span class="koboSpan" id="kobo.737.3">And finally, we went through some of the key day-two activities around catalog consumption and management. </span><span class="koboSpan" id="kobo.737.4">We saw how quickly we can deploy an instance of MySQL database using its Helm chart supplied as a part of the catalog. </span><span class="koboSpan" id="kobo.737.5">We also reviewed how catalog administrators can check out and obtain copies of the CVE scanning report, anti-virus scan logs, test logs, and asset specification (bill of material) for all the container images and Helm charts delivered through the </span><span class="No-Break"><span class="koboSpan" id="kobo.738.1">VAC service.</span></span></p>
<p><span class="koboSpan" id="kobo.739.1">After seeing how to build our apps quickly with the vast choice of OSS tools to be used as backends for our apps, in the next chapter, we will learn how to build and manage the API endpoints exposed by our applications using the Tanzu </span><span class="No-Break"><span class="koboSpan" id="kobo.740.1">application tools.</span></span></p>
</div>
<div>
<div class="IMG---Figure" id="_idContainer064">
</div>
</div>
</body></html>
# 序言

边缘计算是指在数据源附近处理数据。为了构建一个边缘计算系统，您需要了解边缘系统用于处理信息的不同层次和组件。通过使用 K3s —— 一个轻量级的 Kubernetes，您可以利用容器的优势来设计分布式系统，并自动化应用程序的更新方式。本书将为您提供创建自己的边缘系统所需的所有工具，涵盖边缘计算的基础知识及不同应用场景。通过阅读本书，您将了解如何实施自己的边缘计算系统，使用 K3s 容器化技术构建 Kubernetes 集群并利用云原生开源软件。

# 本书适合人群

本书适合那些希望将数据处理任务迁移到边缘的运维或 DevOps 工程师，或者那些希望实现边缘计算系统但没有技术背景的工程师。本书也适合那些希望实施或实验边缘计算以应对不同或潜在使用场景的爱好者和创业者。

# 本书内容概览

*第一章*，*使用 Kubernetes 进行边缘计算*，解释了边缘计算的基本概念，包括其组件、层次、构建这些系统的示例架构，并展示了如何使用交叉编译技术为 Go、Rust、Python 和 Java 等编程语言编写代码，以便在运行 ARM 处理器的设备上运行边缘设备上的软件。

*第二章*，*K3s 安装与配置*，描述了什么是 K3s，它的组件以及如何使用不同的配置（如单节点和多节点）安装 K3s，最后解释了 K3s 集群的高级配置，如何使用外部存储代替 etcd，如何通过安装和使用 Ingress 控制器将应用程序暴露到集群外部，如何卸载集群以及一些有用的命令来排除集群安装问题。

*第三章*，*K3s 高级配置与管理*，介绍了 K3s 集群的高级配置，包括安装 MetalLB 这一裸金属负载均衡器，安装 Longhorn 作为边缘存储，集群升级以及最终备份和恢复 K3s 集群配置。

*第四章*，*k3OS 安装与配置*，重点讲解了如何使用 k3OS —— 一种打包为 ISO 镜像的 Kubernetes 发行版，可以用于在边缘设备上安装。还介绍了如何在 ARM 设备上使用覆盖功能，并通过配置文件执行安装，配置单节点或多节点 K3s 集群。

*第五章*，*K3s 边缘计算实验的家庭实验室*，介绍了如何使用前几章描述的所有配置来配置自己的家庭实验室，从而生成一个基本的生产环境，用于运行边缘计算应用程序。首先是集群配置，包括入口控制器配置、应用程序持久化配置以及如何在边缘部署 Kubernetes 仪表盘。

*第六章*，*使用 Ingress 控制器和证书暴露应用程序*，介绍了如何配置和使用 NGINX、Traefik 和 Contour 等 Ingress 控制器，结合 cert-manager 使用 TLS 证书在裸金属上暴露运行的应用程序。

*第七章*，*使用 Flux 进行边缘应用程序的 GitOps*，探讨了如何使用 GitOps 策略与 Flux 和 GitHub Actions 一起自动化更新边缘应用程序，当源代码更改时进行检测。

*第八章*，*使用 Linkerd 进行可观察性和流量分割*，描述了如何使用服务网格实现简单的监控、可观察性、流量分割和故障流量，以提高使用 Linkerd 在边缘运行的服务的可用性。

*第九章*，*使用 Knative 和 Cloud Events 的边缘无服务器和事件驱动架构*，介绍了如何使用 Knative Serving 实现自己的无服务器功能。还展示了如何结合 Knative Eventing 和 Cloud Event 实现简单的事件驱动架构，在边缘系统中定义和运行事件。

*第十章*，*边缘的 SQL 和 NoSQL 数据库*，探讨了可以用于记录边缘数据的不同类型的数据库。本章具体介绍了 MySQL、Redis、MongoDB、PostgreSQL 和 Neo4j 的配置和使用，涵盖了在边缘运行 SQL 和 NoSQL 数据库的不同用例。

*第十一章*，*使用 Prometheus 和 Grafana 监控边缘*，重点介绍了如何使用时间序列数据库 Prometheus 和 Grafana 来监控边缘环境和设备。具体来说，本章侧重于创建自定义实时图表，以展示来自捕捉温湿度数据的边缘传感器的数据。

*第十二章*，*使用 LoRa 进行长距离的边缘设备通信*，描述了如何使用 LoRa 无线协议进行远距离的边缘设备通信，以及如何使用 MySQL 和 Grafana 可视化捕获的传感器边缘数据。

*第十三章*，*使用 GPS、NoSQL 和 K3s 集群的地理定位应用*，描述了如何使用 GPS 模块和 ARM 设备实现一个简单的地理定位或地理追踪系统，实时显示车辆的移动情况，并报告其在指定日期范围内的追踪日志。

*第十四章*，*使用 Python 和 K3s 集群进行计算机视觉*，描述了如何创建一个智能交通系统，在城市驾驶时检测潜在的障碍物，并在高峰时段提供智能警报和实时交通状态报告。书中还一步步介绍了如何使用 Redis、OpenCV、TensorFlow Lite、Scikit Learn 和 GPS 模块在边缘计算设备上实现这一系统。

*第十五章*，*设计你自己的边缘计算系统*，描述了创建自己边缘计算系统的基本方法，以及如何使用云服务提供商的托管服务、辅助硬件和软件，并在实施系统时提供一些有用的建议。最后还讨论了边缘计算的其他使用案例。

# 如何充分利用本书

为了更好地阅读本书，你需要具备一定的 Linux 命令行经验和一些基本的编程知识。在阅读每一章时，务必注意下载源代码，这将简化你对书中所有示例的使用。

本书主要使用 MacOS 进行本地配置。对于 Raspberry Pi 实现，则使用 Linux。最后，有一章使用 Windows 更新 ESP32 固件。

本书中运行示例所需的所有要求都在每章的“技术要求”部分中详细描述。

**如果你使用的是本书的数字版本，我们建议你自己输入代码，或者从本书的 GitHub 仓库中访问代码（链接在下一节中提供）。这样做可以帮助你避免与代码复制和粘贴相关的潜在错误。**

# 下载示例代码文件

你可以从 GitHub 下载本书的示例代码文件，链接是 [`github.com/PacktPublishing/Edge-Computing-Systems-with-Kubernetes`](https://github.com/PacktPublishing/Edge-Computing-Systems-with-Kubernetes)。如果代码有更新，它会在 GitHub 仓库中同步更新。

我们还提供了其他来自我们丰富书籍和视频目录中的代码包，您可以在 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/) 查阅。快去看看吧！

# 下载彩色图片

我们还提供了一份 PDF 文件，包含本书中使用的截图和图表的彩色图像。你可以在这里下载：[`packt.link/gZ68B`](https://packt.link/gZ68B)。

# 使用的约定

本书中使用了多种文本约定。

`文本中的代码`：表示文本中的代码词汇、函数、服务名称、部署名称、变量、路径名和 URL。例如：“`WIFISetUp(void)`：我们配置 Wi-Fi 连接，在此处您需要将 `NET_NAME` 替换为您的网络名称，将 `PASSWORD` 替换为连接密码。”

代码块设置如下：

```
@app.route('/')
def hello_world():
    return 'It works'
```

任何命令行输入或输出格式如下所示：

```
$ mkdir code
$ kubectl apply -f example.yaml
```

**粗体**：表示新术语、重要词汇或屏幕上显示的单词。例如，菜单或对话框中的单词通常以**粗体**显示。以下是一个例子：“现在通过点击**文件** | **新建**来创建另一个文件”

提示或重要说明

如此显示。

# 联系我们

我们非常欢迎读者的反馈。

**一般反馈**：如果您对本书的任何内容有疑问，请通过电子邮件联系 customercare@packtpub.com，并在邮件主题中注明书名。

**勘误表**：虽然我们已尽力确保内容的准确性，但难免会有错误。如果您在本书中发现错误，欢迎向我们报告。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上发现我们的作品有任何非法复制品，我们将感激您提供该位置地址或网站名称。请通过版权邮箱与我们联系，并附上该材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域具有专业知识，并且有兴趣撰写或为书籍做贡献，请访问 [authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

阅读完 *《边缘计算系统与 Kubernetes》* 后，我们很想听听您的想法！请点击[这里直接访问该书的 Amazon 评价页面](https://packt.link/r/1-800-56859-2)并分享您的反馈。

您的评价对我们和技术社区非常重要，将帮助我们确保提供优质的内容。

序言

序言

序言

# 第一部分：边缘计算基础

在本书的这一部分，您将学习边缘计算系统的基本概念、架构、用例以及当前的解决方案，还将学习如何使用 k3s/k3OS 和 Raspberry Pi 设备安装集群。

本书的这一部分包括以下章节：

+   *第一章*，*使用 Kubernetes 进行边缘计算*

+   *第二章*，*K3s 安装与配置*

+   *第三章*，*K3s 高级配置与管理*

+   *第四章*，*k3OS 安装与配置*

+   *第五章*，*K3s 边缘计算实验室*

- en: '15'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '15'
- en: Kubernetes Clusters on Google Kubernetes Engine
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google Kubernetes Engine上的Kubernetes集群
- en: In this chapter, we will launch a Kubernetes cluster on **Google Cloud Platform**
    (**GCP**), the first of the three public cloud providers we will cover over the
    next few chapters.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将在**Google Cloud Platform**（**GCP**）上启动一个Kubernetes集群，这是我们在接下来几章中要介绍的三大公有云提供商中的第一个。
- en: By the end of this chapter, you will have signed up for the Google Cloud Platform,
    launched a Kubernetes workload using **Google Kubernetes Engine** (**GKE**), and
    gained an understanding of GKE’s features.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，你将注册Google Cloud Platform，使用**Google Kubernetes Engine**（**GKE**）启动Kubernetes工作负载，并了解GKE的功能。
- en: 'We will be covering the following topics in this chapter:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: What are Google Cloud Platform and Google Kubernetes Engine?
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 什么是Google Cloud Platform和Google Kubernetes Engine？
- en: Preparing your local environment
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 准备你的本地环境
- en: Launching your first Google Kubernetes Engine cluster
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动你的第一个Google Kubernetes Engine集群
- en: Deploying a workload and interacting with your cluster
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署工作负载并与集群交互
- en: More about cluster nodes
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更多关于集群节点的信息
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: To follow along with this chapter, you will need a Google Cloud Platform account
    with a valid payment method attached.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 要跟随本章内容，你需要一个带有有效支付方式的Google Cloud Platform帐户。
- en: Following the instructions in this chapter will incur a financial cost. It is,
    therefore, important that you terminate any resources you launch once you have
    finished using them. All prices quoted in this chapter are correct at the time
    of writing, and we recommend that you review the current costs before you launch
    any resources.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 按照本章中的说明操作将会产生财务费用。因此，在完成使用后，务必终止你启动的任何资源。本章中列出的所有价格在写作时是准确的，我们建议你在启动任何资源之前查看当前的费用。
- en: What are Google Cloud Platform and Google Kubernetes Engine?
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是Google Cloud Platform和Google Kubernetes Engine？
- en: Before we roll up our sleeves and look at signing up for a Google Cloud Platform
    account and installing the tools, we will need to launch our GKE-powered cluster.
    We should also discuss Google Kubernetes Engine and how it came to be.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们动手注册Google Cloud Platform帐户并安装工具之前，我们需要启动一个由GKE支持的集群。我们还应该讨论一下Google Kubernetes
    Engine以及它是如何诞生的。
- en: Henceforth, I will refer to Google Cloud Platform as GCP and Google Kubernetes
    Engine as GKE in the body text of the chapter.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 从此，我将在本章正文中将Google Cloud Platform称为GCP，将Google Kubernetes Engine称为GKE。
- en: Google Cloud Platform
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Google Cloud Platform
- en: Of the “**big three**” public cloud providers, GCP is the newest. In the following
    two chapters, we will examine **Amazon Web Services** (**AWS**) and **Microsoft
    Azure**.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在“**三大**”公有云提供商中，GCP是最新的。在接下来的两章中，我们将探讨**Amazon Web Services**（**AWS**）和**Microsoft
    Azure**。
- en: Google’s foray into public cloud technology started differently from the other
    two providers. In April 2008, Google launched the public preview of its Google
    App Engine, which was the first component of its cloud offering. As a service,
    App Engine is still available at the time of writing, in mid-2024\. The service
    allows developers to deploy their applications in Google-managed runtimes, including
    PHP, Java, Ruby, Python, Node.js, and C#, along with Google’s programming language,
    Go, which was open sourced in 2009.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: Google进入公有云技术的方式与另外两家提供商不同。2008年4月，Google推出了其Google App Engine的公有预览版，这是其云服务的第一个组成部分。作为一项服务，App
    Engine至今仍然可用，截止写作时（2024年中期）。该服务允许开发者将应用程序部署在Google管理的运行时环境中，包括PHP、Java、Ruby、Python、Node.js和C#，以及Google自家编程语言Go，后者于2009年开源。
- en: 'The following service under the GCP banner arrived in May 2010: **Google Cloud
    Storage**, followed by **Google BigQuery** and a preview version of its Prediction
    API. A year later, in October 2011, **Google Cloud SQL** was launched. Then, in
    June 2012, the **Google Compute Engine** preview was launched.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 2010年5月，**Google Cloud Storage**在GCP品牌下推出，紧接着是**Google BigQuery**和其预测API的预览版。2011年10月，**Google
    Cloud SQL**上线。然后，在2012年6月，**Google Compute Engine**的预览版也上线了。
- en: As you can see, four years had passed, and we then had what most would consider
    the core services that go into making a public cloud service.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你所看到的，四年过去了，到了那时我们已经有了大多数人认为构成公有云服务的核心服务。
- en: However, most of the services were still in preview; it wouldn’t be until 2013
    that many of these core services would move out of preview and become **generally
    available** (**GA**). This meant that it was possible to safely run production
    workloads at scale and, more importantly, with a **Service-Level Agreement** (**SLA**),
    which is critical for both **small and medium-sized enterprises** (**SMEs**) and
    large enterprise companies in adopting the service. All of this was just a year
    before Google would launch Kubernetes.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，大多数服务仍处于预览阶段；直到 2013 年，许多核心服务才会脱离预览并变为 **正式发布**（**GA**）。这意味着可以安全地在大规模生产工作负载中运行，且更为重要的是，提供了
    **服务级别协议**（**SLA**），这对于 **中小型企业**（**SMEs**）和大型企业采用该服务至关重要。所有这些都发生在 Google 启动 Kubernetes
    的前一年。
- en: Toward the end of 2014, Google brought out the first alpha version of GKE.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 2014 年底，Google 发布了 GKE 的第一个 Alpha 版本。
- en: Google Kubernetes Engine
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Google Kubernetes Engine
- en: Given that Kubernetes was developed at Google and Google had vast experience
    running container workloads at scale with the Borg project, it came as no surprise
    that Google was one of the first public cloud providers to offer its own Kubernetes
    offering in GKE.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于 Kubernetes 是在 Google 开发的，且 Google 在通过 Borg 项目大规模运行容器工作负载方面拥有丰富经验，因此 Google
    成为第一个在 GKE 中提供自家 Kubernetes 服务的公共云提供商也就不足为奇了。
- en: After Kubernetes v1 came out and was then handed over to the **Cloud Native
    Computing Foundation** (**CNCF**) to maintain in July 2015, it was only a month
    later that the GKE service became GA.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Kubernetes v1 发布并于 2015 年 7 月移交给 **云原生计算基金会**（**CNCF**）维护后，仅仅一个月，GKE 服务就已成为
    GA。
- en: The GKE service lets you launch and manage a CNCF-certified Kubernetes cluster,
    powered by GCP’s native compute, storage, and network services. It also allows
    deep integration with the platform’s monitoring, identity, and access management
    functionality.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: GKE 服务允许你启动并管理一个 CNCF 认证的 Kubernetes 集群，利用 GCP 的本地计算、存储和网络服务。此外，它还允许与平台的监控、身份和访问管理功能进行深度集成。
- en: We will look at the differences between the various Cloud-based Kubernetes offerings,
    and why you should use them, at the end of *Chapter 17*.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在 *第 17 章* 的结尾讨论不同云端 Kubernetes 服务的差异，以及你为什么应该使用它们。
- en: Now that we know a little bit of the history behind the service, we can sign
    up and install some of the management tools we will use to launch our cluster.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经了解了该服务的一些历史背景，我们可以注册并安装一些用于启动集群的管理工具。
- en: Preparing your local environment
  id: totrans-29
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备本地环境
- en: The first thing we need to do is get you access to GCP. To do this, you must
    either sign up for an account or log in to your existing one. Let’s learn how.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要做的第一件事是让你能够访问 GCP。为此，你必须注册一个新账户或登录现有账户。让我们学习一下如何操作。
- en: 'To sign up for a GCP account, you will need to visit [https://cloud.google.com/](https://cloud.google.com/).
    Here, you should be greeted by a page that looks something like the following:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 要注册 GCP 账户，你需要访问 [https://cloud.google.com/](https://cloud.google.com/)。此页面会显示一个类似下面的界面：
- en: '![A screenshot of a web page'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '![网页截图'
- en: Description automatically generated](img/B22019_15_01.png)
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B22019_15_01.png)
- en: 'Figure 15.1: The Google Cloud home page'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.1：Google Cloud 首页
- en: If you already use a Google service such as Gmail or YouTube or have an Android
    phone, you will possess a Google account. You can use this account to enroll,
    as shown in *Figure 15.1*. I am already logged in to my own Google account, as
    indicated by the avatar on the top-right-hand side of the screenshot.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你已经在使用 Google 服务，如 Gmail、YouTube，或拥有一部安卓手机，那么你已经拥有了一个 Google 账户。你可以使用这个账户进行注册，具体操作见
    *图 15.1*。我已经登录到自己的 Google 账户，截图右上角的头像显示了这一点。
- en: 'At the time of writing, Google offers $300 of credits for you to use over 90
    days. You must still enter a valid payment method to take advantage of the free
    credits. Google does this to ensure that it is not an automated bot signing up
    for the account, abusing the credits they offer. Once the credits have been used
    or expired, you will be given the option to upgrade your account to a paid account.
    For more details on this offer, see the following link: [https://cloud.google.com/free/docs/free-cloud-features](https://cloud.google.com/free/docs/free-cloud-features).'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 截至本文撰写时，Google 提供 $300 的信用额度，可以在 90 天内使用。你仍然需要输入有效的付款方式来利用这些免费信用。Google 这样做是为了确保不是一个自动化机器人在注册账户并滥用他们提供的信用额度。一旦信用额度使用完毕或过期，你将获得将账户升级为付费账户的选项。有关此优惠的更多细节，请参见以下链接：[https://cloud.google.com/free/docs/free-cloud-features](https://cloud.google.com/free/docs/free-cloud-features)。
- en: 'If you want to take advantage of the free credits, follow this link: [https://cloud.google.com/free/docs/free-cloud-features#try-it-for-yourself](https://cloud.google.com/free/docs/free-cloud-features#try-it-for-yourself).
    Click on **Get started for free**; if you qualify for the offer, follow the onscreen
    prompts, ensuring that you read the terms and conditions. Once you have enrolled,
    you will be taken to the GCP console. Alternatively, if you already have a GCP
    account, you can log in to the GCP console directly at [https://console.cloud.google.com/](https://console.cloud.google.com/).'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想利用免费的信用额度，可以点击这个链接：[https://cloud.google.com/free/docs/free-cloud-features#try-it-for-yourself](https://cloud.google.com/free/docs/free-cloud-features#try-it-for-yourself)。点击
    **立即免费开始**；如果你符合条件，按照屏幕上的提示操作，确保你已阅读相关条款和条件。注册后，你将进入 GCP 控制台。或者，如果你已经有了 GCP 账户，你可以直接登录
    GCP 控制台：[https://console.cloud.google.com/](https://console.cloud.google.com/)。
- en: Now that we have an account, let’s learn how to create a project where we will
    launch our resources.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经有了账户，让我们学习如何创建一个项目，在其中启动我们的资源。
- en: Creating a project
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建项目
- en: GCP has a concept whereby resources are launched into projects. If you have
    just signed up for an account, then a “My First Project” project will have been
    created for you as part of the enrollment process.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: GCP 有一个概念，即资源被启动到项目中。如果你刚刚注册了一个账户，那么在注册过程中会为你创建一个“My First Project”项目。
- en: If you are using an existing account, I recommend creating a new project to
    launch your GKE cluster. To do this, click on the **Select** menu, which is located
    in the top bar just to the right of the GCP logo at the top left of the page.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用的是现有账户，我建议创建一个新的项目来启动你的 GKE 集群。为此，点击 **选择** 菜单，该菜单位于页面左上角 GCP 标志右侧的顶部栏中。
- en: 'This will display all the projects you can access and allow you to create a
    new project. To do so, follow these steps:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 这将显示你可以访问的所有项目，并允许你创建一个新项目。为此，请按以下步骤操作：
- en: Click on **NEW PROJECT**.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **新建项目**。
- en: 'You will be asked to do the following:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 系统会要求你完成以下操作：
- en: Give your new project a name.
  id: totrans-45
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 给你的新项目命名。
- en: Select an organization to attach the project to.
  id: totrans-46
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择一个组织来附加到项目上。
- en: Select the location; this is either an organization or a folder to store the
    project in.
  id: totrans-47
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择位置；这是一个存储项目的组织或文件夹。
- en: Once details from the previous step have been entered, click the **CREATE**
    button.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入上一步骤的详细信息后，点击 **创建** 按钮。
- en: '![A screenshot of a computer'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '![A screenshot of a computer'
- en: Description automatically generated](img/B22019_15_02.png)
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B22019_15_02.png)
- en: 'Figure 15.2: Creating a new project'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.2：创建新项目
- en: Now that we have a place to launch our resources, we can look at installing
    the GCP command-line tool.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经有了一个启动资源的地方，我们可以开始安装 GCP 命令行工具了。
- en: Installing the GCP command-line interface
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 GCP 命令行界面
- en: Here, we are going to cover the GCP **Command-Line Interface** (**CLI**) on
    your local machine. Don’t worry if you do not want to or are unable to install
    it, as there is a way to run the CLI in the cloud. But let’s start with my operating
    system of choice, macOS.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将介绍如何在本地计算机上使用 GCP **命令行界面** (**CLI**) 。如果你不想安装或无法安装，也不用担心，因为有一种方法可以在云端运行
    CLI。但让我们先从我选择的操作系统——macOS 开始。
- en: Installing on macOS
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在 macOS 上安装
- en: If you are like me and you do a lot of work on macOS using Terminal, there is
    a high likelihood that you have installed and used Homebrew at some point.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你像我一样，在 macOS 上使用终端进行大量工作，那么你很可能在某个时候安装并使用过 Homebrew。
- en: For the most up-to-date installation instructions for Homebrew, see the project’s
    website at [https://brew.sh/](https://brew.sh/).
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 有关 Homebrew 的最新安装说明，请参见项目网站 [https://brew.sh/](https://brew.sh/)。
- en: 'With Homebrew installed, you will be able to install the GCP CLI using the
    following command:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 安装了 Homebrew 后，您可以使用以下命令安装 GCP CLI：
- en: '[PRE0]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'You can test the installation by running the following command:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过运行以下命令来测试安装：
- en: '[PRE1]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'If everything goes as planned, you should see something like the following
    output:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一切顺利，您应该会看到类似以下的输出：
- en: '![A screen shot of a computer'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机截图'
- en: Description automatically generated](img/B22019_15_03.png)
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B22019_15_03.png)
- en: 'Figure 15.3: Checking the version number on macOS'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.3：在 macOS 上检查版本号
- en: 'If you are having problems, you can check the documentation linked above; for
    information on the GCP CLI installation, see:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您遇到问题，可以查看上面链接的文档；有关 GCP CLI 安装的信息，请参见：
- en: '[PRE2]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Once you have the GCP CLI installed and working, you can move on to the *Initialization*
    section of this chapter.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦安装并正常运行 GCP CLI，您可以继续本章的 *初始化* 部分。
- en: Installing on Windows
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在 Windows 上安装
- en: There are a few options for installing the GCP CLI on Windows. The first is
    to open a PowerShell session and run the following command to install it using
    Chocolatey.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Windows 上有几种安装 GCP CLI 的方式。第一种是打开一个 PowerShell 会话，并运行以下命令通过 Chocolatey 安装它。
- en: Like Homebrew on macOS, Chocolatey is a package manager that lets you easily
    and consistently install a wide variety of packages on Windows via PowerShell,
    using the same command syntax rather than having to worry about the numerous installation
    methods that exist on Windows – see [https://chocolatey.org/](https://chocolatey.org/)
    for more information.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 像 macOS 上的 Homebrew 一样，Chocolatey 是一个包管理器，允许您通过 PowerShell 在 Windows 上轻松且一致地安装各种软件包，使用相同的命令语法，而不必担心
    Windows 上存在的多种安装方法——更多信息请参见 [https://chocolatey.org/](https://chocolatey.org/)。
- en: 'If you don’t have Chocolatey installed, then you can run the following command
    in a PowerShell session that has been launched with administrative privileges:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您没有安装 Chocolatey，可以在以管理员权限启动的 PowerShell 会话中运行以下命令：
- en: '[PRE3]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Once Chocolatey is installed, or if you already have it installed, run the
    following:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦安装了 Chocolatey，或者如果您已经安装了它，运行以下命令：
- en: '[PRE4]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The other way to install it is to download the installer from the following
    URL:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种安装方式是从以下网址下载安装程序：
- en: '[https://dl.google.com/dl/cloudsdk/channels/rapid/GoogleCloudSDKInstaller.exe](https://dl.google.com/dl/cloudsdk/channels/rapid/GoogleCloudSDKInstaller.exe'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://dl.google.com/dl/cloudsdk/channels/rapid/GoogleCloudSDKInstaller.exe](https://dl.google.com/dl/cloudsdk/channels/rapid/GoogleCloudSDKInstaller.exe'
- en: )
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: )
- en: Once downloaded, run the executable by double-clicking on it and following the
    onscreen prompts.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 下载后，双击可执行文件并按照屏幕上的提示进行操作。
- en: 'Once installed, open a new PowerShell window and run the following command:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完成后，打开一个新的 PowerShell 窗口并运行以下命令：
- en: '[PRE5]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: If everything goes as planned, you should see something like the output shown
    in the screenshot from the macOS version in the previous section. Again, once
    installed and working, you can move on to the *Initialization* section of this
    chapter.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一切顺利，您应该会看到类似于前一节 macOS 版本中截图所示的输出。再次提醒，安装并成功运行后，您可以继续本章的 *初始化* 部分。
- en: Installing on Linux
  id: totrans-83
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在 Linux 上安装
- en: While the Google Cloud CLI packages are available for most distributions, we
    would need a lot more space to cover the various package managers here, so instead,
    we will use the global installation script provided by Google.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然 Google Cloud CLI 包对于大多数发行版都可以使用，但为了涵盖各种包管理器，我们需要更多的空间，因此，我们将使用 Google 提供的全局安装脚本。
- en: 'To run this, you need to use the following command:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 要运行此命令，您需要使用以下命令：
- en: '[PRE6]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The script will ask you several questions during the installation. For most
    people, answering `Yes` will be fine. Once the GCP CLI is installed, run the command
    below to reload your session so that it picks up all of the changes made by the
    installer:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在安装过程中，脚本会询问您几个问题。对于大多数人来说，回答 `Yes` 就可以了。安装完成后，运行以下命令以重新加载会话，从而使其更新所有安装程序所做的更改：
- en: '[PRE7]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'As per the macOS and Windows installations, which we have covered in the previous
    sections, you can run the following command to find out details on the GCP CLI
    version that has been installed:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们在前面章节中讨论的 macOS 和 Windows 安装方法，您可以运行以下命令来查看已安装的 GCP CLI 版本的详细信息：
- en: '[PRE8]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: You may have noticed from the three installations that, while the installation
    method differs, we use the same `gcloud` command once the package has been installed
    and get the same results. From here, it shouldn’t matter which operating system
    you are running, as the commands will apply to all three.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能已经注意到，尽管安装方法有所不同，但一旦安装完成并使用`gcloud`命令，我们会得到相同的结果。从这里开始，您运行的操作命令将适用于所有三种操作系统，因此您所运行的操作系统不再重要。
- en: Cloud Shell
  id: totrans-92
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 云Shell
- en: Before we started installing the Google Cloud CLI, I did mention that there
    was a fourth option. That option is Google Cloud Shell, built into the Google
    Cloud console. To access this, click on the **Shell** icon, which can be found
    on the right of the top menu.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始安装Google Cloud CLI之前，我提到过还有第四个选项。该选项是Google Cloud Shell，内置于Google Cloud控制台中。要访问此选项，请单击位于顶部菜单右侧的**Shell**图标。
- en: 'Once configured, you should see what looks to be a web-based terminal from
    which you can run the following:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完成后，您应该会看到一个基于Web的终端，您可以从中运行以下命令：
- en: '[PRE9]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The output differs slightly here, as Google has provided the full suite of
    supporting tools. However, you will notice from the following screen that the
    versions do match the ones we installed locally:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 输出略有不同，因为Google提供了完整的支持工具套件。但是，您将从以下屏幕看到，版本与我们在本地安装的版本匹配：
- en: '![A screenshot of a computer'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机截图'
- en: Description automatically generated](img/B22019_15_04.png)
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B22019_15_04.png)
- en: 'Figure 15.4: Using the GCP Cloud Shell'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.4：使用GCP Cloud Shell
- en: If you are using Google Cloud Shell, you can skip the initialization step below,
    as this has already been done for you.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用Google Cloud Shell，则可以跳过下面的初始化步骤，因为这已为您完成。
- en: Initialization
  id: totrans-101
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 初始化
- en: 'If you have chosen to install the client locally, you will need to take one
    final step to link it to your GCP account. To do this, run the following command:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您选择在本地安装客户端，您需要执行最后一步操作，将其链接到您的GCP账户。为此，请运行以下命令：
- en: '[PRE10]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'This will immediately run a quick network diagnostic to ensure that the client
    has the connectivity it needs to run. Once the diagnostic has passed, you will
    be prompted with the following question:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 这将立即运行一个快速的网络诊断，以确保客户端具备运行所需的连接性。一旦诊断通过，您将被提示回答以下问题：
- en: '[PRE11]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Answering `Y` will open a browser window. If it doesn’t, then copy and paste
    the provided URL into your browser where, once you have selected the account you
    wish to use, you will be presented with an overview of the permissions that the
    client requests, as seen in the following screen:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 回答`Y`将打开一个浏览器窗口。如果没有打开，请复制并粘贴提供的URL到您的浏览器中，在那里您将选择要使用的账户后，将看到客户端请求的权限概述，如下屏幕所示：
- en: '![A screenshot of a computer'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机截图'
- en: Description automatically generated](img/B22019_15_05.png)
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B22019_15_05.png)
- en: 'Figure 15.5: Reviewing the permissions'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.5：审核权限
- en: If you are happy to grant the permissions, click the **Allow** button. Back
    on your terminal, you will get confirmation of the user you are logged in as.
    Then, you will be asked to pick a cloud project to use. The list will only contain
    the unique ID of the project, not the friendly name that you saw or set up in
    Google Cloud Console earlier. If you have more than one project, please pick the
    correct one.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您同意授予权限，请点击**允许**按钮。返回到您的终端，您将收到登录用户的确认信息。然后，您将被要求选择要使用的云项目。列表中仅包含项目的唯一ID，而不是您之前在Google
    Cloud控制台中看到或设置的友好名称。如果您有多个项目，请选择正确的项目。
- en: 'Should you need to update the project that the client uses at any point, you
    can run the following command:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要随时更新客户端使用的项目，可以运行以下命令：
- en: '[PRE12]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Make sure you replace `PROJECT_ID` with the unique ID of the project you wish
    to switch to.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 确保您用项目的唯一ID替换`PROJECT_ID`。
- en: Now that you have installed the Google Cloud CLI and have configured your account,
    you are ready to launch your GKE cluster.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经安装了Google Cloud CLI并配置了您的账户，您可以准备启动您的GKE集群。
- en: Launching your first Google Kubernetes Engine cluster
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 启动您的第一个Google Kubernetes Engine集群
- en: As the cluster will take a few minutes to deploy fully, let’s run the command
    to initiate the process and then discuss in more detail what happens while it
    launches.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 由于集群需要几分钟才能完全部署，让我们运行命令来启动该过程，并详细讨论在启动过程中发生的情况。
- en: 'Before we launch our cluster, we must ensure that the `container.googleapis.com`
    service is enabled. To do this, run the following command:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在启动集群之前，我们必须确保启用了`container.googleapis.com`服务。为此，请运行以下命令：
- en: '[PRE13]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'We then need to install a plugin that will allow us to authenticate against
    the cluster using `kubectl`; to do this, run the following:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们需要安装一个插件，允许我们使用`kubectl`对集群进行身份验证；为此，请运行以下命令：
- en: '[PRE14]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Once the service and plugin have been enabled, the command to launch a two-node
    cluster called `myfirstgkecluster`, which will be hosted in a single zone in the
    Central US region, is as follows:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦启用了服务和插件，启动名为`myfirstgkecluster`的两节点集群的命令如下，该集群将托管在美国中部地区的单一区域：
- en: '[PRE15]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'After about five minutes, you should see something that looks like the following
    output:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 大约五分钟后，您应该看到如下所示的输出：
- en: '![A computer screen shot of a computer program'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机程序截图'
- en: Description automatically generated](img/B22019_15_06.png)
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B22019_15_06.png)
- en: 'Figure 15.6: Launching the cluster'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.6：启动集群
- en: 'Once the cluster has launched, you should be able to follow the URL in the
    output and view it in Google Cloud Console, as seen below:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦集群启动，您应该能够按照输出中的URL并在Google Cloud Console中查看，如下所示：
- en: '![A screenshot of a computer'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机截图'
- en: Description automatically generated](img/B22019_15_07.png)
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B22019_15_07.png)
- en: 'Figure 15.7: Viewing the cluster in Google Cloud Console'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.7：在Google Cloud Console中查看集群
- en: You can access the Google Cloud Console at [https://console.cloud.google.com/](https://console.cloud.google.com/).
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以访问Google Cloud Console，网址为[https://console.cloud.google.com/](https://console.cloud.google.com/)。
- en: Now that our cluster is up and running, we can deploy a workload and then examine
    Google Cloud Console in more detail.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们的集群已启动并运行，我们可以部署工作负载并更详细地查看Google Cloud Console。
- en: Deploying a workload and interacting with your cluster
  id: totrans-133
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 部署工作负载并与您的集群互动
- en: 'One of the things to note from the feedback when we launched our cluster by
    running:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 从启动集群时得到的反馈中需要注意的一点是：
- en: '[PRE16]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'was the following line in the output:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 输出中的以下行：
- en: '[PRE17]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: As you may have guessed, this has downloaded and configured all the necessary
    information to connect your local copy of `kubectl` to the newly deployed GKE
    cluster.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您可能猜到的，这已经下载并配置了所有必要的信息，将您的本地`kubectl`副本连接到新部署的GKE集群。
- en: 'You can confirm this by running the following command:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过运行以下命令来确认这一点：
- en: '[PRE18]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The output you get from the command should show two nodes with a prefix of
    `gke`, so it should appear something like the following Terminal output:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 您从命令中获得的输出应该显示两个以`gke`为前缀的节点，因此它应类似于以下终端输出：
- en: '![A screenshot of a computer'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机截图'
- en: Description automatically generated](img/B22019_15_08.png)
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B22019_15_08.png)
- en: 'Figure 15.8: Using kubectl to list the nodes'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.8：使用kubectl列出节点
- en: If your GKE cluster nodes are listed when running the preceding output and you
    are happy to proceed with the current `kubectl` configuration you are using, you
    can skip the next section of the chapter and move straight on to the *Launching
    an example workload* section.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在运行上述输出时您的GKE集群节点已列出，并且您满意当前使用的`kubectl`配置，可以跳过本章的下一节，直接进入*启动示例工作负载*部分。
- en: The *Further reading* section at the end of this chapter also provides a link
    to the official GKE documentation.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 本章末尾的*进一步阅读*部分还提供了指向官方GKE文档的链接。
- en: Configuring your local client
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置您的本地客户端
- en: If you need to configure another or your `kubectl` installation to connect to
    your cluster, the GCP CLI has a command.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要配置另一个或您的`kubectl`安装以连接到您的集群，GCP CLI提供了一个命令。
- en: Running the following command is based on the assumption that you have the GCP
    CLI installed and configured. If you don’t, please follow the instructions in
    the *Installing the GCP command-line interface* section of this chapter.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 运行以下命令的前提是您已安装并配置了GCP CLI。如果没有，请按照本章*安装GCP命令行界面*部分中的说明进行操作。
- en: 'The command you need to run to download the credentials and configure `kubectl`
    is as follows:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要运行的命令以下载凭据并配置`kubectl`如下：
- en: '[PRE19]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'You can run the following commands if you need to switch to or from another
    configuration (or context as it is known). The first command lists the current
    context:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要切换到另一个配置（或称为上下文），可以运行以下命令。第一个命令列出当前的上下文：
- en: '[PRE20]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The following command lists the names of all of the contexts that you have
    configured:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令列出了您已配置的所有上下文的名称：
- en: '[PRE21]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Once you know the name of the context that you need to use, you can run the
    following command, making sure to replace `CONTEXT_NAME` with the name of the
    context that you change it to, as in the following:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你知道需要使用的上下文名称，可以运行以下命令，确保将`CONTEXT_NAME`替换为你修改后的上下文名称，如下所示：
- en: '[PRE22]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Now that your `kubectl` client is configured to talk to and interact with your
    GKE cluster, we can launch an example workload.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你的 `kubectl` 客户端已配置为与 GKE 集群进行交互，我们可以启动示例工作负载。
- en: Launching an example workload
  id: totrans-159
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 启动示例工作负载
- en: 'The example workload we will launch is the PHP/Redis Guestbook example used
    throughout the official Kubernetes documentation. The first step in launching
    the workload is to create the Redis Leader deployment and service. To do this,
    we use the following commands:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将启动的示例工作负载是官方 Kubernetes 文档中使用的 PHP/Redis Guestbook 示例。启动工作负载的第一步是创建 Redis
    Leader 部署和服务。为此，我们使用以下命令：
- en: '[PRE23]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Next up, we need to repeat the process but, this time, to launch the Redis
    Follower deployment and service, as shown here:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们需要重复这个过程，但这次是启动 Redis Follower 部署和服务，如下所示：
- en: '[PRE24]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Now that we have Redis up and running, it is time to launch the frontend deployment
    and service; this is the application itself:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经启动了 Redis，接下来是启动前端部署和服务；这就是应用程序本身：
- en: '[PRE25]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'After a few minutes, you should be able to run the following command to get
    information on the service you have just launched:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 几分钟后，你应该能够运行以下命令，获取你刚刚启动的服务的信息：
- en: '[PRE26]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The output of the command should give you an external IP address that looks
    like the following Terminal output:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 命令的输出应该会给出一个外部 IP 地址，类似以下终端输出：
- en: '![A screenshot of a computer'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机截图'
- en: Description automatically generated](img/B22019_15_09.png)
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: Description automatically generated](img/B22019_15_09.png)
- en: 'Figure 15.9: Getting information on the frontend service'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.9：获取前端服务的信息
- en: Now that we have launched our application, copy the `EXTERNAL-IP` value and
    put the IP address into your browser; make sure you use `http://EXTERNAL-IP` rather
    than `https://EXTERNAL-IP`, as the Guestbook listens on port `80` and not `443`.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经启动了应用程序，复制 `EXTERNAL-IP` 值并将 IP 地址输入浏览器；确保使用 `http://EXTERNAL-IP` 而不是
    `https://EXTERNAL-IP`，因为 Guestbook 监听的是端口 `80` 而不是 `443`。
- en: 'You should be presented with the simple Guestbook application when you open
    the address in your browser. Try submitting a few messages, as shown in the following
    screen:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在浏览器中打开地址时，你应该看到简单的 Guestbook 应用程序。尝试提交一些消息，如下所示：
- en: '![A screenshot of a computer'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机截图'
- en: Description automatically generated](img/B22019_15_10.png)
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: Description automatically generated](img/B22019_15_10.png)
- en: 'Figure 15.10: The Guestbook application with a few test messages'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.10：带有一些测试消息的 Guestbook 应用程序
- en: Now that we have launched our basic workload, let’s return to and explore Google
    Cloud Console.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经启动了基本的工作负载，让我们回到并探索 Google Cloud Console。
- en: Exploring Google Cloud Console
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索 Google Cloud Console
- en: We have already seen our cluster in Google Cloud Console, so next, click on
    the **Workloads** link, which is in the left-hand menu of the **Kubernetes Engine**
    section.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经在 Google Cloud Console 中看到了集群，接下来点击左侧菜单中的**工作负载**链接，该链接位于**Kubernetes Engine**部分。
- en: '![A screenshot of a computer'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机截图'
- en: Description automatically generated](img/B22019_15_11.png)
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: Description automatically generated](img/B22019_15_11.png)
- en: 'Figure 15.11: Viewing the workload in the console'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.11：在控制台中查看工作负载
- en: As you can see from the preceding screen, the three deployments are listed,
    along with confirmation of the namespace they are in and the cluster that the
    workload belongs to.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示，三个部署列出，并确认它们所属的命名空间和工作负载所属的集群。
- en: If we had more than one cluster with multiple namespaces and deployments, we
    could use the filter to drill down into our GKE workloads.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们有多个集群，且每个集群中有多个命名空间和部署，我们可以使用过滤器来深入查看我们的 GKE 工作负载。
- en: Workloads
  id: totrans-185
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 工作负载
- en: 'Clicking on the **frontend** deployment will let you view more information:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**前端**部署将让你查看更多信息：
- en: '![A screenshot of a computer'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机截图'
- en: Description automatically generated](img/B22019_15_12.png)
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: Description automatically generated](img/B22019_15_12.png)
- en: 'Figure 15.12: Getting an overview of the frontend deployment'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.12：获取前端部署的概览
- en: 'On this page, you will be able to drill further down into your deployment using
    the tabs below the deployment name, as follows:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 在此页面上，你将能够通过部署名称下方的标签进一步深入查看你的部署，如下所示：
- en: '**OVERVIEW**: This view gives you an overview of the selected workload. As
    you can see from the previous screenshot, you can see the CPU, memory, and disk
    utilization, along with other information.'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**概述**：此视图为你提供所选工作负载的概览。如之前的截图所示，你可以看到 CPU、内存和磁盘的使用情况，以及其他信息。'
- en: '**DETAILS**: This lists more information about the environment and workload
    itself. Here, you can find out when it was created, annotations, labels (as well
    as details about the replicas), the update strategy, and Pod information.'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**详情**：此处列出了有关环境和工作负载本身的更多信息。在这里，你可以了解它是何时创建的、注解、标签（以及副本的详细信息）、更新策略以及 Pod 信息。'
- en: '**OBSERVABILITY**: Here, you can view all metrics on your workload’s infrastructure.'
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可观测性**：在这里，你可以查看工作负载基础设施的所有指标。'
- en: '**REVISION HISTORY**: Here, you will find a list of all the workload revisions.
    This is useful if your deployment is updated frequently and you need to keep track
    of when the deployment was updated.'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**修订历史**：在这里，你会找到所有工作负载修订的列表。如果你的部署频繁更新并且需要跟踪部署何时更新，这将非常有用。'
- en: '**EVENTS**: If you have any problems with your workload, this is the place
    to look. All events, such as scaling, pod availability, and other errors, will
    be listed here.'
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**事件**：如果你的工作负载有任何问题，这是查看的地方。所有事件，如扩展、Pod 可用性和其他错误，将列在这里。'
- en: '**LOGS**: This is a searchable list of the logs from all containers running
    the pod.'
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日志**：这是一个可搜索的日志列表，包含了运行该 Pod 的所有容器的日志。'
- en: '**APP ERRORS**: Here, you will find any application errors.'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用错误**：在这里，你会找到任何应用程序错误。'
- en: '**YAML**: This is an exportable YAML file containing the full deployment configuration.'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**YAML**：这是一个可导出的 YAML 文件，包含完整的部署配置。'
- en: This information is available for all the deployments across all the GKE clusters
    you have launched within the project.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 此信息适用于你在项目中启动的所有 GKE 集群中的所有部署。
- en: Gateways, Services, and Ingress
  id: totrans-200
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 网关、服务和入口
- en: In this section, we will look at the **Gateways, Services and Ingress** section.
    As you may have already guessed, this lists all the services launched across your
    GKE clusters. You can do this by clicking on **Gateways, Services and Ingress**.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个部分，我们将查看 **网关、服务和入口** 部分。正如你可能已经猜到的，这里列出了在你所有 GKE 集群中启动的所有服务。你可以通过点击 **网关、服务和入口**
    来查看。
- en: 'When you first go to this section, it will default to the **GATEWAYS** tab,
    but we haven’t launched a gateway, so you need to click on the **SERVICES** tab.
    When this loads, you will be presented with a screen that looks like the following:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 当你首次进入此部分时，它默认会显示 **网关** 标签页，但我们还没有启动网关，因此你需要点击 **服务** 标签页。当加载完成后，你将看到如下所示的界面：
- en: '![A screenshot of a computer'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机截图'
- en: Description automatically generated](img/B22019_15_13.png)
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B22019_15_13.png)
- en: 'Figure 15.13: Viewing the services in the console'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.13：在控制台中查看服务
- en: As you can see, the three services we launched are listed. However, the **frontend**
    service has an **External load balancer** type and a public IP address listed,
    as opposed to the **redis-leader** and **redis-follower** services, which only
    have a **Cluster IP**.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，我们启动的三个服务都列在其中。然而，**前端** 服务有一个 **外部负载均衡器** 类型和一个公开的 IP 地址，而 **redis-leader**
    和 **redis-follower** 服务则仅有一个 **集群 IP**。
- en: This is because, of the three services, we only want the frontend service to
    be accessible publicly, as only our frontend service uses the two Redis services.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 这是因为，在这三个服务中，我们只希望前端服务能够公开访问，因为只有我们的前端服务使用了两个 Redis 服务。
- en: When the external load balancer was launched, as we were running our cluster
    in a public cloud provider, the Kubernetes scheduler knew to contact the Google
    Cloud API and launch a load balancer for use. It then configured it to talk back
    to our cluster nodes, exposing the workload; this deployment runs on port **80**
    externally, and traffic is passed back to port **31740** on the nodes.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 当外部负载均衡器启动时，由于我们在公共云提供商上运行集群，Kubernetes 调度器知道要联系 Google Cloud API 并启动负载均衡器供使用。然后，它将其配置为与我们的集群节点进行通信，暴露工作负载；该部署在外部运行在端口
    **80** 上，流量将传递回节点上的端口 **31740**。
- en: 'As before, clicking on one of the three running services will give you several
    pieces of information:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 和以前一样，点击三个运行中的服务之一会给你提供几个信息：
- en: '**OVERVIEW**: This view gives you a summary of the service configuration and
    utilization.'
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**概述**：此视图提供了服务配置和利用情况的总结。'
- en: '**DETAILS**: Here, you can find more details on the service and a link to view
    the load balancer resource that has been launched within our Google Cloud project.'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**详情**：在这里，你可以找到有关服务的更多细节，并可以查看已在我们 Google Cloud 项目中启动的负载均衡器资源的链接。'
- en: '**EVENTS**: As before, you can find any events affecting the service here.
    This is useful for troubleshooting.'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**事件**：如前所述，你可以在这里找到任何影响服务的事件。这对于故障排除非常有用。'
- en: '**LOGS**: This is a repeat of the logs shown in the **Workloads** section.'
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日志**：这是 **工作负载** 部分中显示的日志的重复。'
- en: '**APP ERRORS**: You will be able to find any application errors here.'
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用程序错误**：你将在这里找到任何应用程序的错误。'
- en: '**YAML**: Again, this is a way to export the complete service configuration
    as a YAML file.'
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**YAML**：同样，这是将完整的服务配置导出为 YAML 文件的一种方式。'
- en: While this covers the basic workload we launched, GKE offers plenty of other
    options and features. Let’s quickly work through the functionality hidden behind
    the other items in the left-hand menu.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然这涵盖了我们启动的基本工作负载，但 GKE 提供了许多其他选项和功能。让我们快速浏览左侧菜单中其他项目背后的功能。
- en: Other GKE features
  id: totrans-217
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 其他 GKE 特性
- en: 'There are two types of features supported by GKE; the ones listed below are
    the standard ones. There are also Enterprise features that can be enabled when
    you run GKE Enterprise, which we will discuss at the end of this section:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: GKE 支持两种类型的特性；以下列出的为标准特性。还有可以在你运行 GKE 企业版时启用的企业特性，我们将在本节末尾讨论这些特性：
- en: '**Clusters**: Here, you can manage your clusters; you will see the cluster
    we launched using the GCP CLI and have the option of creating more clusters, using
    the guided web interface.'
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**集群**：在这里，你可以管理你的集群；你将看到我们通过 GCP CLI 启动的集群，并可以使用引导式 Web 界面创建更多集群。'
- en: '**Workloads**: As already covered, you will find the workloads you have deployed
    to your clusters.'
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**工作负载**：如前所述，你将在这里找到你部署到集群中的工作负载。'
- en: '**Applications**: This will show you any applications you have deployed from
    the Marketplace, which we will cover in a moment.'
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用程序**：这里会显示你从市场中部署的所有应用程序，我们稍后会介绍这个内容。'
- en: '**Secrets and ConfigMaps**: Here, you can securely manage your Secrets and
    ConfigMaps.'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**秘密和配置映射**：在这里，你可以安全地管理你的秘密和配置映射。'
- en: '**Storage**: You can view any persistent storage claims you have configured
    here and manage storage classes.'
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**存储**：你可以查看你在这里配置的任何持久存储声明，并管理存储类。'
- en: '**Object Browser**: Think of this as an explorer for the K8s and GCP API; clicking
    through it gives you an overview of all the possible APIs and endpoints you can
    interact with and what objects/resources are currently deployed.'
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**对象浏览器**：可以将它视为 K8s 和 GCP API 的资源管理器；点击它，你可以看到你可以与之交互的所有 API 和端点的概览，以及当前已部署的对象/资源。'
- en: 'The following services bring native Google services into GKE:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 以下服务将 Google 原生服务引入 GKE：
- en: '**Backup for GKE**: Here, you can use GCP’s backup service, which is outside
    the GKE offering, to back up your GKE-hosted workloads and applications. Personally,
    when I run a Kubernetes workload in the cloud, the data within it is ephemeral.
    For services such as databases, where I would want to have backups, they run in
    an SLA-backed, cloud-native service outside of my cluster – but if, for whatever
    reason, you can’t do that, then this service has you covered.'
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**GKE 备份**：在这里，你可以使用 GCP 的备份服务（它是 GKE 提供服务之外的）来备份你在 GKE 中托管的工作负载和应用程序。就我个人而言，当我在云端运行
    Kubernetes 工作负载时，里面的数据是临时的。对于像数据库这样的服务，我希望有备份，它们运行在一个受 SLA 支持的、云原生的服务中，位于我的集群之外——但如果由于某些原因你不能这样做，那么这个服务可以满足你的需求。'
- en: '**Gateways, Services and Ingress**: We have already covered this option.'
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网关、服务和入口**：我们已经介绍过这个选项。'
- en: '**Network Function Optimizer**: You can link your GKE workloads to other GCP
    resources’ private networking here. This allows you to extend your cluster network
    so that services like Google Cloud databases can be accessed privately by your
    cluster resources.'
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络功能优化器**：你可以在这里将 GKE 工作负载连接到其他 GCP 资源的私有网络。这使你能够扩展你的集群网络，以便像 Google Cloud
    数据库这样的服务可以通过集群资源私密访问。'
- en: '**Marketplace**: Here, you will find pre-packaged applications to run in your
    GKE cluster. They are published by various software vendors and include both free
    and commercial offerings.'
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**市场**：在这里，你可以找到可以在 GKE 集群中运行的预包装应用程序。这些应用程序由各种软件供应商发布，包括免费和商业产品。'
- en: As mentioned, the features above are available in the standard edition of GKE;
    this edition is like rolling your own Kubernetes deployment, except Google takes
    care of the node deployment and management plan for you.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 如上所述，上述功能在 GKE 的标准版中是可用的；此版本类似于自己部署 Kubernetes，只是谷歌为您处理了节点部署和管理计划。
- en: Then, there is the Enterprise edition; as you might have guessed, this introduces
    additional features that an enterprise deploying Kubernetes may require, such
    as managed services meshes and security, compliance, and role-based access control
    options. These features come at an extra cost but are essential for larger organizations
    that may work in more regulated industries.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是企业版；正如您可能已经猜到的那样，这引入了额外的功能，企业部署 Kubernetes 可能需要这些功能，例如托管服务网格、安全性、合规性和基于角色的访问控制选项。这些功能需要额外的费用，但对于可能在更受监管的行业中工作的大型组织来说是必不可少的。
- en: Deleting your cluster
  id: totrans-232
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 删除您的集群
- en: 'Once you finish with your cluster, you can remove it by running the following
    commands. The first removes the service we created, and the second terminates
    the cluster itself:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 当您完成您的集群时，可以通过运行以下命令来删除它。第一个命令将删除我们创建的服务，第二个命令将终止集群本身：
- en: '[PRE27]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: It will take a few minutes to remove the cluster; please ensure that you wait
    until this process finishes.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 删除集群可能需要几分钟，请确保在此过程完成之前等待。
- en: This should also delete any services launched by your workloads, such as load
    balancers. However, I recommend double-checking the Google Cloud Console for any
    orphaned services or resources to ensure that you do not incur unexpected costs.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 这还应该删除您的工作负载启动的任何服务，例如负载均衡器。但是，我建议您在 Google Cloud 控制台上仔细检查是否有任何被遗弃的服务或资源，以确保您不会产生意外的费用。
- en: We have been using the `--zone=us-central1-a` flag, which launches our cluster
    in a single availability zone in the US Central region. Let’s discuss what other
    cluster options are available.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 我们一直在使用 `--zone=us-central1-a` 标志，在美国中部地区的一个可用区启动我们的集群。让我们讨论一下其他可用的集群选项。
- en: More about cluster nodes
  id: totrans-238
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 关于集群节点的更多信息
- en: 'At the end of the previous section, I mentioned availability zones and regions.
    Before we discuss some of the cluster deployment options, we should get a slightly
    better understanding of what we mean by availability zones and regions:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一节的结尾，我提到了可用区和区域。在讨论一些集群部署选项之前，我们应该更好地理解一下我们所说的可用区和区域的含义：
- en: '**Region**: A region is made up of zones. Zones have great low-latency network
    connectivity to other zones within the same region. This gives you a way of deploying
    highly available, always-on, fault-tolerant workloads.'
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**区域**：一个区域由多个区域组成。不同区域内的区域具有出色的低延迟网络连接，可实现高可用性、始终在线和容错工作负载的部署。'
- en: '**Availability zone**: Think of availability zones as separate data centers
    within a region. The zones have diverse networks and power, meaning that if a
    single zone has an issue and you run your workload across multiple zones, your
    workload shouldn’t be impacted.'
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可用区**：将可用区视为区域内的单独数据中心。这些区域具有不同的网络和电力，这意味着如果一个单一区域出现问题并且您在多个区域中运行您的工作负载，则您的工作负载不应受到影响。'
- en: The one thing to note with zones is that you might find that not all machine
    types are available across all zones within a region. Therefore, please check
    before attempting to deploy your workload.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 关于区域的一点需要注意的是，并非所有机器类型在一个区域内的所有区域中都可用。因此，请在尝试部署工作负载之前进行检查。
- en: Google best practices recommend that you deploy your workload across the maximum
    number of zones within a single region for optimum performance and availability.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 谷歌的最佳实践建议您将您的工作负载跨单个区域内的最大区域数量部署，以获得最佳性能和可用性。
- en: However, it is possible to split your workloads across multiple regions by using
    Multi Cluster Ingress – all you have to do is account for and allow the increased
    latency between regions for shared services, such as databases. For more information
    on Multi Cluster Ingress, see the *Further reading* section at the end of the
    chapter.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，可以通过使用多集群入口将您的工作负载分布在多个区域中 – 您只需考虑和允许共享服务之间的增加延迟，例如数据库。有关多集群入口的更多信息，请参见本章末尾的*进一步阅读*部分。
- en: 'Let’s get back to looking at launching a cluster in a single region across
    multiple zones, by examining the command we used to launch the test cluster at
    the start of the chapter:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们重新看看如何在单个区域跨多个区域启动集群，通过检查我们在本章开头用于启动测试集群的命令：
- en: '[PRE28]'
  id: totrans-246
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: As we know, it will launch two nodes but only in a single zone. We have only
    passed one using the `-zone` flag, which, in our case, was the `us-central1` region
    and zone `a`.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所知，它将启动两个节点，但仅在一个区域内。我们只使用 `-zone` 标志传递了一个区域，在我们的例子中是 `us-central1` 区域和 `a`
    区域。
- en: 'Let’s run the following command but use the `--region` flag rather than the
    `--zone` one:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们运行以下命令，但使用 `--region` 标志而不是 `--zone` 标志：
- en: '[PRE29]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Once launched, run the following:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 启动后，运行以下命令：
- en: '[PRE30]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'This should output something that looks like the following:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该会输出如下内容：
- en: '![A screenshot of a computer program'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机程序的屏幕截图'
- en: Description automatically generated](img/B22019_15_14.png)
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B22019_15_14.png)
- en: 'Figure 15.14: Viewing the nodes running in a region'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.14：查看运行在区域中的节点
- en: As you can see, we have two nodes in each zone, giving us a total cluster size
    of six nodes. This is because when you define a region by default, your cluster
    is spread across three zones. You can override this using the `--node-locations`
    flag.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，我们在每个区域都有两个节点，总共六个节点。这是因为默认情况下，当你定义一个区域时，集群会分布在三个区域内。你可以通过使用`--node-locations`标志来覆盖此设置。
- en: 'This makes our command look like the following if we wanted to deploy a cluster
    from scratch; as you can see, we now have a comma-separated list of availability
    zones:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想从头开始部署一个集群，命令会像下面这样；正如你所见，我们现在有一个逗号分隔的可用区列表：
- en: '[PRE31]'
  id: totrans-258
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: We are still using the `us-central1` region but deploying to the `a`, `b`, `c`,
    and `f` zones.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 我们仍然使用 `us-central1` 区域，但部署到 `a`、`b`、`c` 和 `f` 区域。
- en: 'Given that we already have a cluster running, we can run the following command
    to update the cluster, adding the new availability zone and two new nodes:'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已经有一个正在运行的集群，我们可以运行以下命令来更新集群，添加新的可用区和两个新节点：
- en: '[PRE32]'
  id: totrans-261
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Running the `kubectl get nodes` command now shows the following:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 运行 `kubectl get nodes` 命令现在会显示如下内容：
- en: '![A screenshot of a computer program'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: '![计算机程序的屏幕截图'
- en: Description automatically generated](img/B22019_15_15.png)
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B22019_15_15.png)
- en: 'Figure 15.15: Our cluster now running across four availability zones'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.15：我们的集群现在跨四个可用区运行
- en: As you can see, Google has made deploying your clusters straightforward across
    multiple zones. This means that you can deploy your workload across a fully redundant
    cluster with minimal effort; given the complexity involved in replicating this
    type of deployment manually using virtual machines and networks, the ease is very
    welcome.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，Google 已经使得在多个区域间部署集群变得简单。这意味着你可以轻松地将工作负载部署到一个完全冗余的集群中；考虑到手动使用虚拟机和网络来复制这种类型的部署所涉及的复杂性，这种简化是非常受欢迎的。
- en: 'To remove clusters deployed using the `--region` flag, you should use the following
    command:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 要删除使用 `--region` 标志部署的集群，你应该使用以下命令：
- en: '[PRE33]'
  id: totrans-268
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: At the time of writing, the simple two-node cluster we launched at the start
    of the chapter costs around $55 per month, and the price increases to around $347
    per month for the eight-node cluster we just launched. For more cost information,
    see the Google Cloud Pricing Calculator link in the *Further reading* section.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 截至目前，我们在本章开始时启动的简单两节点集群每月约为 55 美元，而我们刚刚启动的八节点集群的费用约为每月 347 美元。有关更多费用信息，请参阅*进一步阅读*部分中的
    Google Cloud 定价计算器链接。
- en: This concludes our look at GKE. Before we move on to the next public cloud provider,
    let’s summarize what we have covered.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 这标志着我们对 GKE 的探讨结束。在我们继续讨论下一个公共云服务提供商之前，让我们总结一下我们已经覆盖的内容。
- en: Summary
  id: totrans-271
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we discussed the origins of GCP and the GKE service, before
    walking through how to sign up for an account and how to install and configure
    the Google Cloud command-line tool.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们讨论了 GCP 和 GKE 服务的起源，然后介绍了如何注册帐户以及如何安装和配置 Google Cloud 命令行工具。
- en: We then launched a simple two-node cluster using a single command, and then
    we deployed and interacted with a workload, using the `kubectl` command and Google
    Cloud Console.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们使用一个命令启动了一个简单的两节点集群，接着我们使用 `kubectl` 命令和 Google Cloud Console 部署并与工作负载进行交互。
- en: Finally, again using only a single command, we redeployed our cluster to take
    advantage of multiple availability zones, quickly scaling to a fully redundant
    and highly available eight-node cluster that runs across four availability zones.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，再次仅使用一个命令，我们重新部署了集群，以利用多个可用区，快速扩展到一个完全冗余且高度可用的八节点集群，跨四个可用区运行。
- en: I am sure you will agree that Google has done an excellent job of making deploying
    and maintaining a complex infrastructure configuration a relatively trivial and
    quick task.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 我相信你会同意，Google 在将复杂的基础架构配置的部署和维护工作变成相对简单和快速的任务方面做得非常出色。
- en: Also, once your workloads are deployed, you can manage them the same way you
    would if your cluster were deployed elsewhere – we really haven’t had to make
    any allowances for our cluster being run on GCP.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，一旦你的工作负载部署完成，你可以像管理其他集群一样管理它们——我们实际上并没有因为集群在 GCP 上运行而做出任何特殊调整。
- en: The next chapter will examine deploying a Kubernetes cluster in AWS using Amazon
    Elastic Kubernetes Service, Amazon’s fully managed Kubernetes offering.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将探讨如何使用 AWS 的 Amazon Elastic Kubernetes Service 部署 Kubernetes 集群，这是亚马逊完全托管的
    Kubernetes 服务。
- en: Further reading
  id: totrans-278
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Here are links to more information on some of the topics and tools that we
    have covered in this chapter:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是一些关于本章所涵盖的主题和工具的更多信息链接：
- en: 'Google Kubernetes Engine: [https://cloud.google.com/kubernetes-engine/](https://cloud.google.com/kubernetes-engine/'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Google Kubernetes Engine：[https://cloud.google.com/kubernetes-engine/](https://cloud.google.com/kubernetes-engine/)
- en: )
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: )
- en: 'Google Kubernetes Engine Documentation: [https://cloud.google.com/kubernetes-engine/docs](https://cloud.google.com/kubernetes-engine/docs'
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Google Kubernetes Engine 文档：[https://cloud.google.com/kubernetes-engine/docs](https://cloud.google.com/kubernetes-engine/docs)
- en: )
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: )
- en: 'Google Cloud Pricing Calculator: [https://cloud.google.com/products/calculator](https://cloud.google.com/products/calculator'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Google Cloud 定价计算器：[https://cloud.google.com/products/calculator](https://cloud.google.com/products/calculator)
- en: )
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: )
- en: 'The Guestbook Sample Application: [https://github.com/GoogleCloudPlatform/kubernetes-engine-samples/tree/main/quickstarts/guestbook](https://github.com/GoogleCloudPlatform/kubernetes-engine-samples/tree/main/quickstarts/guestbook)'
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Guestbook 示例应用：[https://github.com/GoogleCloudPlatform/kubernetes-engine-samples/tree/main/quickstarts/guestbook](https://github.com/GoogleCloudPlatform/kubernetes-engine-samples/tree/main/quickstarts/guestbook)
- en: 'The Google Cloud Kubernetes comic: [https://cloud.google.com/kubernetes-engine/kubernetes-comic](https://cloud.google.com/kubernetes-engine/kubernetes-comic'
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Google Cloud Kubernetes 漫画：[https://cloud.google.com/kubernetes-engine/kubernetes-comic](https://cloud.google.com/kubernetes-engine/kubernetes-comic)
- en: )
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: )
- en: 'Regional Clusters: [https://cloud.google.com/kubernetes-engine/docs/concepts/regional-clusters](https://cloud.google.com/kubernetes-engine/docs/concepts/regional-clusters'
  id: totrans-289
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 区域集群：[https://cloud.google.com/kubernetes-engine/docs/concepts/regional-clusters](https://cloud.google.com/kubernetes-engine/docs/concepts/regional-clusters)
- en: )
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: )
- en: 'Multi Cluster Ingress: [https://cloud.google.com/kubernetes-engine/docs/concepts/multi-cluster-ingress](https://cloud.google.com/kubernetes-engine/docs/concepts/multi-cluster-ingress'
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 多集群 Ingress：[https://cloud.google.com/kubernetes-engine/docs/concepts/multi-cluster-ingress](https://cloud.google.com/kubernetes-engine/docs/concepts/multi-cluster-ingress)
- en: )
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: )
- en: Join our community on Discord
  id: totrans-293
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 加入我们的社区，在 Discord 上进行交流
- en: 'Join our community’s Discord space for discussions with the authors and other
    readers:'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 加入我们社区的 Discord 空间，与作者和其他读者进行讨论：
- en: '[https://packt.link/cloudanddevops](https://packt.link/cloudanddevops)'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/cloudanddevops](https://packt.link/cloudanddevops)'
- en: '![](img/QR_Code119001106479081656.png)'
  id: totrans-296
  prefs: []
  type: TYPE_IMG
  zh: '![](img/QR_Code119001106479081656.png)'
